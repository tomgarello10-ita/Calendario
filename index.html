<!DOCTYPE html>
<html lang="it">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
  <meta name="theme-color" content="#ffffff"/>
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="apple-mobile-web-app-status-bar-style" content="default"/>
  <meta name="apple-mobile-web-app-title" content="Il Mio Anno"/>
  <title>Il Mio Anno</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react/18.2.0/umd/react.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/react-dom/18.2.0/umd/react-dom.production.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-standalone/7.23.5/babel.min.js"></script>
  <style>
    *{box-sizing:border-box;-webkit-tap-highlight-color:transparent;margin:0;padding:0}
    html,body{height:100%;overflow:hidden}
    body{font-family:-apple-system,'SF Pro Text','Helvetica Neue',sans-serif;overscroll-behavior:none;transition:background 0.3s,color 0.3s}
    body.dark{background:#000;color:#fff}
    body.light{background:#fff;color:#1C1C1E}
    ::-webkit-scrollbar{display:none}
    input,textarea{-webkit-appearance:none;user-select:text;font-family:inherit}
    *{user-select:none}
    @keyframes fadeUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @keyframes spin{from{transform:rotate(0deg)}to{transform:rotate(360deg)}}
    @keyframes pulse{0%,100%{opacity:1}50%{opacity:0.4}}
    .tap:active{opacity:0.45}
    .spin{animation:spin 1s linear infinite}
    .pulse{animation:pulse 1.5s ease infinite}
  </style>
</head>
<body class="light">
<div id="root" style="height:100%"></div>
<script type="text/babel">
const {useState,useEffect,useRef,useCallback} = React;

// â”€â”€ THEME â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const ThemeCtx = React.createContext({dark:false,toggle:()=>{}});

const MONTHS=[â€œGennaioâ€,â€œFebbraioâ€,â€œMarzoâ€,â€œAprileâ€,â€œMaggioâ€,â€œGiugnoâ€,â€œLuglioâ€,â€œAgostoâ€,â€œSettembreâ€,â€œOttobreâ€,â€œNovembreâ€,â€œDicembreâ€];
const MONTHS_S=[â€œGenâ€,â€œFebâ€,â€œMarâ€,â€œAprâ€,â€œMagâ€,â€œGiuâ€,â€œLugâ€,â€œAgoâ€,â€œSetâ€,â€œOttâ€,â€œNovâ€,â€œDicâ€];
const DAYS=[â€œLâ€,â€œMâ€,â€œMâ€,â€œGâ€,â€œVâ€,â€œSâ€,â€œDâ€];

const CATS=[
{id:â€œverificaâ€,    label:â€œVerificaâ€,    emoji:â€œğŸ“â€,color:â€#FF3B30â€,bg:â€œrgba(255,59,48,0.1)â€},
{id:â€œcompleannoâ€,  label:â€œCompleannoâ€,  emoji:â€œğŸ‚â€,color:â€#FF9500â€,bg:â€œrgba(255,149,0,0.1)â€},
{id:â€œcommissioneâ€, label:â€œCommissioneâ€, emoji:â€œğŸ›’â€,color:â€#34C759â€,bg:â€œrgba(52,199,89,0.1)â€},
{id:â€œappuntamentoâ€,label:â€œAppuntamentoâ€,emoji:â€œğŸ¥â€,color:â€#007AFFâ€,bg:â€œrgba(0,122,255,0.1)â€},
{id:â€œtodoâ€,        label:â€œDa fareâ€,     emoji:â€œâœ…â€,color:â€#AF52DEâ€,bg:â€œrgba(175,82,222,0.1)â€},
];
const getCat=id=>CATS.find(c=>c.id===id)||CATS[4];

const MATERIE=[
{id:â€œmatematicaâ€,label:â€œMatematicaâ€,emoji:â€œğŸ“â€},{id:â€œitalianoâ€,label:â€œItalianoâ€,emoji:â€œğŸ“–â€},
{id:â€œstoriaâ€,label:â€œStoriaâ€,emoji:â€œğŸ›ï¸â€},{id:â€œscienzeâ€,label:â€œScienzeâ€,emoji:â€œğŸ”¬â€},
{id:â€œingleseâ€,label:â€œIngleseâ€,emoji:â€œğŸ‡¬ğŸ‡§â€},{id:â€œfisicaâ€,label:â€œFisicaâ€,emoji:â€œâš¡â€},
{id:â€œchimicaâ€,label:â€œChimicaâ€,emoji:â€œğŸ§ªâ€},{id:â€œgeografiaâ€,label:â€œGeografiaâ€,emoji:â€œğŸŒâ€},
{id:â€œarteâ€,label:â€œArteâ€,emoji:â€œğŸ¨â€},{id:â€œmusicaâ€,label:â€œMusicaâ€,emoji:â€œğŸµâ€},
{id:â€œfilosofiaâ€,label:â€œFilosofiaâ€,emoji:â€œğŸ¤”â€},{id:â€œinformaticaâ€,label:â€œInformaticaâ€,emoji:â€œğŸ’»â€},
{id:â€œed_fisicaâ€,label:â€œEd. Fisicaâ€,emoji:â€œâš½â€},{id:â€œlatinoâ€,label:â€œLatinoâ€,emoji:â€œğŸ“œâ€},
{id:â€œaltraâ€,label:â€œAltraâ€,emoji:â€œğŸ“šâ€},
];

const TIPI=[â€œScrittoâ€,â€œOraleâ€,â€œTestâ€,â€œCompitoâ€,â€œPresentazioneâ€];

const today=new Date();
const todayStr=fmt(today.getFullYear(),today.getMonth(),today.getDate());
function fmt(y,m,d){return `${y}-${String(m+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`}
function daysIn(y,m){return new Date(y,m+1,0).getDate()}
function firstDay(y,m){const d=new Date(y,m,1).getDay();return d===0?6:d-1}
function addMonths(y,m,delta){let nm=m+delta,ny=y;while(nm>11){nm-=12;ny++;}while(nm<0){nm+=12;nyâ€“;}return{year:ny,month:nm};}
function daysBetween(s){const[y,m,d]=s.split(â€-â€).map(Number);return Math.round((new Date(y,m-1,d)-new Date(today.getFullYear(),today.getMonth(),today.getDate()))/(864e5))}

const SK=â€œilmioanno_v6â€;
function loadEv(){try{return JSON.parse(localStorage.getItem(SK))||{}}catch{return{}}}
function saveEv(e){try{localStorage.setItem(SK,JSON.stringify(e))}catch{}}
function loadPref(){try{return JSON.parse(localStorage.getItem(SK+â€_prefâ€))||{dark:false}}catch{return{dark:false}}}
function savePref(p){try{localStorage.setItem(SK+â€_prefâ€,JSON.stringify(p))}catch{}}

function getAlerts(ev){
const a=[];
Object.entries(ev).forEach(([day,evs])=>evs.forEach(e=>{
const d=daysBetween(day),c=getCat(e.category);
if(e.category===â€œverificaâ€){
if(d===15)a.push({e,day,d,msg:â€œInizia a ripassare!â€,u:â€œlowâ€,icon:â€œğŸ“–â€});
else if(d===10)a.push({e,day,d,msg:â€œRipassa con costanzaâ€,u:â€œmediumâ€,icon:â€œğŸ“šâ€});
else if(d===5)a.push({e,day,d,msg:â€œUltimi giorni!â€,u:â€œhighâ€,icon:â€œâš¡â€});
else if(d===2)a.push({e,day,d,msg:â€œDopodomani! Rivedi tuttoâ€,u:â€œhighâ€,icon:â€œğŸ”¥â€});
else if(d===1)a.push({e,day,d,msg:â€œDOMANI! Sei pronto?â€,u:â€œurgentâ€,icon:â€œğŸš¨â€});
else if(d===0)a.push({e,day,d,msg:â€œOGGI! In bocca al lupo!â€,u:â€œurgentâ€,icon:â€œğŸ¯â€});
} else if(e.category===â€œcompleannoâ€){
if(d===7)a.push({e,day,d,msg:â€œTra una settimana!â€,u:â€œlowâ€,icon:â€œğŸâ€});
else if(d===3)a.push({e,day,d,msg:â€œTra 3 giorni!â€,u:â€œmediumâ€,icon:â€œğŸ‚â€});
else if(d===1)a.push({e,day,d,msg:â€œDOMANI! Non dimenticare!â€,u:â€œhighâ€,icon:â€œğŸ‰â€});
else if(d===0)a.push({e,day,d,msg:â€œOGGI Ã¨ il compleanno! ğŸ¥³â€,u:â€œurgentâ€,icon:â€œğŸ‚â€});
} else {
if(d===3)a.push({e,day,d,msg:â€œTra 3 giorniâ€,u:â€œlowâ€,icon:c.emoji});
else if(d===1)a.push({e,day,d,msg:â€œDOMANI! Non dimenticareâ€,u:â€œhighâ€,icon:â€œâ°â€});
else if(d===0)a.push({e,day,d,msg:â€œOGGI!â€,u:â€œurgentâ€,icon:â€œğŸ””â€});
}
}));
const o={urgent:0,high:1,medium:2,low:3};
return a.sort((a,b)=>o[a.u]-o[b.u]);
}

// â”€â”€ AI CALL (Gemini) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
// â”€â”€ SISTEMA RIPASSO OFFLINE â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const RIPASSO_DB={
matematica:{
esercizi_base:[
â€œRisolvi: 2xÂ² - 5x + 3 = 0â€,
â€œRisolvi il sistema: { 2x + y = 7 / x - y = 2 }â€,
â€œCalcola lâ€™area di un triangolo con base 8cm e altezza 5cmâ€,
â€œSemplifica la frazione: 36/48â€,
â€œRisolvi: 3(x - 2) = 2x + 4â€,
â€œCalcola: (2Â³ Ã— 4Â²) Ã· 2â´â€,
â€œTrova il MCD e mcm di 12 e 18â€,
â€œRisolvi la proporzione: 3 : x = 6 : 10â€
],
esercizi_avanzati:[
â€œStudia il segno di: f(x) = xÂ² - 4x + 3â€,
â€œCalcola il discriminante e le soluzioni di: xÂ² + 3x - 10 = 0â€,
â€œDimostra che la diagonale di un quadrato di lato â€˜aâ€™ Ã¨ aâˆš2â€,
â€œRisolvi: |2x - 1| < 5â€,
â€œDato un cerchio di raggio 6, calcola area e circonferenzaâ€
],
teoria:[â€œRipassa le formule quadraticheâ€,â€œStudia i teoremi sulle figure pianeâ€,â€œRileggi le proprietÃ  delle potenzeâ€],
tips:[â€œSostituisci sempre per verificareâ€,â€œDisegna prima di calcolareâ€,â€œControlla il segno del discriminanteâ€]
},
italiano:{
esercizi_base:[
â€œAnalizza grammaticalmente: â€˜Il gatto grigio dorme sul divano morbidoâ€™â€,
â€œIndividua soggetto, predicato e complementi in: â€˜Maria ha regalato un libro alla sua amicaâ€™â€,
â€œScrivi il contrario di: felice, lento, caldo, grande, chiaroâ€,
â€œTrasforma al passivo: â€˜Il professore spiega la lezione agli studentiâ€™â€,
â€œTrova le figure retoriche in: â€˜Il mare era una lastra di acciaio lucenteâ€™â€,
â€œDividi in sillabe: straordinario, psicologia, aeroplano, scienzaâ€,
â€œScrivi 3 sinonimi per: bello, camminare, dire, pauraâ€
],
esercizi_avanzati:[
â€œAnalisi del periodo: â€˜Sebbene fosse stanco, continuÃ² a lavorare finchÃ© non finÃ¬ il progettoâ€™â€,
â€œScrivi un testo argomentativo di 15 righe su: â€˜I social media fanno piÃ¹ bene o male?â€™â€,
â€œCommenta questa metafora: â€˜La vita Ã¨ un viaggio senza mappaâ€™â€,
â€œTrasforma dal discorso diretto allâ€™indiretto: â€˜Marco disse: Vengo domani alla festaâ€™â€
],
teoria:[â€œRipassa le congiunzioni subordinantiâ€,â€œStudia le figure retoriche principaliâ€,â€œRileggi la struttura del testo argomentativoâ€],
tips:[â€œLeggi le frasi ad alta voceâ€,â€œFai schemi per i periodi complessiâ€,â€œUsa la matita per segnare gli elementiâ€]
},
storia:{
esercizi_base:[
â€œMetti in ordine cronologico: Rivoluzione Francese, Prima Guerra Mondiale, Rivoluzione Industriale, Caduta dellâ€™Impero Romanoâ€,
â€œScrivi 3 cause della Prima Guerra Mondialeâ€,
â€œChi era Napoleone Bonaparte? Scrivi 5 informazioni chiaveâ€,
â€œIn quale anno cadde il Muro di Berlino? E cosa rappresentava?â€,
â€œCollega: Mussolini â†’ __, Hitler â†’ __, Stalin â†’ __ (fascismo/nazismo/comunismo)â€,
â€œQuali paesi formavano la Triplice Alleanza nel 1914?â€,
â€œQuando e dove fu firmata la Dichiarazione dâ€™Indipendenza americana?â€
],
esercizi_avanzati:[
â€œConfronta la Rivoluzione Francese e quella Americana: somiglianze e differenzeâ€,
â€œSpiega il concetto di â€˜imperialismoâ€™ e fai 2 esempi storiciâ€,
â€œAnalizza le conseguenze del Trattato di Versailles sulla Germaniaâ€,
â€œPerchÃ© scoppiÃ² la Seconda Guerra Mondiale? Elenca le 4 cause principaliâ€
],
teoria:[â€œRipassa le date fondamentali del programmaâ€,â€œStudia i personaggi chiaveâ€,â€œRileggi le mappe geografiche storicheâ€],
tips:[â€œUsa una linea del tempo visivaâ€,â€œCollega sempre causa â†’ evento â†’ conseguenzaâ€,â€œImpara le date associandole a eventi memorabiliâ€]
},
scienze:{
esercizi_base:[
â€œDescrivi le fasi della mitosi in ordineâ€,
â€œQual Ã¨ la differenza tra cellula procariota ed eucariota?â€,
â€œCompleta: La fotosintesi produce ___ e ___ usando ___ e ___â€,
â€œElenca i 5 regni degli esseri viventi con un esempio per ciascunoâ€,
â€œDescrivi il ciclo dellâ€™acqua in 4 fasiâ€,
â€œQual Ã¨ la funzione di: nucleo, mitocondri, membrana cellulare?â€,
â€œDifferenza tra DNA e RNA: scrivi 3 differenzeâ€
],
esercizi_avanzati:[
â€œSpiega la legge di Mendel usando lâ€™esempio dei piselliâ€,
â€œDescrivi il processo di respirazione cellulare aerobicaâ€,
â€œCosa sono gli enzimi? Spiega il loro meccanismo dâ€™azioneâ€,
â€œConfronta fotosintesi e respirazione cellulareâ€
],
teoria:[â€œRipassa i processi cellulariâ€,â€œStudia la classificazione degli organismiâ€,â€œRileggi i cicli biogeochimiciâ€],
tips:[â€œDisegna sempre gli schemi delle celluleâ€,â€œCollega struttura â†’ funzioneâ€,â€œUsa flashcard per i termini scientificiâ€]
},
inglese:{
esercizi_base:[
â€œMetti i verbi al Past Simple: go, eat, write, run, have, see, make, takeâ€,
â€œTrasforma al Present Perfect: â€˜I eat pizzaâ€™ â†’ â€˜I ___ already ___ pizzaâ€™â€,
â€œScrivi le domande per: â€˜She works in Milanâ€™ / â€˜They went to Paris last yearâ€™â€,
â€œTraduci: â€˜Se studiassi di piÃ¹, prenderesti voti miglioriâ€™â€,
â€œCompleta con la forma corretta: â€˜If I ___ (be) you, I ___ (study) moreâ€™â€,
â€œScrivi 5 frasi usando il Passive Voice al Present Simpleâ€,
â€œTrasforma in reported speech: â€˜Tom said: I will call you tomorrowâ€™â€
],
esercizi_avanzati:[
â€œScrivi unâ€™email formale (100 parole) per candidarti a un lavoroâ€,
â€œAnalizza il testo e rispondi: â€˜What is the main idea? What does the author imply?â€™â€,
â€œCompleta i phrasal verbs: give ___, take ___, look ___, put ___â€,
â€œScrivi un paragrafo con: although, however, therefore, in additionâ€
],
teoria:[â€œRipassa i tempi verbali con esempiâ€,â€œStudia i connettori discorsiviâ€,â€œRileggi le strutture condizionaliâ€],
tips:[â€œLeggi le frasi ad alta voce per la pronunciaâ€,â€œImpara i phrasal verbs in contestoâ€,â€œGuarda video in inglese durante le pauseâ€]
},
fisica:{
esercizi_base:[
â€œUnâ€™auto percorre 150 km in 2 ore. Calcola la velocitÃ  mediaâ€,
â€œCalcola la forza necessaria per accelerare una massa di 5 kg a 3 m/sÂ²â€,
â€œUn oggetto di 2 kg Ã¨ a 10 m di altezza. Calcola la sua energia potenziale (g=10 m/sÂ²)â€,
â€œApplica la legge di Ohm: V=12V, R=4Î©, calcola Iâ€,
â€œConverti: 72 km/h in m/sâ€,
â€œUn corpo cade da 20 m di altezza. Dopo quanto tempo tocca terra? (g=10 m/sÂ²)â€,
â€œCalcola il peso di un oggetto di massa 8 kgâ€
],
esercizi_avanzati:[
â€œUn proiettile viene lanciato a 20 m/s. Calcola spazio e tempo per fermarsi (a=-4 m/sÂ²)â€,
â€œDue cariche di +3Î¼C e -2Î¼C sono a 0,3 m. Calcola la forza elettrostaticaâ€,
â€œUn circuito ha R1=6Î© e R2=3Î© in parallelo con V=12V. Calcola la resistenza totale e la correnteâ€,
â€œEnuncia e applica il principio di conservazione dellâ€™energia in un esempioâ€
],
teoria:[â€œRipassa le formule con le unitÃ  di misuraâ€,â€œStudia le leggi fondamentaliâ€,â€œRileggi i grafici spazio-tempo e velocitÃ -tempoâ€],
tips:[â€œScrivi SEMPRE le unitÃ  di misuraâ€,â€œDisegna il diagramma delle forzeâ€,â€œControlla che il risultato abbia senso fisicoâ€]
},
chimica:{
esercizi_base:[
â€œScrivi la formula di: ossido di calcio, cloruro di sodio, acido solforico, idrossido di ferro(III)â€,
â€œBilancia: Hâ‚‚ + Oâ‚‚ â†’ Hâ‚‚Oâ€,
â€œBilancia: Fe + HCl â†’ FeClâ‚‚ + Hâ‚‚â€,
â€œQuante moli ci sono in 44g di COâ‚‚? (M=44 g/mol)â€,
â€œQual Ã¨ il numero atomico e di massa del Carbonio? Quanti protoni, neutroni ed elettroni ha?â€,
â€œIndica il gruppo e il periodo di: Na, Cl, Fe, O nella tavola periodicaâ€,
â€œScrivi la configurazione elettronica di: H, C, O, Naâ€
],
esercizi_avanzati:[
â€œCalcola la massa di NaCl necessaria per preparare 500 mL di soluzione 0,5 Mâ€,
â€œBilancia e classifica la reazione: CaCOâ‚ƒ â†’ CaO + COâ‚‚â€,
â€œSpiega la differenza tra legame covalente polare e apolare con esempiâ€,
â€œCalcola il pH di una soluzione di HCl 0,01 Mâ€
],
teoria:[â€œRipassa la tavola periodica (gruppi e periodi)â€,â€œStudia i tipi di legame chimicoâ€,â€œRileggi come bilanciare le equazioniâ€],
tips:[â€œMemorizza i simboli dei primi 20 elementiâ€,â€œBilancia sempre atomo per atomoâ€,â€œUsa i coefficienti, non i pedici, per bilanciareâ€]
},
geografia:{
esercizi_base:[
â€œIndica su una mappa: i 5 oceani e i 7 continentiâ€,
â€œQual Ã¨ la capitale di: Germania, Brasile, Australia, Giappone, Egitto?â€,
â€œDescrivi il clima mediterraneo: caratteristiche, zone, vegetazione tipicaâ€,
â€œOrdina per popolazione: Cina, India, USA, Indonesia, Brasileâ€,
â€œCosâ€™Ã¨ la densitÃ  di popolazione? Calcola quella di un paese con 60M abitanti e 300.000 kmÂ²â€,
â€œNomina i 3 fiumi piÃ¹ lunghi del mondo con i continenti in cui si trovanoâ€,
â€œDifferenza tra clima e tempo meteorologico: spiega con un esempioâ€
],
esercizi_avanzati:[
â€œSpiega il fenomeno El NiÃ±o e le sue conseguenze globaliâ€,
â€œAnalizza le cause dello spopolamento delle aree rurali italianeâ€,
â€œConfronta la densitÃ  demografica di Europa e Africaâ€,
â€œDescrivi la struttura interna della Terra e le sue conseguenze geologicheâ€
],
teoria:[â€œRipassa le cartine fisiche e politicheâ€,â€œStudia i dati demografici principaliâ€,â€œRileggi i fenomeni climaticiâ€],
tips:[â€œStudia SEMPRE con la cartina davantiâ€,â€œCollega geografia a storia ed economiaâ€,â€œUsa mnemotecniche per le capitaliâ€]
},
filosofia:{
esercizi_base:[
â€œChi Ã¨ Socrate? Spiega il metodo maieutico in 5 righeâ€,
â€œQual Ã¨ la differenza tra empirismo e razionalismo? Fai un esempio per ciascunoâ€,
â€œRiassumi la teoria delle Idee di Platoneâ€,
â€œCosâ€™Ã¨ lâ€™imperativo categorico di Kant? Fai un esempio praticoâ€,
â€œSpiega la dialettica hegeliana (tesi-antitesi-sintesi) con un esempioâ€,
â€œChi Ã¨ Aristotele? Elenca 3 sue opere e i temi principaliâ€,
â€œDifferenza tra etica deontologica e consequenzialistaâ€
],
esercizi_avanzati:[
â€œConfronta il pensiero di Platone e Aristotele sullâ€™animaâ€,
â€œAnalizza il pensiero di Nietzsche: volontÃ  di potenza e oltreuomoâ€,
â€œSpiega il problema mente-corpo nella filosofia modernaâ€,
â€œCommenta: â€˜Cogito ergo sumâ€™ di Cartesio â€” cosa significa e perchÃ© Ã¨ importante?â€
],
teoria:[â€œRipassa i filosofi per periodo storicoâ€,â€œStudia i concetti chiave di ogni correnteâ€,â€œRileggi le citazioni piÃ¹ famoseâ€],
tips:[â€œCollega ogni filosofo al suo contesto storicoâ€,â€œSpiega i concetti con esempi concretiâ€,â€œFai schemi comparativi tra filosofiâ€]
},
latino:{
esercizi_base:[
â€œDeclina al singolare e plurale: â€˜puellaâ€™ (1Âª decl.) e â€˜dominusâ€™ (2Âª decl.)â€,
â€œConiuga â€˜amareâ€™ allâ€™indicativo presente attivo (tutte le persone)â€,
â€œTraduci: â€˜Puella in horto ambulat et flores videtâ€™â€,
â€œIndica il caso di ogni parola: â€˜Magistro discipuli libros dantâ€™â€,
â€œTrasforma dal singolare al plurale: â€˜Filius patri epistulam scribitâ€™â€,
â€œRiconosci le proposizioni in: â€˜Dico te errare quia multa ignorasâ€™â€,
â€œConiuga â€˜esseâ€™ allâ€™indicativo presente e imperfettoâ€
],
esercizi_avanzati:[
â€œTraduci e analizza: â€˜Caesar, postquam hostes vicit, Romam rediitâ€™â€,
â€œIndividua e spiega lâ€™ablativo assoluto in: â€˜Sole oriente, milites profecti suntâ€™â€,
â€œTrasforma dalla proposizione infinitiva alla completiva con â€˜utâ€™â€,
â€œConiuga un verbo deponente (es. â€˜loquorâ€™) allâ€™indicativo perfettoâ€
],
teoria:[â€œRipassa tutte le declinazioniâ€,â€œStudia i tempi e modi verbaliâ€,â€œRileggi la sintassi dei casiâ€],
tips:[â€œImpara le desinenze come una tabellaâ€,â€œAnalizza prima di tradurreâ€,â€œCerca i falsi amici con lâ€™italianoâ€]
},
informatica:{
esercizi_base:[
â€œConverti il numero decimale 42 in binarioâ€,
â€œScrivi uno pseudocodice che calcola la somma dei numeri da 1 a 100â€,
â€œCosa fa questo codice? for i in range(5): print(i*2)â€,
â€œDisegna il diagramma di flusso per: â€˜Leggi un numero, se Ã¨ pari stampa PARI altrimenti DISPARIâ€™â€,
â€œQual Ã¨ la differenza tra RAM e ROM?â€,
â€œScrivi la query SQL per selezionare tutti gli studenti con voto > 7â€,
â€œCosâ€™Ã¨ un algoritmo? Scrivi quello per fare una tazza di tÃ¨â€
],
esercizi_avanzati:[
â€œScrivi una funzione ricorsiva per calcolare il fattoriale di nâ€,
â€œSpiega la differenza tra lista e dizionario in Python con esempiâ€,
â€œAnalizza la complessitÃ  di un algoritmo di ricerca lineareâ€,
â€œScrivi una JOIN tra due tabelle: Studenti e Voti in SQLâ€
],
teoria:[â€œRipassa i concetti di base dellâ€™architetturaâ€,â€œStudia i costrutti del linguaggioâ€,â€œRileggi la teoria degli algoritmiâ€],
tips:[â€œTesta sempre il codice step by stepâ€,â€œUsa i commenti per capire la logicaâ€,â€œParti da casi semplici e poi complicaâ€]
},
arte:{
esercizi_base:[
â€œDescrivi la Gioconda di Leonardo: tecnica, soggetto, dettagli particolariâ€,
â€œElenca le caratteristiche principali del Rinascimento italianoâ€,
â€œChi Ã¨ Caravaggio? Spiega la tecnica del chiaroscuro con un suo dipintoâ€,
â€œDifferenza tra Impressionismo e Post-impressionismo: artisti e caratteristicheâ€,
â€œAnalizza La Notte Stellata di Van Gogh: colori, stile, stato dâ€™animoâ€,
â€œCosa rappresenta il Guernica di Picasso? In quale stile Ã¨ dipinto?â€,
â€œElenca 5 musei famosi nel mondo con le opere piÃ¹ importantiâ€
],
esercizi_avanzati:[
â€œConfronta la tecnica di Raffaello e Michelangelo nella Cappella Sistinaâ€,
â€œSpiega come il Cubismo di Picasso rivoluzionÃ² lâ€™arte del â€˜900â€,
â€œAnalizza unâ€™opera astratta: cosa comunica, quali tecniche usaâ€,
â€œCollega lâ€™arte Barocca al suo contesto storico-religiosoâ€
],
teoria:[â€œRipassa i movimenti artistici in ordine cronologicoâ€,â€œStudia gli artisti principali per periodoâ€,â€œRileggi le caratteristiche delle tecniche pittoricheâ€],
tips:[â€œGuarda le immagini in alta risoluzioneâ€,â€œCollega ogni opera al suo contestoâ€,â€œUsa le date per fissare i movimentiâ€]
},
musica:{
esercizi_base:[
â€œScrivi le note della scala di Do maggiore in ordineâ€,
â€œQual Ã¨ il valore di: semibreve, minima, semiminima, croma?â€,
â€œIndica il tempo di: Allegro, Andante, Largo, Prestoâ€,
â€œChi Ã¨ Bach? Elenca 3 sue opere e il loro genere musicaleâ€,
â€œDifferenza tra musica barocca e classica: period, stile, compositoriâ€,
â€œCosâ€™Ã¨ una sonata? E una sinfonia? Quanti movimenti hanno?â€,
â€œElenca gli strumenti dellâ€™orchestra divisi per famigliaâ€
],
esercizi_avanzati:[
â€œAnalizza la struttura di una fuga bachianaâ€,
â€œConfronta lo stile di Mozart e Beethoven con esempi di opereâ€,
â€œSpiega lâ€™evoluzione dalla tonalitÃ  allâ€™atonalitÃ  nel â€˜900â€,
â€œDescrivi le caratteristiche del Romanticismo musicaleâ€
],
teoria:[â€œRipassa le note e i valori ritmiciâ€,â€œStudia i periodi storici della musicaâ€,â€œRileggi i generi musicali principaliâ€],
tips:[â€œAscolta le opere mentre studiâ€,â€œBatti il ritmo per memorizzareâ€,â€œCollega i compositori alla loro epocaâ€]
},
ed_fisica:{
esercizi_base:[
â€œElenca e spiega le 5 capacitÃ  motorie fondamentaliâ€,
â€œQuante persone giocano in una squadra di pallavolo? E di calcio? E di basket?â€,
â€œCosâ€™Ã¨ il VOâ‚‚max? Come si misura e cosa indica?â€,
â€œSpiega la differenza tra sport aerobico e anaerobico con 2 esempi ciascunoâ€,
â€œDescrivi le fasi di un corretto riscaldamento prima dellâ€™attivitÃ  fisicaâ€,
â€œCosa sono le fibre muscolari lente e veloci? Quando vengono usate?â€,
â€œElenca i principi dellâ€™allenamento sportivo (almeno 4)â€
],
esercizi_avanzati:[
â€œSpiega il principio di supercompensazione nellâ€™allenamentoâ€,
â€œAnalizza lâ€™importanza dellâ€™alimentazione per uno sportivoâ€,
â€œDescrivi le regole complete di uno sport a sceltaâ€,
â€œCosâ€™Ã¨ il doping? Spiega effetti fisici e rischi per la saluteâ€
],
teoria:[â€œRipassa la fisiologia dellâ€™esercizioâ€,â€œStudia le regole degli sport principaliâ€,â€œRileggi i principi dellâ€™allenamentoâ€],
tips:[â€œCollega sempre teoria e praticaâ€,â€œUsa schemi corporei per anatomiaâ€,â€œMemorizza le regole con esempi di giocoâ€]
},
altra:{
esercizi_base:[
â€œScrivi le 5 definizioni piÃ¹ importanti dellâ€™argomentoâ€,
â€œElenca i 5 concetti chiave della materia e spiegaliâ€,
â€œCrea 5 domande che potrebbe fare il professore e rispondiciâ€,
â€œSpiega lâ€™argomento come se dovessi insegnarlo a un compagnoâ€,
â€œScrivi un riassunto di 10 righe del capitolo principaleâ€,
â€œCollega lâ€™argomento a qualcosa che conosci giÃ  nella vita realeâ€,
â€œCrea una mappa concettuale con i collegamenti tra i temiâ€
],
esercizi_avanzati:[
â€œAnalizza i pro e contro dellâ€™argomento studiatoâ€,
â€œCerca un esempio pratico per ogni concetto teoricoâ€,
â€œScrivi 3 domande aperte con risposte completeâ€,
â€œConfronta due aspetti diversi dellâ€™argomentoâ€
],
teoria:[â€œRipassa le definizioni fondamentaliâ€,â€œStudia gli esempi principaliâ€,â€œRileggi le parti sottolineateâ€],
tips:[â€œStudia in blocchi da 25 minutiâ€,â€œFai pause attive ogni oraâ€,â€œSpiega ad alta voce per fissare i concettiâ€]
}
};

const MOTIVAZIONI_PER_LIVELLO=[
[â€œğŸ˜´â€,â€œPartiamo dalle basi! Ogni esperto era un principiante. Anche 30 minuti oggi fanno la differenza. Ce la fai! ğŸ’ªâ€],
[â€œğŸ˜Ÿâ€,â€œHai giÃ  qualcosa su cui costruire! Concentrati sui punti deboli e vedrai miglioramenti rapidi. Forza! ğŸš€â€],
[â€œğŸ˜â€,â€œSei a metÃ  strada, ottimo! Un poâ€™ di ripasso mirato e sarai pronto. Continua cosÃ¬! â­â€],
[â€œğŸ˜Šâ€,â€œQuasi pronto! Ripassi veloci e riposo sono tutto quello che ti serve ora. Ottimo lavoro! ğŸ¯â€],
[â€œğŸ”¥â€,â€œSei giÃ  preparato! Fai una revisione rapida, rilassati e dai il massimo domani. Sei una bomba! ğŸ†â€]
];

function generaRipassoOffline(materia, argomento, tipo, livello){
const db=RIPASSO_DB[materia]||RIPASSO_DB.altra;
const [emoji, motivazione]=MOTIVAZIONI_PER_LIVELLO[livello-1];
const mat=MATERIE.find(m=>m.id===materia);
const matLabel=materia===â€œaltraâ€?argomento:(mat?.label||â€œmateriaâ€);
const argTxt=argomento?` â€” "${argomento}"`:â€â€;

// Scegli gli esercizi in base al livello
// Livello 1-2: esercizi base (piÃ¹ facili, con teoria prima)
// Livello 3: metÃ  base metÃ  avanzati
// Livello 4-5: esercizi avanzati (sfidanti)
let pool=[];
if(livello<=2){
pool=[â€¦db.esercizi_base];
} else if(livello===3){
pool=[â€¦db.esercizi_base.slice(0,3),â€¦(db.esercizi_avanzati||[]).slice(0,2)];
} else {
pool=[â€¦(db.esercizi_avanzati||db.esercizi_base),â€¦db.esercizi_base.slice(0,2)];
}
// Mescola un poâ€™ per variare
pool.sort(()=>Math.random()-0.5);
const numEsercizi=livello<=2?5:livello===3?4:4;
const esercizi=pool.slice(0,numEsercizi);
const teoria=db.teoria.slice(0,livello<=2?3:1);
const tips=db.tips.slice(0,2);

let piano=`${emoji} Ripasso: ${tipo||"Verifica"} di ${matLabel}${argTxt}\n`;
piano+=`${"â”€".repeat(35)}\n\n`;

if(livello<=2){
piano+=`ğŸ“š PRIMA RIPASSA LA TEORIA\n`;
teoria.forEach(t=>piano+=`â€¢ ${t}\n`);
piano+=`\n`;
}

piano+=`âœï¸ ESERCIZI DA SVOLGERE\n\n`;
esercizi.forEach((e,i)=>{
piano+=`${i+1}. ${e}\n\n`;
});

if(argomento){
piano+=`ğŸ¯ FOCUS SU: "${argomento}"\n`;
piano+=`â€¢ Rileggi i tuoi appunti specifici su questo tema\n`;
if(tipo===â€œOraleâ€)piano+=`â€¢ Prova a spiegarlo ad alta voce senza guardare\n`;
if(tipo===â€œScrittoâ€||tipo===â€œTestâ€)piano+=`â€¢ Riscrivi le formule/regole principali a memoria\n`;
piano+=`â€¢ Fai 2 esempi pratici sull'argomento\n`;
piano+=`\n`;
}

piano+=`ğŸ’¡ CONSIGLI UTILI\n`;
tips.forEach(t=>piano+=`â€¢ ${t}\n`);
piano+=`\n${motivazione}`;
return piano;
}

// â”€â”€ RICETTE DATABASE (ingredienti precisi) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const RICETTE_DB = {
// PASTA
â€œpasta al pomodoroâ€:     {ingredienti:[{n:â€œSpaghetti o penneâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œAglioâ€,q:â€œ2 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œBasilico frescoâ€,q:â€œ10 foglieâ€,c:â€œğŸ¥¬â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œParmigianoâ€,q:â€œ50gâ€,c:â€œğŸ¥›â€}], porzioni:4},
â€œcarbonaraâ€:             {ingredienti:[{n:â€œSpaghettiâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œGuancialeâ€,q:â€œ150gâ€,c:â€œğŸ¥©â€},{n:â€œUova intereâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œTuorliâ€,q:â€œ4â€,c:â€œğŸ¥›â€},{n:â€œPecorino Romanoâ€,q:â€œ100gâ€,c:â€œğŸ¥›â€},{n:â€œPepe neroâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œamatricianaâ€:           {ingredienti:[{n:â€œBucatiniâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œGuancialeâ€,q:â€œ150gâ€,c:â€œğŸ¥©â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œPecorino Romanoâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œPeperoncinoâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œVino biancoâ€,q:â€œ50mlâ€,c:â€œğŸ·â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œcacio e pepeâ€:          {ingredienti:[{n:â€œSpaghettiâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œPecorino Romanoâ€,q:â€œ120gâ€,c:â€œğŸ¥›â€},{n:â€œPepe nero macinatoâ€,q:â€œ2 cucchiainiâ€,c:â€œğŸ§‚â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œpasta al pestoâ€:        {ingredienti:[{n:â€œTrofie o linguineâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œBasilico frescoâ€,q:â€œ50gâ€,c:â€œğŸ¥¬â€},{n:â€œPinoliâ€,q:â€œ30gâ€,c:â€œğŸŒ°â€},{n:â€œParmigianoâ€,q:â€œ50gâ€,c:â€œğŸ¥›â€},{n:â€œPecorinoâ€,q:â€œ30gâ€,c:â€œğŸ¥›â€},{n:â€œAglioâ€,q:â€œ1 spicchioâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ100mlâ€,c:â€œğŸ¥«â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œlasagneâ€:               {ingredienti:[{n:â€œSfoglie di lasagnaâ€,q:â€œ250gâ€,c:â€œğŸ¥«â€},{n:â€œCarne macinata mistaâ€,q:â€œ400gâ€,c:â€œğŸ¥©â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œBesciamellaâ€,q:â€œ500mlâ€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ100gâ€,c:â€œğŸ¥›â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œCarotaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œSedanoâ€,q:â€œ1 costaâ€,c:â€œğŸ¥¬â€},{n:â€œOlioâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:6},
â€œpasta al fornoâ€:        {ingredienti:[{n:â€œPasta corta (rigatoni/penne)â€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œRagÃ¹ di carneâ€,q:â€œ400gâ€,c:â€œğŸ¥©â€},{n:â€œMozzarellaâ€,q:â€œ200gâ€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œBasilicoâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€}], porzioni:4},
â€œpasta e fagioliâ€:       {ingredienti:[{n:â€œPasta mista cortaâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œFagioli borlottiâ€,q:â€œ400g (latta)â€,c:â€œğŸ¥«â€},{n:â€œPancettaâ€,q:â€œ80gâ€,c:â€œğŸ¥©â€},{n:â€œAglioâ€,q:â€œ2 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œRosmarinoâ€,q:â€œ1 ramettoâ€,c:â€œğŸ¥¬â€},{n:â€œPomodori pelatiâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œBrodo vegetaleâ€,q:â€œ1Lâ€,c:â€œğŸ¥«â€},{n:â€œOlioâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€}], porzioni:4},
â€œspaghetti alle vongoleâ€:{ingredienti:[{n:â€œSpaghettiâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œVongoleâ€,q:â€œ1kgâ€,c:â€œğŸŸâ€},{n:â€œAglioâ€,q:â€œ3 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œPrezzemoloâ€,q:â€œ1 mazzettoâ€,c:â€œğŸ¥¬â€},{n:â€œVino biancoâ€,q:â€œ100mlâ€,c:â€œğŸ·â€},{n:â€œOlio extravergineâ€,q:â€œ5 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œPeperoncinoâ€,q:â€œ1â€,c:â€œğŸ¥¬â€}], porzioni:4},

// RISOTTO
â€œrisottoâ€:               {ingredienti:[{n:â€œRiso Carnaroli o Arborioâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œVino bianco seccoâ€,q:â€œ100mlâ€,c:â€œğŸ·â€},{n:â€œBrodo caldoâ€,q:â€œ1,2Lâ€,c:â€œğŸ¥«â€},{n:â€œBurroâ€,q:â€œ60gâ€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œOlioâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œrisotto ai funghiâ€:     {ingredienti:[{n:â€œRiso Carnaroliâ€,q:â€œ320gâ€,c:â€œğŸ¥«â€},{n:â€œFunghi porcini (freschi o secchi)â€,q:â€œ300gâ€,c:â€œğŸ„â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œVino biancoâ€,q:â€œ100mlâ€,c:â€œğŸ·â€},{n:â€œBrodoâ€,q:â€œ1,2Lâ€,c:â€œğŸ¥«â€},{n:â€œBurroâ€,q:â€œ60gâ€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œPrezzemoloâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€}], porzioni:4},

// CARNE
â€œpollo arrostoâ€:         {ingredienti:[{n:â€œPollo interoâ€,q:â€œ1,5kgâ€,c:â€œğŸ¥©â€},{n:â€œRosmarinoâ€,q:â€œ3 ramettiâ€,c:â€œğŸ¥¬â€},{n:â€œAglioâ€,q:â€œ4 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œLimoneâ€,q:â€œ1â€,c:â€œğŸ‹â€},{n:â€œOlio extravergineâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSale grossoâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPatateâ€,q:â€œ600gâ€,c:â€œğŸ¥¬â€}], porzioni:4},
â€œpollo al limoneâ€:       {ingredienti:[{n:â€œPetto di polloâ€,q:â€œ600gâ€,c:â€œğŸ¥©â€},{n:â€œLimoniâ€,q:â€œ2â€,c:â€œğŸ‹â€},{n:â€œAglioâ€,q:â€œ2 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œFarinaâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œBurroâ€,q:â€œ30gâ€,c:â€œğŸ¥›â€},{n:â€œOlioâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œPrezzemoloâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œcotolettaâ€:             {ingredienti:[{n:â€œFette di vitello o polloâ€,q:â€œ4â€,c:â€œğŸ¥©â€},{n:â€œUovaâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œPangrattatoâ€,q:â€œ150gâ€,c:â€œğŸ¥«â€},{n:â€œFarinaâ€,q:â€œ50gâ€,c:â€œğŸ¥«â€},{n:â€œBurroâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œLimoneâ€,q:â€œ1â€,c:â€œğŸ‹â€}], porzioni:4},
â€œbisteccaâ€:              {ingredienti:[{n:â€œBistecca (fiorentina/controfiletto)â€,q:â€œ800gâ€,c:â€œğŸ¥©â€},{n:â€œSale grossoâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPepe neroâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œRosmarinoâ€,q:â€œ2 ramettiâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œBurroâ€,q:â€œ20gâ€,c:â€œğŸ¥›â€}], porzioni:2},
â€œhamburgerâ€:             {ingredienti:[{n:â€œCarne macinata di manzoâ€,q:â€œ500gâ€,c:â€œğŸ¥©â€},{n:â€œPanini hamburgerâ€,q:â€œ4â€,c:â€œğŸ¥«â€},{n:â€œLattugaâ€,q:â€œ4 foglieâ€,c:â€œğŸ¥¬â€},{n:â€œPomodoriâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œCipolla rossaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œFormaggio cheddarâ€,q:â€œ4 fetteâ€,c:â€œğŸ¥›â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œKetchup/maioneseâ€,q:â€œq.b.â€,c:â€œğŸ¥«â€}], porzioni:4},
â€œpolpetteâ€:              {ingredienti:[{n:â€œCarne macinata mistaâ€,q:â€œ500gâ€,c:â€œğŸ¥©â€},{n:â€œPane raffermoâ€,q:â€œ100gâ€,c:â€œğŸ¥«â€},{n:â€œLatteâ€,q:â€œ100mlâ€,c:â€œğŸ¥›â€},{n:â€œUovaâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ50gâ€,c:â€œğŸ¥›â€},{n:â€œPrezzemoloâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œAglioâ€,q:â€œ1 spicchioâ€,c:â€œğŸ¥¬â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€}], porzioni:4},
â€œragÃ¹â€:                  {ingredienti:[{n:â€œCarne macinata mistaâ€,q:â€œ400gâ€,c:â€œğŸ¥©â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œCarotaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œSedanoâ€,q:â€œ1 costaâ€,c:â€œğŸ¥¬â€},{n:â€œVino rossoâ€,q:â€œ100mlâ€,c:â€œğŸ·â€},{n:â€œOlioâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œLatteâ€,q:â€œ50mlâ€,c:â€œğŸ¥›â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},

// PESCE
â€œsalmoneâ€:               {ingredienti:[{n:â€œFiletti di salmoneâ€,q:â€œ600gâ€,c:â€œğŸŸâ€},{n:â€œLimoneâ€,q:â€œ1â€,c:â€œğŸ‹â€},{n:â€œOlio extravergineâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œAneto o prezzemoloâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œAglioâ€,q:â€œ1 spicchioâ€,c:â€œğŸ¥¬â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œbaccalÃ â€:               {ingredienti:[{n:â€œBaccalÃ  giÃ  ammollatoâ€,q:â€œ600gâ€,c:â€œğŸŸâ€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œOlive nereâ€,q:â€œ80gâ€,c:â€œğŸ¥¬â€},{n:â€œCapperiâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥¬â€},{n:â€œAglioâ€,q:â€œ2 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œPrezzemoloâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œOlioâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€}], porzioni:4},

// PIZZA
â€œpizzaâ€:                 {ingredienti:[{n:â€œFarina 00â€,q:â€œ500gâ€,c:â€œğŸ¥«â€},{n:â€œLievito di birra frescoâ€,q:â€œ12gâ€,c:â€œğŸ¥«â€},{n:â€œAcqua tiepidaâ€,q:â€œ300mlâ€,c:â€œğŸ’§â€},{n:â€œSaleâ€,q:â€œ10gâ€,c:â€œğŸ§‚â€},{n:â€œOlio extravergineâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œPomodori pelatiâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œMozzarella fior di latteâ€,q:â€œ300gâ€,c:â€œğŸ¥›â€},{n:â€œBasilicoâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€}], porzioni:4},
â€œpizza margheritaâ€:      {ingredienti:[{n:â€œFarina 00â€,q:â€œ500gâ€,c:â€œğŸ¥«â€},{n:â€œLievito di birra frescoâ€,q:â€œ12gâ€,c:â€œğŸ¥«â€},{n:â€œAcqua tiepidaâ€,q:â€œ300mlâ€,c:â€œğŸ’§â€},{n:â€œSaleâ€,q:â€œ10gâ€,c:â€œğŸ§‚â€},{n:â€œOlio extravergineâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œPomodori San Marzanoâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œMozzarella di bufalaâ€,q:â€œ250gâ€,c:â€œğŸ¥›â€},{n:â€œBasilico frescoâ€,q:â€œ10 foglieâ€,c:â€œğŸ¥¬â€}], porzioni:4},

// DOLCI
â€œtiramisÃ¹â€:              {ingredienti:[{n:â€œMascarponeâ€,q:â€œ500gâ€,c:â€œğŸ¥›â€},{n:â€œUovaâ€,q:â€œ4â€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ100gâ€,c:â€œğŸ§‚â€},{n:â€œSavoiardiâ€,q:â€œ300gâ€,c:â€œğŸ§â€},{n:â€œCaffÃ¨ espressoâ€,q:â€œ300mlâ€,c:â€œâ˜•â€},{n:â€œCacao amaroâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ§â€},{n:â€œMarsala (opzionale)â€,q:â€œ2 cucchiaiâ€,c:â€œğŸ·â€}], porzioni:8},
â€œpanna cottaâ€:           {ingredienti:[{n:â€œPanna frescaâ€,q:â€œ500mlâ€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ80gâ€,c:â€œğŸ§‚â€},{n:â€œGelatina in fogliâ€,q:â€œ8gâ€,c:â€œğŸ§â€},{n:â€œVanigliaâ€,q:â€œ1 baccaâ€,c:â€œğŸ§â€},{n:â€œFrutti di boscoâ€,q:â€œ200g (per salsa)â€,c:â€œğŸ“â€}], porzioni:6},
â€œtorta al cioccolatoâ€:   {ingredienti:[{n:â€œCioccolato fondenteâ€,q:â€œ200gâ€,c:â€œğŸ«â€},{n:â€œBurroâ€,q:â€œ150gâ€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ180gâ€,c:â€œğŸ§‚â€},{n:â€œUovaâ€,q:â€œ4â€,c:â€œğŸ¥›â€},{n:â€œFarinaâ€,q:â€œ100gâ€,c:â€œğŸ¥«â€},{n:â€œCacao amaroâ€,q:â€œ30gâ€,c:â€œğŸ«â€},{n:â€œLievitoâ€,q:â€œ1 bustinaâ€,c:â€œğŸ§â€},{n:â€œSaleâ€,q:â€œ1 pizzicoâ€,c:â€œğŸ§‚â€}], porzioni:8},
â€œcheesecakeâ€:            {ingredienti:[{n:â€œBiscotti Digestiveâ€,q:â€œ200gâ€,c:â€œğŸ§â€},{n:â€œBurro fusoâ€,q:â€œ100gâ€,c:â€œğŸ¥›â€},{n:â€œFormaggio spalmabile (Philadelphia)â€,q:â€œ600gâ€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ150gâ€,c:â€œğŸ§‚â€},{n:â€œUovaâ€,q:â€œ3â€,c:â€œğŸ¥›â€},{n:â€œPanna frescaâ€,q:â€œ100mlâ€,c:â€œğŸ¥›â€},{n:â€œSucco di limoneâ€,q:â€œ1â€,c:â€œğŸ‹â€},{n:â€œVanigliaâ€,q:â€œ1 cucchiainoâ€,c:â€œğŸ§â€}], porzioni:8},
â€œcrostataâ€:              {ingredienti:[{n:â€œFarinaâ€,q:â€œ300gâ€,c:â€œğŸ¥«â€},{n:â€œBurro freddoâ€,q:â€œ150gâ€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ100gâ€,c:â€œğŸ§‚â€},{n:â€œUovaâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œMarmellataâ€,q:â€œ300gâ€,c:â€œğŸ§â€},{n:â€œScorza di limoneâ€,q:â€œ1â€,c:â€œğŸ‹â€},{n:â€œSaleâ€,q:â€œ1 pizzicoâ€,c:â€œğŸ§‚â€}], porzioni:8},
â€œpancakesâ€:              {ingredienti:[{n:â€œFarinaâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œLatteâ€,q:â€œ250mlâ€,c:â€œğŸ¥›â€},{n:â€œUovaâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ30gâ€,c:â€œğŸ§‚â€},{n:â€œLievito per dolciâ€,q:â€œ1 bustinaâ€,c:â€œğŸ§â€},{n:â€œBurro fusoâ€,q:â€œ30gâ€,c:â€œğŸ¥›â€},{n:â€œSaleâ€,q:â€œ1 pizzicoâ€,c:â€œğŸ§‚â€},{n:â€œSciroppo dâ€™aceroâ€,q:â€œq.b.â€,c:â€œğŸ§â€}], porzioni:4},
â€œmuffinâ€:                {ingredienti:[{n:â€œFarinaâ€,q:â€œ250gâ€,c:â€œğŸ¥«â€},{n:â€œZuccheroâ€,q:â€œ150gâ€,c:â€œğŸ§‚â€},{n:â€œLatteâ€,q:â€œ120mlâ€,c:â€œğŸ¥›â€},{n:â€œUovaâ€,q:â€œ2â€,c:â€œğŸ¥›â€},{n:â€œOlio di semiâ€,q:â€œ80mlâ€,c:â€œğŸ¥«â€},{n:â€œLievitoâ€,q:â€œ1 bustinaâ€,c:â€œğŸ§â€},{n:â€œGocce di cioccolatoâ€,q:â€œ100gâ€,c:â€œğŸ«â€},{n:â€œSaleâ€,q:â€œ1 pizzicoâ€,c:â€œğŸ§‚â€}], porzioni:12},
â€œbiscottiâ€:              {ingredienti:[{n:â€œFarinaâ€,q:â€œ300gâ€,c:â€œğŸ¥«â€},{n:â€œBurro morbidoâ€,q:â€œ150gâ€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ120gâ€,c:â€œğŸ§‚â€},{n:â€œUovaâ€,q:â€œ1â€,c:â€œğŸ¥›â€},{n:â€œVanigliaâ€,q:â€œ1 cucchiainoâ€,c:â€œğŸ§â€},{n:â€œLievitoâ€,q:â€œ1/2 bustinaâ€,c:â€œğŸ§â€},{n:â€œSaleâ€,q:â€œ1 pizzicoâ€,c:â€œğŸ§‚â€}], porzioni:30},
â€œgelatoâ€:                {ingredienti:[{n:â€œLatte interoâ€,q:â€œ500mlâ€,c:â€œğŸ¥›â€},{n:â€œPanna frescaâ€,q:â€œ200mlâ€,c:â€œğŸ¥›â€},{n:â€œTuorliâ€,q:â€œ4â€,c:â€œğŸ¥›â€},{n:â€œZuccheroâ€,q:â€œ150gâ€,c:â€œğŸ§‚â€},{n:â€œVanigliaâ€,q:â€œ1 baccaâ€,c:â€œğŸ§â€}], porzioni:6},

// ZUPPE E MINESTRE
â€œminestroneâ€:            {ingredienti:[{n:â€œPatateâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œCaroteâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œZucchineâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œFagioli borlottiâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œPiselliâ€,q:â€œ100gâ€,c:â€œğŸ¥¬â€},{n:â€œPomodori pelatiâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œSedanoâ€,q:â€œ2 costeâ€,c:â€œğŸ¥¬â€},{n:â€œBrodo vegetaleâ€,q:â€œ1,5Lâ€,c:â€œğŸ¥«â€},{n:â€œOlioâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œPasta o risoâ€,q:â€œ100gâ€,c:â€œğŸ¥«â€}], porzioni:6},
â€œzuppa di lenticchieâ€:   {ingredienti:[{n:â€œLenticchie rosseâ€,q:â€œ300gâ€,c:â€œğŸ¥«â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œCarotaâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œSedanoâ€,q:â€œ2 costeâ€,c:â€œğŸ¥¬â€},{n:â€œPomodori pelatiâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œCurcumaâ€,q:â€œ1 cucchiainoâ€,c:â€œğŸ§‚â€},{n:â€œCuminoâ€,q:â€œ1 cucchiainoâ€,c:â€œğŸ§‚â€},{n:â€œBrodoâ€,q:â€œ1Lâ€,c:â€œğŸ¥«â€},{n:â€œOlioâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€}], porzioni:4},
â€œribollitaâ€:             {ingredienti:[{n:â€œCavolo neroâ€,q:â€œ300gâ€,c:â€œğŸ¥¬â€},{n:â€œFagioli cannelliniâ€,q:â€œ400gâ€,c:â€œğŸ¥«â€},{n:â€œPane raffermo toscanoâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œPatateâ€,q:â€œ2â€,c:â€œğŸ¥¬â€},{n:â€œPomodori pelatiâ€,q:â€œ200gâ€,c:â€œğŸ¥«â€},{n:â€œCipollaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œCarotaâ€,q:â€œ1â€,c:â€œğŸ¥¬â€},{n:â€œSedanoâ€,q:â€œ2 costeâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ6 cucchiaiâ€,c:â€œğŸ¥«â€}], porzioni:6},

// UOVA
â€œfrittataâ€:              {ingredienti:[{n:â€œUovaâ€,q:â€œ6â€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ40gâ€,c:â€œğŸ¥›â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œOlio o burroâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œRipieno a scelta (verdure/prosciutto)â€,q:â€œ200gâ€,c:â€œğŸ¥¬â€}], porzioni:4},
â€œuova strapazzateâ€:      {ingredienti:[{n:â€œUovaâ€,q:â€œ4â€,c:â€œğŸ¥›â€},{n:â€œBurroâ€,q:â€œ20gâ€,c:â€œğŸ¥›â€},{n:â€œPannaâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥›â€},{n:â€œSale e pepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œErba cipollinaâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€}], porzioni:2},

// VERDURE E CONTORNI
â€œmelanzane alla parmigianaâ€:{ingredienti:[{n:â€œMelanzaneâ€,q:â€œ1kgâ€,c:â€œğŸ¥¬â€},{n:â€œPomodori pelatiâ€,q:â€œ600gâ€,c:â€œğŸ¥«â€},{n:â€œMozzarellaâ€,q:â€œ250gâ€,c:â€œğŸ¥›â€},{n:â€œParmigianoâ€,q:â€œ80gâ€,c:â€œğŸ¥›â€},{n:â€œBasilicoâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œOlio per friggereâ€,q:â€œq.b.â€,c:â€œğŸ¥«â€},{n:â€œSaleâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:6},
â€œinsalata capreseâ€:      {ingredienti:[{n:â€œPomodori maturiâ€,q:â€œ4â€,c:â€œğŸ¥¬â€},{n:â€œMozzarella di bufalaâ€,q:â€œ250gâ€,c:â€œğŸ¥›â€},{n:â€œBasilico frescoâ€,q:â€œ1 mazzettoâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ3 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSale grossoâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},
â€œpatate al fornoâ€:       {ingredienti:[{n:â€œPatateâ€,q:â€œ1kgâ€,c:â€œğŸ¥¬â€},{n:â€œRosmarinoâ€,q:â€œ3 ramettiâ€,c:â€œğŸ¥¬â€},{n:â€œAglioâ€,q:â€œ3 spicchiâ€,c:â€œğŸ¥¬â€},{n:â€œOlio extravergineâ€,q:â€œ4 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSale grossoâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€},{n:â€œPepeâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:4},

// PANE
â€œpaneâ€:                  {ingredienti:[{n:â€œFarina 0â€,q:â€œ500gâ€,c:â€œğŸ¥«â€},{n:â€œLievito di birra frescoâ€,q:â€œ15gâ€,c:â€œğŸ¥«â€},{n:â€œAcqua tiepidaâ€,q:â€œ320mlâ€,c:â€œğŸ’§â€},{n:â€œSaleâ€,q:â€œ10gâ€,c:â€œğŸ§‚â€},{n:â€œOlio extravergineâ€,q:â€œ2 cucchiaiâ€,c:â€œğŸ¥«â€}], porzioni:1},
â€œfocacciaâ€:              {ingredienti:[{n:â€œFarina 00â€,q:â€œ500gâ€,c:â€œğŸ¥«â€},{n:â€œLievito di birra frescoâ€,q:â€œ15gâ€,c:â€œğŸ¥«â€},{n:â€œAcqua tiepidaâ€,q:â€œ350mlâ€,c:â€œğŸ’§â€},{n:â€œOlio extravergineâ€,q:â€œ6 cucchiaiâ€,c:â€œğŸ¥«â€},{n:â€œSaleâ€,q:â€œ10gâ€,c:â€œğŸ§‚â€},{n:â€œRosmarinoâ€,q:â€œq.b.â€,c:â€œğŸ¥¬â€},{n:â€œSale grossoâ€,q:â€œq.b.â€,c:â€œğŸ§‚â€}], porzioni:6},
};

// Cerca la ricetta migliore nel testo inserito
function trovaRicetta(input) {
const testo = input.toLowerCase()
.normalize(â€œNFDâ€).replace(/[\u0300-\u036f]/g,â€â€) // rimuovi accenti
.replace(/[Ã Ã¡Ã¢Ã£]/g,â€œaâ€).replace(/[Ã¨Ã©Ãª]/g,â€œeâ€).replace(/[Ã¬Ã­Ã®]/g,â€œiâ€)
.replace(/[Ã²Ã³Ã´]/g,â€œoâ€).replace(/[Ã¹ÃºÃ»]/g,â€œuâ€);

// Alias per gestire varianti
const alias = {
â€œcarbonaraâ€:[â€œcarbonaraâ€,â€œcarbâ€],
â€œamatricianaâ€:[â€œamatricianaâ€,â€œamatrixâ€],
â€œcacio e pepeâ€:[â€œcacio e pepeâ€,â€œcacioâ€],
â€œpasta al pomodoroâ€:[â€œpomodoroâ€,â€œal sugoâ€,â€œsugo di pomodoroâ€,â€œpasta sempliceâ€],
â€œpasta al pestoâ€:[â€œpestoâ€,â€œal pestoâ€],
â€œpasta e fagioliâ€:[â€œpasta e fagioliâ€,â€œpasta fagioliâ€],
â€œspaghetti alle vongoleâ€:[â€œvongoleâ€,â€œalle vongoleâ€],
â€œlasagneâ€:[â€œlasagneâ€,â€œlasagnaâ€],
â€œpasta al fornoâ€:[â€œpasta al fornoâ€,â€œfornoâ€],
â€œrisotto ai funghiâ€:[â€œrisotto ai funghiâ€,â€œfunghiâ€],
â€œrisottoâ€:[â€œrisottoâ€],
â€œpollo arrostoâ€:[â€œpollo arrostoâ€,â€œarrostoâ€],
â€œpollo al limoneâ€:[â€œpollo al limoneâ€,â€œpollo limoneâ€],
â€œcotolettaâ€:[â€œcotolettaâ€,â€œmilaneseâ€],
â€œbisteccaâ€:[â€œbisteccaâ€,â€œfiorentinaâ€,â€œtagliataâ€],
â€œhamburgerâ€:[â€œhamburgerâ€,â€œburgerâ€],
â€œpolpetteâ€:[â€œpolpetteâ€,â€œpolpettaâ€],
â€œraguâ€:[â€œraguâ€,â€œbologneseâ€,â€œal raguâ€],
â€œsalmoneâ€:[â€œsalmoneâ€],
â€œbaccalaâ€:[â€œbaccalaâ€,â€œstoccafissoâ€],
â€œpizza margheritaâ€:[â€œmargheritaâ€],
â€œpizzaâ€:[â€œpizzaâ€],
â€œtiramisuâ€:[â€œtiramisuâ€],
â€œpanna cottaâ€:[â€œpanna cottaâ€,â€œpannacottaâ€],
â€œtorta al cioccolatoâ€:[â€œtorta al cioccolatoâ€,â€œtorta cioccolatoâ€,â€œdolce cioccolatoâ€],
â€œcheesecakeâ€:[â€œcheesecakeâ€,â€œcheese cakeâ€],
â€œcrostataâ€:[â€œcrostataâ€,â€œcrostata marmellataâ€],
â€œpancakesâ€:[â€œpancakesâ€,â€œpancakeâ€],
â€œmuffinâ€:[â€œmuffinâ€],
â€œbiscottiâ€:[â€œbiscottiâ€,â€œbiscottoâ€,â€œcookiesâ€],
â€œgelatoâ€:[â€œgelatoâ€],
â€œminestroneâ€:[â€œminestroneâ€,â€œminestraâ€],
â€œzuppa di lenticchieâ€:[â€œlenticchieâ€,â€œzuppa lenticchieâ€],
â€œribollitaâ€:[â€œribollitaâ€],
â€œfrittataâ€:[â€œfrittataâ€],
â€œuova strapazzateâ€:[â€œuova strapazzateâ€,â€œstrapazzateâ€],
â€œmelanzane alla parmigianaâ€:[â€œparmigianaâ€,â€œmelanzane parmigianaâ€],
â€œinsalata capreseâ€:[â€œcapreseâ€,â€œinsalata capreseâ€],
â€œpatate al fornoâ€:[â€œpatate al fornoâ€,â€œpatateâ€],
â€œpaneâ€:[â€œpane fatto in casaâ€,â€œpaneâ€],
â€œfocacciaâ€:[â€œfocacciaâ€],
};

// Cerca match
for(const [chiave, varianti] of Object.entries(alias)){
for(const v of varianti){
if(testo.includes(v)){
// Trova la ricetta giusta nel DB
const nomeDB = Object.keys(RICETTE_DB).find(k=>k===chiave||k.includes(chiave.split(â€ â€œ)[0]));
if(nomeDB && RICETTE_DB[nomeDB]) return {nome:nomeDB, ricetta:RICETTE_DB[nomeDB]};
}
}
}
return null;
}

function generaListaSpesaOffline(piatti){
const righe = piatti.split(/[\n,]+/).map(r=>r.trim()).filter(r=>r.length>1);
const listaUnificata = [];
const ricetteTrovate = [];
const nonTrovate = [];

for(const riga of righe){
const match = trovaRicetta(riga);
if(match){
ricetteTrovate.push(match.nome);
for(const ing of match.ricetta.ingredienti){
const esistente = listaUnificata.find(i=>i.nome.toLowerCase()===ing.n.toLowerCase());
if(!esistente) listaUnificata.push({nome:ing.n, quantita:ing.q, categoria:ing.c});
}
} else {
nonTrovate.push(riga);
}
}

// Se non trova niente usa ricette di base
if(listaUnificata.length===0){
return {
lista:[
{nome:â€œIngrediente principaleâ€,quantita:â€œ400gâ€,categoria:â€œğŸ¥©â€},
{nome:â€œOlio extravergineâ€,quantita:â€œq.b.â€,categoria:â€œğŸ¥«â€},
{nome:â€œSale e pepeâ€,quantita:â€œq.b.â€,categoria:â€œğŸ§‚â€},
{nome:â€œAglioâ€,quantita:â€œ2 spicchiâ€,categoria:â€œğŸ¥¬â€},
],
suggerimenti:[{nome:â€œScrivi il nome del piattoâ€,motivo:â€œEs: pasta carbonara, pizza, tiramisÃ¹â€}],
ricetteTrovate:[],
nonTrovate:righe
};
}

const suggerimenti = [];
if(nonTrovate.length>0) suggerimenti.push({nome:â€œRicetta non trovata: â€œ+nonTrovate.join(â€, â€œ), motivo:â€œProva a scrivere il nome per estesoâ€});
suggerimenti.push({nome:â€œAcqua mineraleâ€,motivo:â€œSempre utileâ€});
if(!listaUnificata.find(i=>i.nome.toLowerCase().includes(â€œolioâ€)))
suggerimenti.push({nome:â€œOlio extravergineâ€,motivo:â€œBase di quasi tutte le ricetteâ€});

return {lista:listaUnificata, suggerimenti, ricetteTrovate, nonTrovate};
}

// â”€â”€ METEO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function useMeteo(){
const [meteo,setMeteo]=useState(null);
useEffect(()=>{
if(!navigator.geolocation){return;}
navigator.geolocation.getCurrentPosition(async pos=>{
try{
const {latitude:lat,longitude:lon}=pos.coords;
const r=await fetch(`https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current=temperature_2m,weather_code&timezone=auto`);
const d=await r.json();
const temp=Math.round(d.current.temperature_2m);
const code=d.current.weather_code;
const icon=code<=1?â€œâ˜€ï¸â€:code<=3?â€œâ›…â€:code<=48?â€œğŸŒ«ï¸â€:code<=67?â€œğŸŒ§ï¸â€:code<=77?â€œğŸŒ¨ï¸â€:code<=82?â€œğŸŒ§ï¸â€:â€œâ›ˆï¸â€;
setMeteo({temp,icon});
}catch{}
},()=>{},{timeout:5000});
},[]);
return meteo;
}

// â”€â”€ SWIPEABLE CALENDAR â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function SwipeCalendar({year,month,events,alerts,onDay,onMonthChange}){
const containerRef=useRef(null);
const startX=useRef(null);
const startY=useRef(null);
const currentX=useRef(0);
const isDragging=useRef(false);
const hasMoved=useRef(false);
const [offset,setOffset]=useState(0);
const [animating,setAnimating]=useState(false);
const W=useRef(375);

useEffect(()=>{if(containerRef.current)W.current=containerRef.current.offsetWidth;},[]);

const onTouchStart=e=>{
if(animating)return;
startX.current=e.touches[0].clientX;
startY.current=e.touches[0].clientY;
isDragging.current=false;
hasMoved.current=false;
};
const onTouchMove=e=>{
if(startX.current===null)return;
const dx=e.touches[0].clientX-startX.current;
const dy=Math.abs(e.touches[0].clientY-startY.current);
if(!isDragging.current){
if(dy>Math.abs(dx)||Math.abs(dx)<8)return;
isDragging.current=true;
}
e.preventDefault();
hasMoved.current=Math.abs(dx)>12;
currentX.current=dx;
setOffset(dx);
};
const onTouchEnd=e=>{
if(!isDragging.current){startX.current=null;return;}
const dx=currentX.current;
const threshold=W.current*0.28;
setAnimating(true);
if(dx<-threshold){
setOffset(-W.current);
setTimeout(()=>{const n=addMonths(year,month,1);onMonthChange(n.year,n.month);setOffset(0);setAnimating(false);},280);
} else if(dx>threshold){
setOffset(W.current);
setTimeout(()=>{const n=addMonths(year,month,-1);onMonthChange(n.year,n.month);setOffset(0);setAnimating(false);},280);
} else {
setOffset(0);
setTimeout(()=>setAnimating(false),280);
}
startX.current=null;
isDragging.current=false;
currentX.current=0;
};

// Only fire onDay if swipe did NOT move significantly
const handleDayClick=useCallback((key)=>{
if(!hasMoved.current&&!animating) onDay(key);
},[animating]);

const prev=addMonths(year,month,-1);
const next=addMonths(year,month,1);

return (
<div ref={containerRef} style={{overflow:â€œhiddenâ€,touchAction:â€œpan-yâ€}}
onTouchStart={onTouchStart} onTouchMove={onTouchMove} onTouchEnd={onTouchEnd}>
<div style={{display:â€œflexâ€,width:â€œ300%â€,transform:`translateX(calc(-33.333% + ${offset}px))`,transition:animating?â€œtransform 0.28s cubic-bezier(0.25,0.46,0.45,0.94)â€:â€œnoneâ€,willChange:â€œtransformâ€}}>
<div style={{width:â€œ33.333%â€,flexShrink:0}}><MonthGrid year={prev.year} month={prev.month} events={events} alerts={alerts} onDay={handleDayClick}/></div>
<div style={{width:â€œ33.333%â€,flexShrink:0}}><MonthGrid year={year} month={month} events={events} alerts={alerts} onDay={handleDayClick}/></div>
<div style={{width:â€œ33.333%â€,flexShrink:0}}><MonthGrid year={next.year} month={next.month} events={events} alerts={alerts} onDay={handleDayClick}/></div>
</div>
</div>
);
}

function MonthGrid({year,month,events,alerts,onDay}){
const {dark}=React.useContext(ThemeCtx);
const fd=firstDay(year,month),td=daysIn(year,month);
const getDay=k=>events[k]||[];
return (
<div style={{padding:â€œ0 4pxâ€}}>
<div style={{display:â€œgridâ€,gridTemplateColumns:â€œrepeat(7,1fr)â€,marginBottom:â€œ4pxâ€}}>
{DAYS.map((d,i)=><div key={i} style={{textAlign:â€œcenterâ€,fontSize:â€œ11pxâ€,fontWeight:â€œ600â€,color:i>=5?â€#FF9500â€:dark?â€œrgba(255,255,255,0.3)â€:â€œrgba(60,60,67,0.38)â€,padding:â€œ3px 0â€}}>{d}</div>)}
</div>
<div style={{display:â€œgridâ€,gridTemplateColumns:â€œrepeat(7,1fr)â€,rowGap:â€œ1pxâ€}}>
{Array.from({length:fd},(*,i)=><div key={`e${i}`}/>)}
{Array.from({length:td},(*,i)=>{
const day=i+1,key=fmt(year,month,day);
const evs=getDay(key),isT=key===todayStr,isW=(fd+i)%7>=5;
const isPast=key<todayStr;
const cats=[â€¦new Set(evs.map(e=>e.category))].slice(0,3);
const hasAl=alerts.some(a=>a.day===key);
const diff=daysBetween(key);
return (
<div key={key} onClick={()=>onDay(key)}
style={{aspectRatio:â€œ1â€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,alignItems:â€œcenterâ€,justifyContent:â€œcenterâ€,cursor:â€œpointerâ€,position:â€œrelativeâ€,borderRadius:â€œ50%â€,WebkitTapHighlightColor:â€œtransparentâ€}}>
{isT&&<div style={{position:â€œabsoluteâ€,inset:â€œ8%â€,borderRadius:â€œ50%â€,background:â€#FF3B30â€}}/>}
{hasAl&&!isT&&<div style={{position:â€œabsoluteâ€,inset:â€œ8%â€,borderRadius:â€œ50%â€,border:â€œ1.5px solid #FF3B30â€}}/>}
<div style={{fontSize:â€œ15pxâ€,fontWeight:isT?â€œ600â€:â€œ400â€,color:isT?â€#fffâ€:isPast?(dark?â€œrgba(255,255,255,0.18)â€:â€œrgba(60,60,67,0.22)â€):isW?â€#FF9500â€:dark?â€#fffâ€:â€#1C1C1Eâ€,position:â€œrelativeâ€,zIndex:1,lineHeight:1,marginBottom:cats.length?â€œ3pxâ€:â€œ0â€}}>{day}</div>
{cats.length>0&&<div style={{display:â€œflexâ€,gap:â€œ2pxâ€,position:â€œrelativeâ€,zIndex:1}}>{cats.map(cid=><div key={cid} style={{width:â€œ4pxâ€,height:â€œ4pxâ€,borderRadius:â€œ50%â€,background:isT?â€œrgba(255,255,255,0.85)â€:getCat(cid).color}}/>)}</div>}
{/* Countdown badge for verifiche */}
{!isT&&diff>0&&diff<=5&&evs.some(e=>e.category===â€œverificaâ€)&&(
<div style={{position:â€œabsoluteâ€,top:â€-1pxâ€,right:â€-1pxâ€,background:â€#FF3B30â€,borderRadius:â€œ6pxâ€,padding:â€œ1px 3pxâ€,fontSize:â€œ8pxâ€,fontWeight:â€œ700â€,color:â€#fffâ€,zIndex:2,lineHeight:1}}>{diff}g</div>
)}
</div>
);
})}
</div>
</div>
);
}

// â”€â”€ GEMINI KEY SETUP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function GeminiSetup({onDone,onClose,dark}){
const [key,setKey]=useState(getGeminiKey());
const [testing,setTesting]=useState(false);
const [err,setErr]=useState(â€â€);
const bg=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const card=dark?â€#2C2C2Eâ€:â€#fffâ€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.4)â€:â€œrgba(60,60,67,0.45)â€;

const test=async()=>{
if(!key.trim())return;
setTesting(true);setErr(â€â€);
try{
await callAI(â€œRispondi solo con: OKâ€);
saveGeminiKey(key.trim());
onDone();
}catch(e){
if(e.message===â€œNO_KEYâ€)
setErr(â€œâŒ Inserisci la chiave prima.â€);
else if(e.message.startsWith(â€œRETE:â€))
setErr(â€œâŒ Errore di rete â€” controlla la connessione internet.â€);
else if(e.message.startsWith(â€œGEMINI:â€))
setErr(â€œâŒ â€œ+e.message.replace(â€œGEMINI: â€œ,â€â€));
else
setErr(â€œâŒ â€œ+e.message);
}
setTesting(false);
};

return (
<div style={{padding:â€œ0 16px 16pxâ€}}>
<div style={{background:card,borderRadius:â€œ16pxâ€,padding:â€œ16pxâ€,marginBottom:â€œ14pxâ€}}>
<div style={{fontSize:â€œ15pxâ€,fontWeight:â€œ700â€,color:txt,marginBottom:â€œ6pxâ€}}>ğŸ”‘ Configura Gemini AI</div>
<div style={{fontSize:â€œ13pxâ€,color:sub,lineHeight:1.5,marginBottom:â€œ14pxâ€}}>
Per usare il Ripasso AI e la Lista Spesa ti serve una chiave gratuita di Google Gemini.
</div>
<div style={{background:dark?â€œrgba(0,122,255,0.15)â€:â€œrgba(0,122,255,0.08)â€,borderRadius:â€œ12pxâ€,padding:â€œ12pxâ€,marginBottom:â€œ14pxâ€}}>
<div style={{fontSize:â€œ13pxâ€,fontWeight:â€œ600â€,color:â€#007AFFâ€,marginBottom:â€œ6pxâ€}}>Come ottenerla (2 min):</div>
<div style={{fontSize:â€œ13pxâ€,color:txt,lineHeight:1.7}}>
1. Vai su <span style={{fontWeight:â€œ600â€}}>aistudio.google.com</span>{â€\nâ€}
2. Accedi con Google{â€\nâ€}
3. Clicca <span style={{fontWeight:â€œ600â€}}>â€œGet API Keyâ€</span> â†’ <span style={{fontWeight:â€œ600â€}}>â€œCreate API keyâ€</span>{â€\nâ€}
4. Copia la chiave e incollala qui sotto
</div>
</div>
<input
value={key}
onChange={e=>setKey(e.target.value)}
placeholder=â€œAIzaSyâ€¦â€
style={{width:â€œ100%â€,padding:â€œ12px 14pxâ€,border:`1.5px solid ${err?"#FF3B30":dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.15)"}`,borderRadius:â€œ12pxâ€,fontSize:â€œ14pxâ€,fontFamily:â€œmonospaceâ€,color:txt,background:dark?â€œrgba(255,255,255,0.05)â€:â€#fffâ€,outline:â€œnoneâ€,display:â€œblockâ€,userSelect:â€œtextâ€}}
/>
{err&&<div style={{fontSize:â€œ12pxâ€,color:â€#FF3B30â€,marginTop:â€œ8pxâ€}}>{err}</div>}
</div>
<button onClick={test} disabled={!key.trim()||testing} style={{width:â€œ100%â€,padding:â€œ14pxâ€,borderRadius:â€œ14pxâ€,border:â€œnoneâ€,background:key.trim()?â€#007AFFâ€:â€œrgba(60,60,67,0.1)â€,color:key.trim()?â€#fffâ€:â€œrgba(60,60,67,0.3)â€,fontFamily:â€œinheritâ€,fontSize:â€œ15pxâ€,fontWeight:â€œ600â€,cursor:key.trim()?â€œpointerâ€:â€œdefaultâ€,marginBottom:â€œ8pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œcenterâ€,gap:â€œ8pxâ€}}>
{testing?<><span className="pulse">â³</span>Verifico la chiaveâ€¦</>:â€œSalva e continua â†’â€}
</button>
<button onClick={onClose} style={{width:â€œ100%â€,padding:â€œ12pxâ€,borderRadius:â€œ14pxâ€,border:â€œnoneâ€,background:â€œtransparentâ€,color:sub,fontFamily:â€œinheritâ€,fontSize:â€œ14pxâ€,cursor:â€œpointerâ€}}>Annulla</button>
</div>
);
}

// â”€â”€ AI PANEL: ESERCIZI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€

// â”€â”€ DATABASE CONTENUTI PER MATERIA (PDF) â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CONTENUTI_DB = {
matematica: {
icona:â€œğŸ“â€,
sezioni:[
{titolo:â€œAlgebra â€” Equazioniâ€,contenuto:`EQUAZIONI DI PRIMO GRADO
Forma: ax + b = 0  â†’  x = -b/a

Regole fondamentali:
â€¢ Puoi aggiungere/sottrarre lo stesso numero da entrambi i membri
â€¢ Puoi moltiplicare/dividere entrambi i membri per lo stesso numero (â‰ 0)
â€¢ Tutto ciÃ² che passa da un membro cambia segno

Esempio: 3x - 6 = 9
3x = 9 + 6 = 15
x = 15/3 = 5   âœ“ Verifica: 3(5)-6=9 âœ“

EQUAZIONI DI SECONDO GRADO
Forma: axÂ² + bx + c = 0

Formula quadratica: x = (-b Â± âˆš(bÂ²-4ac)) / 2a
Discriminante: Î” = bÂ² - 4ac
â€¢ Î” > 0  â†’  2 soluzioni reali distinte
â€¢ Î” = 0  â†’  1 soluzione reale doppia
â€¢ Î” < 0  â†’  nessuna soluzione reale

Esempio: xÂ² - 5x + 6 = 0
Î” = 25 - 24 = 1  â†’  x = (5Â±1)/2  â†’  xâ‚=3, xâ‚‚=2`}, {titolo:"Geometria â€” Formule Area e Perimetro",contenuto:`FIGURE PIANE
Quadrato:    P = 4l       A = lÂ²
Rettangolo:  P = 2(b+h)   A = bÃ—h
Triangolo:   P = a+b+c    A = (bÃ—h)/2
Cerchio:     C = 2Ï€r      A = Ï€rÂ²    (Ï€ â‰ˆ 3.14159)
Trapezio:    P = a+b+c+d  A = ((B+b)Ã—h)/2
Rombo:       P = 4l       A = (dâ‚Ã—dâ‚‚)/2
Poligono reg.:P = nÃ—l     A = (PÃ—a)/2 (a=apotema)

TEOREMA DI PITAGORA
In un triangolo rettangolo: aÂ² + bÂ² = cÂ²
dove c Ã¨ lâ€™ipotenusa (il lato piÃ¹ lungo)

Esempio: cateti 3 e 4  â†’  c = âˆš(9+16) = âˆš25 = 5`}, {titolo:"Funzioni e Grafici",contenuto:`FUNZIONE LINEARE: y = mx + q
â€¢ m = pendenza (coefficiente angolare)
â€¢ q = intercetta (dove taglia lâ€™asse y)
â€¢ Se m>0: crescente | Se m<0: decrescente

FUNZIONE QUADRATICA: y = axÂ² + bx + c
â€¢ Parabola con vertice in V = (-b/2a, f(-b/2a))
â€¢ Se a>0: parabola aperta verso lâ€™alto (min)
â€¢ Se a<0: parabola aperta verso il basso (max)

FUNZIONI GONIOMETRICHE
â€¢ sinÂ²x + cosÂ²x = 1
â€¢ sin(x)/cos(x) = tan(x)
Valori notevoli:
0Â°: sin=0, cos=1
30Â°: sin=1/2, cos=âˆš3/2
45Â°: sin=cos=âˆš2/2
60Â°: sin=âˆš3/2, cos=1/2
90Â°: sin=1, cos=0`}, {titolo:"ProbabilitÃ  e Statistica",contenuto:`PROBABILITÃ€
P(A) = casi favorevoli / casi totali
â€¢ 0 â‰¤ P(A) â‰¤ 1
â€¢ P(A) + P(Ä€) = 1 (evento complementare)
â€¢ P(AâˆªB) = P(A) + P(B) - P(Aâˆ©B)
â€¢ Se A e B indipendenti: P(Aâˆ©B) = P(A)Ã—P(B)

STATISTICA
Media aritmetica: xÌ„ = (xâ‚+xâ‚‚+â€¦+xâ‚™)/n
Moda: valore che appare piÃ¹ spesso
Mediana: valore centrale dopo ordinamento

COMBINATORIA
Permutazioni: P(n) = n!
Combinazioni: C(n,k) = n! / (k! Ã— (n-k)!)
Esempio: C(5,2) = 5!/(2!Ã—3!) = 10`} ] }, chimica: { icona:"âš—ï¸", sezioni:[ {titolo:"Tavola Periodica e Atomo",contenuto:`STRUTTURA DELLâ€™ATOMO
â€¢ Protoni (pâº): carica positiva â€” nel nucleo
â€¢ Neutroni (nâ°): carica nulla â€” nel nucleo
â€¢ Elettroni (eâ»): carica negativa â€” negli orbitali

Numero atomico (Z) = numero di protoni
Numero di massa (A) = protoni + neutroni
Isotopi = stesso Z, diverso A

TAVOLA PERIODICA
Organizzata per Z crescente
Periodi (righe): 1â†’7  â€” indica i livelli energetici
Gruppi (colonne): 1â†’18 â€” indica valenza

Metalli (sinistra): conducono, lucidi, malleabili
Non metalli (destra): isolanti, fragili
Metalloidi (diagonale): proprietÃ  intermedie

Elementi fondamentali da ricordare:
H(1), He(2), Li(3), C(6), N(7), O(8),
Na(11), Mg(12), Al(13), Si(14), P(15),
S(16), Cl(17), Ar(18), K(19), Ca(20), Fe(26), Cu(29), Zn(30), Ag(47), Au(79)`}, {titolo:"Legami Chimici",contenuto:`LEGAME IONICO
Tra metallo e non metallo
Trasferimento completo di elettroni
Esempio: Naâº + Clâ» â†’ NaCl (sale da cucina)

LEGAME COVALENTE
Tra non metalli â€” condivisione di elettroni
Polare: elettroni condivisi in modo asimmetrico (Hâ‚‚O)
Apolare: condivisione simmetrica (Hâ‚‚, Oâ‚‚, Nâ‚‚)

LEGAME METALLICO
Tra metalli â€” â€œmare di elettroniâ€
Spiega conducibilitÃ  elettrica e termica

FORZE INTERMOLECOLARI
â€¢ Legami idrogeno (i piÃ¹ forti): N-H, O-H, F-H
â€¢ Forze di Van der Waals (deboli): tra molecole apolari
â€¢ Spiegano punti di ebollizione e fusione`}, {titolo:"Reazioni Chimiche e Stechiometria",contenuto:`BILANCIAMENTO
Legge di conservazione della massa: la massa totale non cambia
Regola: usa i coefficienti (NON i pedici)

Esempio: Hâ‚‚ + Oâ‚‚ â†’ Hâ‚‚O
Bilanciata: 2Hâ‚‚ + Oâ‚‚ â†’ 2Hâ‚‚O

Tipi di reazione:
â€¢ Sintesi: A + B â†’ AB
â€¢ Decomposizione: AB â†’ A + B
â€¢ Scambio semplice: A + BC â†’ AC + B
â€¢ Scambio doppio: AB + CD â†’ AD + CB
â€¢ Ossidoriduzione: cambiano stati di ossidazione

MOLE E STECHIOMETRIA
1 mole = 6.022Ã—10Â²Â³ particelle (N. di Avogadro)
n (mol) = massa (g) / massa molare (g/mol)
Massa molare = somma masse atomiche

Esempio: Hâ‚‚O â†’ M = 2(1) + 16 = 18 g/mol
In 36g di Hâ‚‚O: n = 36/18 = 2 moli`}, {titolo:"Acidi, Basi e pH",contenuto:`ACIDI
Rilasciano Hâº in soluzione acquosa (teoria Arrhenius)
pH < 7
Esempi: HCl (acido cloridrico), Hâ‚‚SOâ‚„ (solforico), CHâ‚ƒCOOH (acetico)

BASI
Rilasciano OHâ» in soluzione acquosa
pH > 7
Esempi: NaOH (soda caustica), Ca(OH)â‚‚ (calce)

pH
pH = -log[Hâº]
â€¢ pH < 7: soluzione acida
â€¢ pH = 7: soluzione neutra (acqua pura)
â€¢ pH > 7: soluzione basica

Scala da 0 (acido forte) a 14 (base forte)
Ogni unitÃ  = 10 volte piÃ¹ acido/basico

NEUTRALIZZAZIONE
Acido + Base â†’ Sale + Acqua
HCl + NaOH â†’ NaCl + Hâ‚‚O`} ] }, fisica: { icona:"âš¡", sezioni:[ {titolo:"Cinematica â€” Moto e VelocitÃ ",contenuto:`GRANDEZZE FONDAMENTALI
Spazio: s [m]    Tempo: t [s]    VelocitÃ : v [m/s]    Accelerazione: a [m/sÂ²]

MOTO RETTILINEO UNIFORME (MRU)
v = costante, a = 0
Spazio: s = v Ã— t
Grafico s-t: retta | Grafico v-t: retta orizzontale

MOTO RETTILINEO UNIFORMEMENTE ACCELERATO (MRUA)
v = vâ‚€ + aÃ—t
s = vâ‚€t + Â½atÂ²
vÂ² = vâ‚€Â² + 2as
Grafico v-t: retta obliqua | Grafico s-t: parabola

CADUTA LIBERA (caso speciale MRUA con a=g)
g â‰ˆ 9.8 m/sÂ² (verso il basso)
v = gÃ—t    |    h = Â½gtÂ²    |    vÂ² = 2gh

Conversioni utili:
1 km/h = 1/3.6 m/s
72 km/h = 20 m/s`}, {titolo:"Dinamica â€” Forze e Leggi di Newton",contenuto:`1Â° LEGGE (INERZIA)
Un corpo rimane in quiete o in moto rettilineo uniforme
se la forza risultante Ã¨ zero.

2Â° LEGGE (FONDAMENTALE)
F = m Ã— a
F [N = kgÃ—m/sÂ²]    m [kg]    a [m/sÂ²]
Se F raddoppia â†’ a raddoppia
Se m raddoppia â†’ a dimezza

3Â° LEGGE (AZIONE-REAZIONE)
Ad ogni azione corrisponde una reazione uguale e contraria.

FORZE IMPORTANTI
Peso: P = mÃ—g  (verso il basso)
Forza normale: N = P (su piano orizzontale)
Attrito statico: fs â‰¤ Î¼sÃ—N
Attrito dinamico: fd = Î¼dÃ—N
Forza elastica (Hooke): F = -kÃ—x

LAVORO ED ENERGIA
Lavoro: L = FÃ—sÃ—cos(Î¸)  [J = NÃ—m]
Energia cinetica: Ec = Â½mvÂ²
Energia potenziale: Ep = mgh
Conservazione energia: Ec + Ep = costante`}, {titolo:"ElettricitÃ  â€” Corrente e Circuiti",contenuto:`GRANDEZZE ELETTRICHE
Tensione V [Volt]    Corrente I [Ampere]    Resistenza R [Ohm]

LEGGE DI OHM
V = R Ã— I     â†’     I = V/R     â†’     R = V/I

RESISTENZE IN SERIE
Rtot = Râ‚ + Râ‚‚ + Râ‚ƒ + â€¦
Stessa corrente in tutto il circuito
Tensioni si sommano: Vtot = Vâ‚ + Vâ‚‚ + â€¦

RESISTENZE IN PARALLELO
1/Rtot = 1/Râ‚ + 1/Râ‚‚ + â€¦
(2 resistenze uguali R â†’ Rtot = R/2)
Stessa tensione ai capi
Correnti si sommano: Itot = Iâ‚ + Iâ‚‚ + â€¦

POTENZA ED ENERGIA
Potenza: P = VÃ—I = IÂ²Ã—R = VÂ²/R  [Watt]
Energia: E = PÃ—t  [Joule] o [kWh]
1 kWh = 3.600.000 J

CAMPO ELETTRICO
F = kÃ—qâ‚Ã—qâ‚‚/rÂ²  (Legge di Coulomb)
k = 9Ã—10â¹ NÃ—mÂ²/CÂ²`}, {titolo:"Termodinamica e Ottica",contenuto:`TEMPERATURA E CALORE
Temperatura: misura energia cinetica media
Calore: Q = mÃ—cÃ—Î”T  (c = calore specifico)

Conversioni: T[K] = T[Â°C] + 273
Calore specifico acqua: c = 4186 J/(kgÃ—K)

1Â° PRINCIPIO TERMODINAMICA
Î”U = Q - L
(variazione energia interna = calore assorbito - lavoro compiuto)

2Â° PRINCIPIO
Il calore non puÃ² passare spontaneamente dal corpo freddo al caldo

OTTICA
Riflessione: angolo incidenza = angolo riflessione
Rifrazione: nâ‚Ã—sin(Î¸â‚) = nâ‚‚Ã—sin(Î¸â‚‚)
Indice di rifrazione: n = c/v (c = 3Ã—10â¸ m/s)
Lenti convergenti (convesse): f > 0
Lenti divergenti (concave): f < 0
Formula lenti: 1/f = 1/p + 1/q`} ] }, storia: { icona:"ğŸ›ï¸", sezioni:[ {titolo:"Evo Antico e Medioevo",contenuto:`CIVILTÃ€ ANTICHE
Mesopotamia (3500 a.C.): prima scrittura (cuneiforme), Sumeri, Babilonesi, Hammurabi
Egitto: faraoni, geroglifici, piramidi (2560 a.C. Cheope)
Grecia: democrazia ateniese (Pericle 461 a.C.), filosofia (Socrate, Platone, Aristotele), Alessandro Magno (336 a.C.)
Roma: Repubblica (509 a.C.) â†’ Impero (27 a.C. Augusto) â†’ Caduta Occidente (476 d.C.)

MEDIOEVO (476-1492)
Alto Medioevo: feudalesimo, Carlo Magno (800), invasioni normanne
Basso Medioevo: Crociate (1096-1291), Comuni italiani, Magna Carta (1215)
Fine Medioevo: Peste Nera (1348), Scisma dâ€™Occidente, Umanesimo
Date chiave:
â€¢ 476: Caduta Roma Occidentale (inizio Medioevo)
â€¢ 800: Incoronazione Carlo Magno
â€¢ 1066: Conquista normanna dellâ€™Inghilterra
â€¢ 1215: Magna Carta
â€¢ 1453: Caduta Costantinopoli (fine Medioevo)`}, {titolo:"EtÃ  Moderna â€” Rinascimento e Rivoluzioni",contenuto:`RINASCIMENTO (XIV-XVI sec.)
Firenze: Medici come mecenati
Arte: Leonardo da Vinci, Michelangelo, Raffaello
Scienza: Copernico (sistema eliocentrico, 1543), Galileo
1492: Colombo scopre lâ€™America
1517: Riforma protestante (Lutero, 95 tesi)

RIVOLUZIONI DEL XVIII SEC.
Rivoluzione Americana (1776): Dichiarazione dâ€™Indipendenza
Rivoluzione Francese (1789-1799):
â€¢ Cause: disuguaglianza, crisi finanziaria, illuminismo
â€¢ Fasi: Assemblea Nazionale, Terrore (Robespierre), Direttorio
â€¢ 1789: presa della Bastiglia, Dichiarazione dei Diritti

NAPOLEONE (1799-1815)
Primo Console â†’ Imperatore (1804)
Codice Napoleonico | Campagne in Europa
Sconfitta a Waterloo (1815), esilio a Santâ€™Elena

RIVOLUZIONE INDUSTRIALE (XVIII-XIX)
Inghilterra â†’ poi Europa
Macchina a vapore (Watt, 1769), fabbriche, proletariato
Conseguenze: urbanizzazione, capitalismo, movimenti operai`}, {titolo:"XIX Secolo â€” Nazioni e Risorgimento",contenuto:`RISORGIMENTO ITALIANO (1815-1861)
Mazzini: Giovine Italia, ideali repubblicani
Cavour: Piemonte come guida, diplomazia, alleanza con Francia
Garibaldi: Spedizione dei Mille (1860), conquista Sud
1861: UnitÃ  dâ€™Italia, Vittorio Emanuele II primo re
1866: Venezia annessa | 1870: Roma capitale

UNIFICAZIONE TEDESCA
Bismarck (Prussia): â€œferro e sangueâ€
Guerre contro Danimarca (1864), Austria (1866), Francia (1870)
1871: Proclamazione Impero Tedesco (Secondo Reich)

IMPERIALISMO (fine XIX)
Europa colonizza Africa e Asia
Spartizione dellâ€™Africa (Conferenza di Berlino, 1884)
Contraddizioni che porteranno alla WWI`}, {titolo:"XX Secolo â€” Guerre Mondiali e Dopoguerra",contenuto:`PRIMA GUERRA MONDIALE (1914-1918)
Cause: nazionalismo, imperialismo, alleanze, assassinio Francesco Ferdinando (28 giugno 1914)
Schieramenti: Intesa (Francia, UK, Russia, poi USA) vs Triplice Alleanza (Germania, Austria, Italia*)
*Italia entra con Intesa nel 1915 (Patto di Londra)
1917: Rivoluzione russa, USA entrano in guerra
1918: Armistizio | Trattato di Versailles (1919): pesa sulla Germania

TOTALITARISMI (anni â€™20-â€™30)
Fascismo in Italia: Mussolini, marcia su Roma (1922)
Nazismo in Germania: Hitler cancelliere (1933), Kristallnacht (1938)
Stalinismo in URSS: collettivizzazione, purghe

SECONDA GUERRA MONDIALE (1939-1945)
1939: invasione Polonia â†’ UK e Francia dichiarano guerra
1940: caduta Francia, Battaglia dâ€™Inghilterra
1941: Operazione Barbarossa (URSS), Pearl Harbor (USA)
1943: caduta Mussolini, armistizio italiano
1944: sbarco in Normandia (6 giugno)
1945: maggio: resa Germania | agosto: bombe atomiche Giappone
Olocausto: 6 milioni di ebrei sterminati

GUERRA FREDDA (1947-1991)
USA (NATO) vs URSS (Patto di Varsavia)
Blocco di Berlino (1948), Guerra di Corea (1950-53)
Crisi dei missili cubani (1962), Vietnam (1955-75)
1989: caduta Muro di Berlino | 1991: dissoluzione URSS`} ] }, scienze: { icona:"ğŸ”¬", sezioni:[ {titolo:"La Cellula",contenuto:`CELLULA PROCARIOTA (batteri)
â€¢ Nessun nucleo membranoso
â€¢ DNA circolare nel citoplasma
â€¢ Dimensioni: 1-10 Î¼m
â€¢ Esempio: Escherichia coli

CELLULA EUCARIOTA (animali, piante, funghi)
â€¢ Nucleo con membrana nucleare
â€¢ Organuli specializzati
â€¢ Dimensioni: 10-100 Î¼m

ORGANULI PRINCIPALI
Nucleo: contiene DNA, controlla la cellula
Membrana cellulare: regola scambi (permeabilitÃ  selettiva)
Mitocondri: produzione energia (ATP) â€” â€œcentrale energeticaâ€
Ribosomi: sintesi proteica
Reticolo endoplasmatico: trasporto sostanze
Apparato di Golgi: elabora e spedisce proteine
Lisosomi: digestione cellulare (solo animali)
Vacuolo centrale: accumulo acqua (solo piante, grande)
Cloroplasti: fotosintesi (solo piante, verdi per clorofilla)
Parete cellulare: struttura rigida (solo piante, fungi, batteri)`}, {titolo:"Fotosintesi e Respirazione",contenuto:`FOTOSINTESI CLOROFILLIANA
6COâ‚‚ + 6Hâ‚‚O + energia luminosa â†’ Câ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚
Avviene nei cloroplasti
Fase luminosa: cattura luce, produce ATP e NADPH
Ciclo di Calvin: usa ATP, fissa COâ‚‚ in glucosio

RESPIRAZIONE CELLULARE AEROBICA
Câ‚†Hâ‚â‚‚Oâ‚† + 6Oâ‚‚ â†’ 6COâ‚‚ + 6Hâ‚‚O + 38 ATP
Avviene nei mitocondri
Glicolisi (citoplasma) â†’ Ciclo di Krebs â†’ Fosforilazione ossidativa
Resa: 38 molecole di ATP per molecola di glucosio

CONFRONTO
Fotosintesi: usa COâ‚‚, produce Oâ‚‚ e glucosio (piante, alghe, diurna)
Respirazione: usa Oâ‚‚ e glucosio, produce COâ‚‚ (tutti gli organismi, continua)
Le due reazioni si â€œbilancianoâ€ nel ciclo del carbonio`}, {titolo:"Genetica â€” DNA e Mendel",contenuto:`DNA
Doppia elica di nucleotidi (adenina-timina, guanina-citosina)
Gene = sequenza di DNA che codifica una proteina
Cromosoma = DNA compattato con proteine (istoni)
Uomo: 46 cromosomi (23 coppie), di cui 2 sessuali (XX femmina, XY maschio)

REPLICAZIONE â†’ TRASCRIZIONE â†’ TRADUZIONE
DNA si replica (copia identica) prima della divisione
DNA â†’ RNA messaggero (trascrizione nel nucleo)
RNA â†’ Proteina (traduzione nei ribosomi)

MENDEL â€” LEGGI DELLâ€™EREDITARIETÃ€
1Âª Legge (Dominanza): in F1 si esprime solo il carattere dominante
2Âª Legge (Segregazione): in F2 rapporto 3 dominante : 1 recessivo
3Âª Legge (Assortimento indipendente): geni su cromosomi diversi si trasmettono indipendentemente

Aa (eterozigote dominante)
AA (omozigote dominante)
aa (omozigote recessivo â€” esprime carattere recessivo)

Esempio piselli: G (giallo, dominante) g (verde, recessivo)
P: GG Ã— gg  â†’  F1: tutti Gg (giallo)
F1Ã—F1: GgÃ—Gg  â†’  F2: GG, Gg, Gg, gg (3 giallo : 1 verde)`}, {titolo:"Evoluzione ed Ecosistemi",contenuto:`TEORIA DELLâ€™EVOLUZIONE (Darwin, 1859)
Selezione naturale: sopravvivono gli individui piÃ¹ adatti allâ€™ambiente
VariabilitÃ : individui della stessa specie sono diversi
EreditarietÃ : caratteri si trasmettono ai figli
Tempo: milioni di anni per formare nuove specie

PROVE DELLâ€™EVOLUZIONE
Fossili | Omologie anatomiche | DNA | Biogeografia | Embriologia comparata

ECOSISTEMA
Bioma: grande area con clima e organismi caratteristici
ComunitÃ : tutte le specie in unâ€™area
Popolazione: individui della stessa specie
Catena alimentare: Produttori â†’ Consumatori â†’ Decompositori
Produttori: piante (fotosintesi)
Consumatori I: erbivori | Consumatori II: carnivori
Decompositori: batteri e funghi

CICLI BIOGEOCHIMICI
Ciclo del carbonio: fotosintesi â†” respirazione â†” decomposizione
Ciclo dellâ€™acqua: evaporazione â†’ precipitazione â†’ ruscellamento
Ciclo dellâ€™azoto: fissazione batterica â†’ nitrificazione â†’ denitrificazione`} ] }, inglese: { icona:"ğŸ‡¬ğŸ‡§", sezioni:[ {titolo:"Tempi Verbali â€” Schema Completo",contenuto:`PRESENT SIMPLE: azione abituale/veritÃ 
(+) I work  He works  (-) I donâ€™t  He doesnâ€™t  (?) Do I? Does he?
Avverbi: always, usually, often, sometimes, never

PRESENT CONTINUOUS: azione in corso ora
(+) I am working  He is working  (-) Iâ€™m not working  (?) Are you working?
Avverbi: now, at the moment, currently

PAST SIMPLE: azione completata nel passato
Verbi regolari: +ed (worked, played, walked)
Verbi irregolari: goâ†’went, eatâ†’ate, haveâ†’had, seeâ†’saw, makeâ†’made
Avverbi: yesterday, last year, ago, in 2010

PRESENT PERFECT: azione passata con legame al presente
(+) I have worked  He has worked  (-) I havenâ€™t  He hasnâ€™t  (?) Have you?
Avverbi: just, already, yet, ever, never, since, for

PAST CONTINUOUS: azione in corso in un momento passato
(+) I was working  (-) I wasnâ€™t working  (?) Were you working?
Uso: â€œWhile I was studying, he calledâ€

FUTURE: WILL vs GOING TO
Will: decisione spontanea, previsione senza prove
Going to: piano giÃ  deciso, previsione con prove
â€œI will help you!â€ | â€œIâ€™m going to travel next summer (Iâ€™ve bought the ticket)â€

CONDITIONALS
Zero: If + present, present  â†’ veritÃ  generale
First: If + present, will  â†’ condizione reale futura
Second: If + past, would  â†’ condizione irreale presente
Third: If + past perfect, would have  â†’ condizione irreale passata`}, {titolo:"Grammatica â€” Regole Essenziali",contenuto:`PASSIVE VOICE
Presente: am/is/are + past participle
Passato: was/were + past participle
â€œThe book is read by studentsâ€ | â€œThe letter was written by herâ€

REPORTED SPEECH
Presentiâ†’Passati: isâ†’was, areâ†’were, willâ†’would, canâ†’could
â€œI am happyâ€ â†’ He said he was happy
â€œI will comeâ€ â†’ She said she would come
Parole di tempo: nowâ†’then, todayâ†’that day, tomorrowâ†’the next day

GERUND vs INFINITIVE
Gerund (-ing): after prepositions, as subject, enjoy/like/hate/avoid/suggest
Infinitive (to+verb): want/need/decide/hope/plan/promise/seem

RELATIVE CLAUSES
Who: per persone  Which: per cose  That: persone o cose
Where: luoghi  Whose: possesso  When: tempo
Defining: â€œThe man who called is my brotherâ€
Non-defining (virgole): â€œMy brother, who lives in Rome, calledâ€

QUESTION TAGS
Positive statement â†’ negative tag: â€œYou like pizza, donâ€™t you?â€
Negative statement â†’ positive tag: â€œShe isnâ€™t coming, is she?â€`}, {titolo:"Vocabolario â€” False Friends e Phrasal Verbs",contenuto:`FALSE FRIENDS (parole ingannevoli)
actually = in realtÃ  (NON attualmente = currently)
eventually = alla fine (NON eventualmente = possibly)
sensible = sensato (NON sensibile = sensitive)
library = biblioteca (NON libreria = bookshop)
factory = fabbrica (NON fattoria = farm)
sympathetic = comprensivo (NON simpatico = nice/friendly)
argument = discussione/litigio (NON argomento = topic/subject)
pretend = fingere (NON pretendere = demand/expect)

PHRASAL VERBS COMUNI
give up = arrendersi, smettere
take off = decollare, togliersi (vestiti)
look up = cercare (dizionario), guardare in su
put off = rimandare, procrastinare
turn on/off = accendere/spegnere
run out of = esaurire
find out = scoprire
bring up = crescere (un figlio), sollevare (argomento)
get on = andare dâ€™accordo, salire (mezzo)
carry on = continuare
come across = imbattersi in
go through = attraversare, esaminare

CONNETTIVI ESSENZIALI
Aggiunta: furthermore, moreover, in addition, besides
Contrasto: however, nevertheless, on the other hand, although
Causa: because, since, as, due to, owing to
Risultato: therefore, thus, consequently, as a result
Esempio: for instance, for example, such as`} ] }, filosofia: { icona:"ğŸ¤”", sezioni:[ {titolo:"Filosofia Antica â€” Da Talete a Platone",contenuto:`PRE-SOCRATICI (VII-V sec. a.C.)
Problema: qual Ã¨ il principio (archÃ¨) di tutto?
Talete: acqua | Anassimene: aria | Eraclito: fuoco (e logos)
Eraclito: â€œpanta reiâ€ (tutto scorre), dialettica degli opposti
Parmenide: lâ€™Essere Ã¨ immobile, immutabile (opposto a Eraclito)
Pitagora: i numeri come principio di tutto

SOCRATE (470-399 a.C.)
Metodo maieutico: fare domande per far emergere la veritÃ 
â€œSo di non sapereâ€ â€” ironia socratica
â€œConosci te stessoâ€ â€” ricerca interiore
Condannato a morte per empietÃ  e corruzione dei giovani

PLATONE (428-348 a.C.)
Teoria delle Idee: il mondo sensibile Ã¨ copia del mondo delle Idee (iperurania)
Anima: immortale, caduta nel corpo, ricorda le Idee (reminiscenza)
Stato ideale: filosofi-re, guerrieri, produttori
Mito della caverna: gli uomini vedono solo ombre della realtÃ 
Opere: Repubblica, Fedone, Simposio, Timeo`}, {titolo:"Aristotele e Filosofia Ellenistica",contenuto:`ARISTOTELE (384-322 a.C.)
Critica a Platone: le Idee sono NELLA cosa, non separate
Logica: sillogismo (â€œTutti gli uomini sono mortali; Socrate Ã¨ uomo; ergo Socrate Ã¨ mortaleâ€)
Metafisica: sostanza, forma e materia, atto e potenza
Etica: virtÃ¹ come â€œgiusto mezzoâ€ tra eccesso e difetto
Politica: lâ€™uomo Ã¨ â€œanimale politicoâ€; migliore governo = repubblica
Opere: Organon, Metafisica, Etica Nicomachea, Politica, Poetica

FILOSOFIA ELLENISTICA (IV-I sec. a.C.)
Epicureismo (Epicuro): il fine Ã¨ la felicitÃ  = assenza di dolore (atarassia)
â€œCarpe diemâ€ â€” godere il momento, filosofia del giardino
Stoicismo (Zenone): virtÃ¹ come unico bene; accettare ciÃ² che non dipende da noi
Logos cosmico â€” tutto Ã¨ razionale e necessario
Scetticismo (Pirrone): sospensione del giudizio = pace interiore
Neoplatonismo (Plotino): lâ€™Uno come principio, emanazione`}, {titolo:"Filosofia Moderna â€” Cartesio, Kant, Hegel",contenuto:`CARTESIO (1596-1650) â€” RAZIONALISMO
Dubbio metodico: mette in dubbio tutto per trovare una certezza
â€œCogito ergo sumâ€ = â€œPenso dunque sonoâ€ (prima certezza indubitabile)
Dualismo: res cogitans (mente) e res extensa (corpo) â€” problema mente-corpo
Metodo deduttivo: dalla ragione si ricavano veritÃ  certe

EMPIRISMO
Locke: la mente Ã¨ tabula rasa, tutta la conoscenza viene dallâ€™esperienza
Hume: critica alla causalitÃ , scetticismo sul sÃ© e sul mondo esterno

KANT (1724-1804) â€” CRITICISMO
Critica della Ragion Pura: come Ã¨ possibile la conoscenza?
Fenomeno (cosa come appare) vs Noumeno (cosa in sÃ©, inconoscibile)
Spazio e tempo: forme a priori dellâ€™intuizione
Critica della Ragion Pratica: etica
Imperativo categorico: â€œAgisci solo secondo quella massima che puoi volere sia legge universaleâ€
Critica del Giudizio: bello e sublime, teleologia della natura

HEGEL (1770-1831) â€” IDEALISMO ASSOLUTO
Dialettica: Tesi â†’ Antitesi â†’ Sintesi (Aufhebung)
Lo Spirito si realizza nella storia attraverso contraddizioni
Spirito soggettivo â†’ oggettivo (diritto, moralitÃ , eticitÃ ) â†’ assoluto (arte, religione, filosofia)
â€œCiÃ² che Ã¨ razionale Ã¨ reale, ciÃ² che Ã¨ reale Ã¨ razionaleâ€`}, {titolo:"Filosofia Contemporanea â€” Nietzsche, Marx, Esistenzialismo",contenuto:`MARX (1818-1883)
Materialismo storico: la storia Ã¨ guidata dalle condizioni materiali (economiche)
Struttura (economia) determina la sovrastruttura (politica, cultura, religione)
Lotta di classe: borghesia vs proletariato
â€œLa religione Ã¨ lâ€™oppio dei popoliâ€
Comunismo: abolizione proprietÃ  privata, societÃ  senza classi
Opere: Manifesto del Partito Comunista (1848), Il Capitale

NIETZSCHE (1844-1900)
Morte di Dio: il nichilismo moderno, crollo dei valori tradizionali
Oltreuomo (Ãœbermensch): chi crea nuovi valori al di lÃ  del bene e del male
VolontÃ  di potenza: istinto creativo, non sopraffazione
Eterno ritorno: tutto si ripete infinitamente â€” accettarlo con amor fati
Critica alla morale: morale del padrone vs morale del gregge
Opere: CosÃ¬ parlÃ² Zarathustra, Al di lÃ  del bene e del male

ESISTENZIALISMO (XX sec.)
Kierkegaard: padre dellâ€™es. â€” tre stadi: estetico, etico, religioso
Sartre: â€œLâ€™esistenza precede lâ€™essenzaâ€ â€” libertÃ  totale e angoscia
â€œLâ€™uomo Ã¨ condannato ad essere liberoâ€
Heidegger: Essere-nel-mondo, autenticitÃ  vs inautenticitÃ , essere-per-la-morte
Camus: assurdo della vita, rivolta come risposta`} ] }, italiano: { icona:"ğŸ“–", sezioni:[ {titolo:"Grammatica â€” Analisi del Testo",contenuto:`PARTI DEL DISCORSO
Sostantivo: nome di persone, cose, idee (comune/proprio, concreto/astratto)
Articolo: determinativo (il/la/lo/i/le/gli) | indeterminativo (un/uno/una)
Aggettivo: qualificativo, possessivo, dimostrativo, indefinito, numerale, interrogativo
Pronome: personale, relativo (che/cui/il quale), dimostrativo, indefinito
Verbo: modi finiti (indicativo/congiuntivo/condizionale/imperativo) e infiniti (infinito/participio/gerundio)
Avverbio: di modo, tempo, luogo, quantitÃ , affermazione, negazione
Preposizione: semplici (di, a, da, in, con, su, per, tra, fra) e articolate
Congiunzione: coordinanti (e, ma, perÃ², quindi, oppure) e subordinanti (che, perchÃ©, quando, se, sebbene)

ANALISI LOGICA
Soggetto: di chi si parla
Predicato verbale: cosa fa il soggetto
Predicato nominale: essere + nome/aggettivo
Complemento oggetto: risponde a â€œchi?â€ â€œche cosa?â€
Complemento di specificazione: â€œdiâ€ + nome
Complemento di termine: â€œaâ€ + nome (risponde a â€œa chi?â€)
Complemento dâ€™agente: â€œdaâ€ + persona (con passivo)
Complemento di luogo: stato in luogo, moto a/da/per luogo
Apposizione: nome che affianca un altro nome`}, {titolo:"Letteratura Italiana â€” Dalle Origini all'Ottocento",contenuto:`ORIGINI (X-XIII sec.)
Francesco dâ€™Assisi: Cantico delle Creature (1224) â€” prima lirica in volgare
Scuola Siciliana (Federico II): prima poesia dâ€™amore in italiano
Dolce Stilnovo: Guinizzelli, Cavalcanti â€” amore spiritualizzato, donna angelicata

TRECENTO (XIV sec.)
Dante Alighieri (1265-1321): Divina Commedia (100 canti: 34 Inferno, 33 Purgatorio, 33 Paradiso), Vita Nova, De Monarchia
Francesco Petrarca (1304-1374): Canzoniere (366 componimenti, amore per Laura), fondatore dellâ€™umanesimo
Giovanni Boccaccio (1313-1375): Decameron (100 novelle, 10 giorni, 10 narratori)

QUATTROCENTO-CINQUECENTO
Umanesimo e Rinascimento: ritorno ai classici, fiducia nellâ€™uomo
Ariosto: Orlando Furioso (poema cavalleresco)
Machiavelli: Il Principe (realismo politico, â€œil fine giustifica i mezziâ€)
Tasso: Gerusalemme Liberata (poema epico religioso)

SEICENTO-SETTECENTO
Barocco: stile ornato, metafore ardite (Marino â€” â€œmeravigliaâ€)
Illuminismo: Beccaria (Dei delitti e delle pene), Parini, Goldoni
Alfieri: tragedie neoclassiche

OTTOCENTO
Neoclassicismo: Foscolo â€” Sepolcri, Ultime lettere di Jacopo Ortis
Romanticismo: Manzoni â€” Promessi Sposi (1827, poi 1840), Inni Sacri, Adelchi
Leopardi: Zibaldone, Canti (Lâ€™Infinito, A Silvia, La Ginestra), pessimismo cosmico`}, {titolo:"Figure Retoriche e Analisi del Testo",contenuto:`FIGURE RETORICHE PRINCIPALI
Similitudine: paragone esplicito con â€œcomeâ€ â€” â€œEra veloce come il ventoâ€
Metafora: paragone implicito â€” â€œIl vento era un pugnaleâ€
Personificazione: dare qualitÃ  umane a oggetti/animali
Apostrofe: rivolgersi a qualcuno/qualcosa assente
Anafora: ripetizione di parola allâ€™inizio di versi/frasi
Allitterazione: ripetizione di suoni/consonanti â€” â€œSoffi senza sosta, sole scomparsoâ€
Assonanza: ripetizione di suoni vocalici
Iperbole: esagerazione â€” â€œTi ho aspettato unâ€™eternitÃ â€
Ossimoro: unione di termini opposti â€” â€œsilenzio assordanteâ€
Chiasmo: schema incrociato A-B-B-A
Sineddoche: parte per il tutto o viceversa â€” â€œ100 teste di bestiameâ€
Metonimia: sostituzione per vicinanza â€” â€œbere un bicchiereâ€ (vino)
Perifrasi: giro di parole per indicare qualcosa
Eufemismo: attenuare qualcosa di spiacevole

ANALISI DEL TESTO POETICO

1. Parafrasi â€” 2. Struttura metrica (endecasillabo, ottonarioâ€¦)
1. Schema rime (ABAB, ABBA, AABBâ€¦) â€” 4. Figure retoriche
1. Temi e significati â€” 6. Contesto storico-letterario`} ]   },   latino: { icona:"ğŸº", sezioni:[ {titolo:"Morfologia â€” Declinazioni",contenuto:`1Âª DECLINAZIONE (femminile, tema -a)
   Sing.  Plur.
   Nom: -a     -ae
   Gen: -ae    -arum
   Dat: -ae    -is
   Acc: -am    -as
   Abl: -a     -is
   Es: puella (ragazza)

2Âª DECLINAZIONE (maschile -us/-er, neutro -um)
Masc.Sing.  Masc.Plur.  Neut.Sing.  Neut.Plur.
Nom: -us         -i          -um         -a
Gen: -i          -orum       -i          -orum
Dat: -o          -is         -o          -is
Acc: -um         -os         -um         -a
Abl: -o          -is         -o          -is
Es: dominus (padrone), bellum (guerra)

3Âª DECLINAZIONE (vari temi)
Nom: vario  (-or, -o, -x, -s, -ns, -rsâ€¦)
Gen: -is    (la terminazione chiave!)
Es: miles militis (soldato), rex regis (re), corpus corporis

4Âª DECLINAZIONE (tema -u)
Nom Sing: -us | Nom Plur: -us
Gen Sing: -us | Gen Plur: -uum
Dat/Abl Sing: -ui/-u | Dat/Abl Plur: -ibus
Acc Sing: -um | Acc Plur: -us

5Âª DECLINAZIONE (tema -e)
Nom/Acc Sing: -es | Gen Sing: -ei | Dat/Abl Sing: -ei/-e
Nom/Acc Plur: -es | Gen Plur: -erum | Dat/Abl Plur: -ebus
Es: res rei (cosa), dies diei (giorno)`}, {titolo:"Morfologia â€” Coniugazioni Verbali",contenuto:`ESSE (essere) â€” INDICATIVO
Presente: sum, es, est, sumus, estis, sunt
Imperfetto: eram, eras, erat, eramus, eratis, erant
Futuro: ero, eris, erit, erimus, eritis, erunt
Perfetto: fui, fuisti, fuit, fuimus, fuistis, fuerunt

1Âª CONIUGAZIONE (-are): amare
Pres.: amo, amas, amat, amamus, amatis, amant
Imp.: amabam, amabas, amabatâ€¦
Fut.: amabo, amabis, amabitâ€¦
Perf.: amavi, amavisti, amavitâ€¦

2Âª CONIUGAZIONE (-ere): monere
Pres.: moneo, mones, monet, monemus, monetis, monent
Imp.: monebamâ€¦ | Fut.: moneboâ€¦

3Âª CONIUGAZIONE (-ere breve): legere
Pres.: lego, legis, legit, legimus, legitis, legunt

4Âª CONIUGAZIONE (-ire): audire
Pres.: audio, audis, audit, audimus, auditis, audiunt

FORMA PASSIVA: aggiunta di desinenze passive
Pres. 1Âª pers. sing.: -or (amor = sono amato)
Pres. 3Âª pers. sing.: -tur (amatur = Ã¨ amato)
Pres. 3Âª pers. plur.: -ntur (amantur = sono amati)`}, {titolo:"Sintassi â€” Proposizioni e Costruzioni",contenuto:`USO DEI CASI
Nominativo: soggetto e predicato nominale
Genitivo: complemento di specificazione, partitivo
Dativo: complemento di termine, vantaggio/svantaggio
Accusativo: complemento oggetto, moto a luogo, durata
Ablativo: separazione, provenienza, modo, mezzo, agente (con da/ab), ablativo assoluto
Vocativo: allocuzione diretta

ABLATIVO ASSOLUTO
Participio + sostantivo/pronome allâ€™ablativo
Traduzione: â€œdopo cheâ€¦â€, â€œmentreâ€¦â€, â€œpoichÃ©â€¦â€, â€œsebbeneâ€¦â€
Es: â€œSole oriente, milites profecti suntâ€ = â€œAl sorgere del sole, i soldati partironoâ€

PROPOSIZIONE INFINITIVA (cum accusativo)
Dopo verbi di dire, pensare, sentire
Soggetto allâ€™accusativo + verbo allâ€™infinito
Es: â€œDico Marcum venireâ€ = â€œDico che Marco vieneâ€

CUM NARRATIVO
cum + congiuntivo imperfetto/piuccheperfetto
Valore causale o temporale
Es: â€œCum Caesar venisset, hostes fugeruntâ€

CONSECUTIO TEMPORUM
Ind. Presente nel reggente â†’ Cong. Presente (contemporaneo) o Perfetto (anteriore)
Ind. Passato nel reggente â†’ Cong. Imperfetto (contemporaneo) o Piucch. (anteriore)`} ] }, geografia: { icona:"ğŸŒ", sezioni:[ {titolo:"Cartografia e Strumenti",contenuto:`LA CARTA GEOGRAFICA
Rappresentazione in piano della superficie terrestre
Scala: rapporto tra distanza sulla carta e realtÃ 
â€¢ Grande scala (1:10.000): molto dettagliata, area piccola
â€¢ Piccola scala (1:1.000.000): poco dettagliata, area grande

COORDINATE GEOGRAFICHE
Latitudine: distanza angolare dallâ€™Equatore (0Â° a 90Â° N/S)
Longitudine: distanza angolare dal Meridiano di Greenwich (0Â° a 180Â° E/W)

TIPI DI CARTE
Fisica: rilievi (colori: blu=mare, verde=pianure, marrone=monti)
Politica: confini degli Stati
Tematica: un fenomeno specifico (clima, popolazione, economia)
Topografica: scala grande, rilievi con curve di livello

PROIEZIONI CARTOGRAFICHE
Impossibile rappresentare la sfera su un piano senza distorsioni
Mercatore: conforme (angoli giusti), deforma le aree ai poli
Peters: equivalente (aree giuste), deforma le forme
Problema: nessuna proiezione Ã¨ perfetta`}, {titolo:"Clima e Ambienti Naturali",contenuto:`FATTORI DEL CLIMA
Latitudine: piÃ¹ ci si allontana dallâ€™equatore, piÃ¹ freddo
Altitudine: ogni 100m si perde circa 0,6Â°C
Distanza dal mare: il mare mitiga le temperature (clima oceanico vs continentale)
Correnti marine: corrente del Golfo riscalda lâ€™Europa
Venti: portano umiditÃ  o secchezza a seconda dellâ€™origine

ZONE CLIMATICHE
Equatoriale (0Â°-5Â°): caldo e umido tutto lâ€™anno, foresta tropicale
Tropicale (5Â°-23Â°): stagione secca e piovosa, savana
Subtropicale (23Â°-35Â°): deserti caldi (Sahara, Arabia), anticiclone subtropicale
Mediterraneo (30Â°-45Â°): estate secca, inverno piovoso, macchia mediterranea
Temperato oceanico: piogge distribuite, inverni miti (Europa Ovest)
Continentale: estati calde, inverni rigidi, steppe
Subartico/Boreale: taiga (foresta conifera), inverni lunghi
Polare: tundra/calotta glaciale, temperature <0Â°C quasi sempre

BIOMI PRINCIPALI
Foresta pluviale tropicale: massima biodiversitÃ 
Savana: erbosa con alberi sparsi
Deserto: meno di 250mm pioggia/anno
Foresta temperata: latifoglie decidue
Taiga: conifera sempreverde
Tundra: assenza di alberi, permafrost`}, {titolo:"Popolazione e Urbanizzazione",contenuto:`DEMOGRAFIA
Popolazione mondiale: ~8 miliardi (2024)
Tasso di natalitÃ : nati per 1000 abitanti/anno
Tasso di mortalitÃ : morti per 1000 abitanti/anno
Tasso di crescita naturale = natalitÃ  - mortalitÃ 
Tasso di feconditÃ  totale (TFT): figli per donna
Per mantenere popolazione: TFT â‰¥ 2,1

DISTRIBUZIONE DELLA POPOLAZIONE
DensitÃ  = popolazione / superficie (ab/kmÂ²)
Zone densamente popolate: Asia meridionale e orientale, Europa, costa Est USA
Zone poco popolate: Sahara, Siberia, Amazzonia, Australia centrale

TRANSIZIONE DEMOGRAFICA
Fase 1: alta natalitÃ  + alta mortalitÃ  = pop. stabile (paesi preindustriali)
Fase 2: alta natalitÃ  + mortalitÃ  cala = boom demografico
Fase 3: natalitÃ  cala + mortalitÃ  bassa = crescita rallenta
Fase 4: bassa natalitÃ  + bassa mortalitÃ  = pop. stabile o in calo (Europa)

URBANIZZAZIONE
In aumento globale: dal 30% (1950) al 57% (2023)
Megalopoli: cittÃ  >10 milioni (Tokyo 37M, Delhi 32M, Shanghai 29M)
Push factors: povertÃ  rurale, siccitÃ  â†’ Pull factors: lavoro, servizi
Problemi: periferie degradate, inquinamento, traffico, gestione rifiuti`}
]
}
};

// â”€â”€ CLAUDE API â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
const CLAUDE_KEY = â€œ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â€;
async function callClaude(prompt, maxTokens=1500){
const res = await fetch(â€œhttps://api.anthropic.com/v1/messagesâ€,{
method:â€œPOSTâ€,
headers:{
â€œcontent-typeâ€:â€œapplication/jsonâ€,
â€œx-api-keyâ€: CLAUDE_KEY,
â€œanthropic-versionâ€:â€œ2023-06-01â€,
â€œanthropic-dangerous-direct-browser-accessâ€:â€œtrueâ€
},
body:JSON.stringify({
model:â€œclaude-haiku-4-5-20251001â€,
max_tokens: maxTokens,
messages:[{role:â€œuserâ€, content: prompt}]
})
});
if(!res.ok){
const err=await res.json().catch(()=>({}));
throw new Error(err?.error?.message||â€œHTTP â€œ+res.status);
}
const d = await res.json();
return d.content?.[0]?.text || â€œâ€;
}

// Genera HTML del PDF da scaricare nel browser (fallback locale)
function generaHTMLPdf(event) {
const materia = event.materia || â€œaltraâ€;
const argomento = event.argomento || â€œâ€;
const titolo = event.title || â€œStudioâ€;
const db = CONTENUTI_DB[materia];

const mat = MATERIE ? MATERIE.find(m=>m.id===materia) : null;
const matLabel = mat ? mat.label : materia;
const oggi = new Date().toLocaleDateString(â€˜it-ITâ€™, {day:â€˜numericâ€™,month:â€˜longâ€™,year:â€˜numericâ€™});

// Seleziona sezioni rilevanti
let sezioni = [];
if(db) {
if(argomento) {
// Cerca sezione piÃ¹ pertinente
const lower = argomento.toLowerCase();
const match = db.sezioni.filter(s =>
s.titolo.toLowerCase().includes(lower) ||
s.contenuto.toLowerCase().includes(lower)
);
sezioni = match.length > 0 ? match : db.sezioni;
} else {
sezioni = db.sezioni;
}
}

// Se non câ€™Ã¨ DB per questa materia, crea sezione generica
if(sezioni.length === 0) {
sezioni = [{
titolo: argomento || matLabel,
contenuto: `Ripassa i tuoi appunti su questo argomento.\n\nPunti chiave da studiare:\nâ€¢ Definizioni principali\nâ€¢ Regole e formule\nâ€¢ Esempi pratici\nâ€¢ Esercizi del libro`
}];
}

const colori = {
matematica:â€#2C3E7Aâ€, chimica:â€#1A6B3Câ€, fisica:â€#7A2C2Câ€,
storia:â€#7A5A2Câ€, scienze:â€#1A6B5Aâ€, inglese:â€#2C5A7Aâ€,
geografia:â€#3D7A2Câ€, filosofia:â€#5A2C7Aâ€, italiano:â€#7A2C5Aâ€,
latino:â€#6B3D1Aâ€, informatica:â€#1A3D6Bâ€, arte:â€#7A4A1Aâ€,
musica:â€#4A1A7Aâ€, ed_fisica:â€#1A7A4Aâ€, altra:â€#3D3D3Dâ€
};
const colore = colori[materia] || â€œ#333â€;

const sezioniHTML = sezioni.map((s,i) => `<div class="sezione"> <div class="sezione-header">${i+1}. ${s.titolo}</div> <div class="contenuto">${s.contenuto.replace(/</g,'&lt;').replace(/>/g,'&gt;').replace(/\n/g,'<br>').replace(/([A-Z][A-Z ]{3,}:)/g,'<strong>$1</strong>')}</div> </div>`).join(â€™â€™);

return `<!DOCTYPE html>

<html lang="it">
<head>
<meta charset="UTF-8">
<title>${titolo} â€” ${matLabel}</title>
<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
  * { margin:0; padding:0; box-sizing:border-box; }
  body { font-family: 'Inter', Arial, sans-serif; color: #1a1a1a; background: #fff; }
  .copertina { background: linear-gradient(135deg, ${colore}, ${colore}99); color: white; padding: 60px 50px; min-height: 200px; }
  .copertina .emoji { font-size: 48px; margin-bottom: 16px; }
  .copertina h1 { font-size: 28px; font-weight: 700; margin-bottom: 8px; letter-spacing: -0.5px; }
  .copertina .sub { font-size: 16px; opacity: 0.85; margin-bottom: 4px; }
  .copertina .data { font-size: 13px; opacity: 0.65; margin-top: 12px; }
  .contenuto-wrap { padding: 40px 50px; }
  .sezione { margin-bottom: 32px; break-inside: avoid; }
  .sezione-header { background: ${colore}15; border-left: 4px solid ${colore}; padding: 10px 16px; font-size: 15px; font-weight: 700; color: ${colore}; margin-bottom: 12px; border-radius: 0 8px 8px 0; }
  .contenuto { font-size: 13.5px; line-height: 1.75; color: #2a2a2a; padding: 0 4px; white-space: pre-wrap; font-family: 'Inter', monospace; }
  .contenuto strong { color: ${colore}; }
  .footer { margin-top: 40px; border-top: 1px solid #eee; padding: 16px 0; text-align: center; font-size: 11px; color: #999; }
  @media print { .no-print { display:none; } body { -webkit-print-color-adjust: exact; print-color-adjust: exact; } }
</style>
</head>
<body>
<div class="copertina">
  <div class="emoji">${db ? db.icona : "ğŸ“š"}</div>
  <h1>${argomento || matLabel}</h1>
  <div class="sub">Materia: ${matLabel}${event.tipoVerifica ? ' â€” ' + event.tipoVerifica : ''}</div>
  <div class="data">Generato il ${oggi} â€¢ Il Mio Anno</div>
</div>
<div class="contenuto-wrap">
  ${sezioniHTML}
  <div class="footer">Scheda di ripasso generata da Il Mio Anno â€¢ Studiare bene! ğŸ’ª</div>
</div>
</body>
</html>`;
}

function EserciziPanel({event,onClose}){
const {dark}=React.useContext(ThemeCtx);
const [step,setStep]=useState(â€œsceltaâ€); // scelta | quiz-setup | loading | quiz | pdf
const [livello,setLivello]=useState(3);
const [domande,setDomande]=useState([]);
const [vis,setVis]=useState(false);
useEffect(()=>{requestAnimationFrame(()=>setVis(true))},[]);
const close=()=>{setVis(false);setTimeout(onClose,320)};
const bg=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const card=dark?â€#2C2C2Eâ€:â€#fffâ€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.4)â€:â€œrgba(60,60,67,0.45)â€;
const livelli=[â€œğŸ˜´ Per nienteâ€,â€œğŸ˜Ÿ Pocoâ€,â€œğŸ˜ Abbastanzaâ€,â€œğŸ˜Š Beneâ€,â€œğŸ”¥ Pronto!â€];
const livelloLabel=[â€œFacileâ€,â€œFacileâ€,â€œMedioâ€,â€œDifficileâ€,â€œDifficileâ€];

const [pdfLoading,setPdfLoading]=useState(false);
const apriPdf=async()=>{
setPdfLoading(true);
const mat=MATERIE?MATERIE.find(m=>m.id===(event.materia||â€œaltraâ€)):null;
const matLabel=mat?mat.label:(event.materia||â€œquesta materiaâ€);
const arg=event.argomento||â€â€;
const tipo=event.tipoVerifica||â€œVerificaâ€;
const oggi=new Date().toLocaleDateString(â€˜it-ITâ€™,{day:â€˜numericâ€™,month:â€˜longâ€™,year:â€˜numericâ€™});
const colori={matematica:â€#2C3E7Aâ€,chimica:â€#1A6B3Câ€,fisica:â€#7A2C2Câ€,storia:â€#7A5A2Câ€,scienze:â€#1A6B5Aâ€,inglese:â€#2C5A7Aâ€,geografia:â€#3D7A2Câ€,filosofia:â€#5A2C7Aâ€,italiano:â€#7A2C5Aâ€,latino:â€#6B3D1Aâ€,informatica:â€#1A3D6Bâ€,arte:â€#7A4A1Aâ€,musica:â€#4A1A7Aâ€,ed_fisica:â€#1A7A4Aâ€,altra:â€#3D3D3Dâ€};
const colore=colori[event.materia||â€œaltraâ€]||â€#333â€;
try{
const prompt=`Sei un professore italiano esperto di ${matLabel}. Crea una guida di studio COMPLETA e DETTAGLIATA su: â€œ${arg||matLabel}â€.

Struttura il contenuto con sezioni chiare. Includi:

1. Introduzione e panoramica dellâ€™argomento
1. Concetti fondamentali con spiegazioni chiare
1. Regole, formule o strutture principali (usa simboli testuali per le formule, es: x^2, H2O)
1. Esempi concreti risolti passo per passo
1. Errori comuni da evitare
1. Punti chiave da ricordare per la ${tipo}

Scrivi in italiano, sii preciso e completo. Usa intestazioni con ### per le sezioni. Non usare HTML, solo testo con ### per i titoli e - per le liste.`;

```
  const testo = await callClaude(prompt, 2000);
  
  // Converti markdown semplice in HTML
  const html2 = testo
    .split('\n')
    .map(r=>{
      if(r.startsWith('### ')) return `<h3>${r.slice(4)}</h3>`;
      if(r.startsWith('## '))  return `<h2>${r.slice(3)}</h2>`;
      if(r.startsWith('# '))   return `<h2>${r.slice(2)}</h2>`;
      if(r.startsWith('- '))   return `<li>${r.slice(2)}</li>`;
      if(r.startsWith('* '))   return `<li>${r.slice(2)}</li>`;
      if(r.match(/^\d+\. /)) return `<li>${r.replace(/^\d+\. /,'')}</li>`;
      if(r.trim()==='')       return '<br>';
      return `<p>${r}</p>`;
    })
    .join('\n')
    .replace(/(<li>.*<\/li>\n?)+/g, m=>`<ul>${m}</ul>`);

  const htmlFull=`<!DOCTYPE html><html lang="it"><head><meta charset="UTF-8"><title>${arg||matLabel}</title>
```

<style>
  @import url('https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap');
  *{margin:0;padding:0;box-sizing:border-box}
  body{font-family:'Inter',Arial,sans-serif;color:#1a1a1a;background:#fff}
  .cover{background:linear-gradient(135deg,${colore},${colore}99);color:#fff;padding:50px;min-height:180px}
  .cover h1{font-size:26px;font-weight:700;margin-bottom:8px}
  .cover .sub{font-size:15px;opacity:.85}
  .cover .data{font-size:12px;opacity:.6;margin-top:10px}
  .body{padding:40px 50px;max-width:800px}
  h2{font-size:17px;font-weight:700;color:${colore};border-left:4px solid ${colore};padding:8px 14px;background:${colore}12;margin:24px 0 10px;border-radius:0 6px 6px 0}
  h3{font-size:15px;font-weight:600;color:#333;margin:18px 0 8px}
  p{font-size:14px;line-height:1.75;color:#2a2a2a;margin:4px 0}
  ul{padding-left:20px;margin:8px 0}
  li{font-size:14px;line-height:1.7;color:#2a2a2a;margin:3px 0}
  br{display:block;margin:4px 0}
  .footer{margin-top:40px;border-top:1px solid #eee;padding:16px 0;text-align:center;font-size:11px;color:#999}
  .btn{position:fixed;top:16px;right:16px;padding:10px 20px;background:${colore};color:#fff;border:none;border-radius:8px;font-size:14px;font-weight:700;cursor:pointer;box-shadow:0 2px 8px rgba(0,0,0,.2)}
  @media print{.btn{display:none};body{-webkit-print-color-adjust:exact;print-color-adjust:exact}}
</style></head><body>

<button class="btn" onclick="window.print()">ğŸ“„ Salva PDF</button>

<div class="cover"><h1>ğŸ“š ${arg||matLabel}</h1><div class="sub">${tipo} di ${matLabel}</div><div class="data">Generato il ${oggi} con Claude AI â€¢ Il Mio Anno</div></div>
<div class="body">${html2}<div class="footer">Scheda generata da Claude AI â€¢ Buono studio! ğŸ’ª</div></div>
</body></html>`;
      const blob=new Blob([htmlFull],{type:"text/html"});
      window.open(URL.createObjectURL(blob),"_blank");
    }catch(e){
      // Fallback locale
      const html=generaHTMLPdf(event);
      const blob=new Blob([html],{type:"text/html"});
      window.open(URL.createObjectURL(blob),"_blank");
    }finally{
      setPdfLoading(false);
    }
  };

const avviaQuiz=async()=>{
setStep(â€œloadingâ€);
const mat=MATERIE?MATERIE.find(m=>m.id===(event.materia||â€œaltraâ€)):null;
const matLabel=mat?mat.label:(event.materia||â€œquesta materiaâ€);
const arg=event.argomento||â€â€;
const diff=livello<=2?â€œmolto facili, per chi Ã¨ agli iniziâ€:livello===3?â€œdi media difficoltÃ â€:livello===4?â€œdifficiliâ€:â€œmolto difficili e approfonditeâ€;
try{
const prompt=`Sei un professore italiano di ${matLabel}. Crea esattamente 5 domande a risposta multipla ${diff} su â€œ${arg||matLabel}â€.

Rispondi SOLO con JSON valido (niente altro, niente backtick, niente markdown):
[{â€œdâ€:â€œDomanda?â€,â€œrâ€:[â€œRisposta Aâ€,â€œRisposta Bâ€,â€œRisposta Câ€,â€œRisposta Dâ€],â€œcâ€:â€œRisposta Aâ€},â€¦]

Regole:

- Le domande devono riguardare specificatamente â€œ${arg||matLabel}â€
- Le risposte sbagliate devono essere plausibili
- La risposta corretta â€œcâ€ deve essere identica a una delle risposte in â€œrâ€
- Varia il tipo: definizioni, calcoli, esempi, applicazioni`;
  
  ```
  const raw=await callClaude(prompt,800);
  const clean=raw.replace(/```json|```/g,"").trim().replace(/^[\s\S]*?(\[)/,"$1").replace(/(\])[\s\S]*$/,"$1");
  const parsed=JSON.parse(clean);
  setDomande(parsed.map(q=>({domanda:q.d,risposte:[...q.r].sort(()=>Math.random()-0.5),corretta:q.c,scelta:null})));
  setStep("quiz");
  ```
  
  }catch(e){
  // Fallback locale
  const pool=QUIZ_DB[event.materia||â€œaltraâ€]||QUIZ_DB.altra;
  let filtrate=livello<=2?pool.filter(q=>q.lv===1):livello===3?pool.filter(q=>q.lv<=2):pool.filter(q=>q.lv>=2);
  if(filtrate.length<3) filtrate=pool;
  setDomande([â€¦filtrate].sort(()=>Math.random()-0.5).slice(0,5).map(q=>({domanda:q.d,risposte:[â€¦q.r].sort(()=>Math.random()-0.5),corretta:q.c,scelta:null})));
  setStep(â€œquizâ€);
  }
  };
  
  const rispondi=(i,r)=>setDomande(prev=>prev.map((d,j)=>j===i?{â€¦d,scelta:r}:d));
  const punteggio=domande.filter(d=>d.scelta===d.corretta).length;
  const tutteRisposte=domande.length>0&&domande.every(d=>d.scelta!==null);
  
  return (
  
    <div onClick={e=>e.target===e.currentTarget&&close()} style={{position:"fixed",inset:0,zIndex:600,background:vis?"rgba(0,0,0,0.5)":"rgba(0,0,0,0)",backdropFilter:"blur(8px)",transition:"background 0.3s",display:"flex",flexDirection:"column",justifyContent:"flex-end"}}>
      <div style={{background:bg,borderRadius:"20px 20px 0 0",maxHeight:"92vh",display:"flex",flexDirection:"column",transform:vis?"translateY(0)":"translateY(100%)",transition:"transform 0.4s cubic-bezier(0.32,0.72,0,1)",paddingBottom:"env(safe-area-inset-bottom,24px)"}}>
        <div style={{display:"flex",justifyContent:"center",padding:"10px 0 0"}}><div style={{width:"36px",height:"4px",background:dark?"rgba(255,255,255,0.15)":"rgba(60,60,67,0.15)",borderRadius:"2px"}}/></div>
        <div style={{padding:"14px 20px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0}}>
          <div>
            <div style={{fontSize:"20px",fontWeight:"700",color:txt}}>ğŸ§  Ripasso</div>
            <div style={{fontSize:"13px",color:sub,marginTop:"2px",overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap",maxWidth:"240px"}}>{event.title}</div>
          </div>
          <button onClick={close} style={{background:dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer",color:sub,fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center"}}>Ã—</button>
        </div>
  
  ```
    <div style={{overflowY:"auto",flex:1,padding:"0 16px 16px"}}>
  
      {/* SCELTA MODALITÃ€ */}
      {step==="scelta"&&(
        <div style={{animation:"fadeUp 0.2s ease"}}>
          <div style={{fontSize:"14px",fontWeight:"600",color:sub,marginBottom:"12px",textAlign:"center",textTransform:"uppercase",letterSpacing:"0.05em"}}>Scegli come studiare</div>
          {/* PDF */}
          <div onClick={()=>!pdfLoading&&apriPdf()} style={{background:card,borderRadius:"16px",padding:"18px",marginBottom:"10px",cursor:pdfLoading?"default":"pointer",display:"flex",alignItems:"center",gap:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.06)"}`,opacity:pdfLoading?0.7:1}}>
            <div style={{width:"46px",height:"46px",borderRadius:"12px",background:"rgba(255,59,48,0.12)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"22px",flexShrink:0}}>ğŸ“„</div>
            <div style={{flex:1}}>
              <div style={{fontSize:"16px",fontWeight:"700",color:txt,marginBottom:"3px"}}>Scheda PDF</div>
              <div style={{fontSize:"13px",color:sub}}>Regole, formule ed esempi su {event.argomento||"questa materia"}</div>
            </div>
            <div style={{fontSize:"20px",color:sub}}>â€º</div>
          </div>
          {/* QUIZ */}
          <div onClick={()=>setStep("quiz-setup")} style={{background:card,borderRadius:"16px",padding:"18px",marginBottom:"10px",cursor:"pointer",display:"flex",alignItems:"center",gap:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.06)"}`}}>
            <div style={{width:"46px",height:"46px",borderRadius:"12px",background:"rgba(0,122,255,0.12)",display:"flex",alignItems:"center",justifyContent:"center",fontSize:"22px",flexShrink:0}}>ğŸ¯</div>
            <div style={{flex:1}}>
              <div style={{fontSize:"16px",fontWeight:"700",color:txt,marginBottom:"3px"}}>Quiz a risposta multipla</div>
              <div style={{fontSize:"13px",color:sub}}>5 domande sulla materia, difficoltÃ  adattiva</div>
            </div>
            <div style={{fontSize:"20px",color:sub}}>â€º</div>
          </div>
          {/* ENTRAMBI */}
          <div onClick={()=>{apriPdf();setStep("quiz-setup");}} style={{background:"rgba(255,59,48,0.08)",borderRadius:"16px",padding:"14px 18px",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px",border:"2px solid rgba(255,59,48,0.2)"}}>
            <span style={{fontSize:"18px"}}>âœ¨</span>
            <span style={{fontSize:"14px",fontWeight:"600",color:"#FF3B30"}}>Apri PDF e poi fai il quiz</span>
          </div>
        </div>
      )}
  
      {/* QUIZ SETUP */}
      {step==="quiz-setup"&&(
        <div style={{animation:"fadeUp 0.2s ease"}}>
          <div style={{background:card,borderRadius:"16px",padding:"16px",marginBottom:"12px"}}>
            <div style={{fontSize:"14px",fontWeight:"600",color:txt,marginBottom:"4px"}}>Come ti senti preparato?</div>
            <div style={{fontSize:"12px",color:sub,marginBottom:"12px"}}>La difficoltÃ  si adatta al tuo livello</div>
            <div style={{display:"flex",flexDirection:"column",gap:"8px"}}>
              {livelli.map((l,i)=>(
                <div key={i} onClick={()=>setLivello(i+1)} style={{padding:"12px 16px",borderRadius:"12px",border:`2px solid ${livello===i+1?"#FF3B30":"transparent"}`,background:livello===i+1?"rgba(255,59,48,0.1)":dark?"rgba(255,255,255,0.05)":"rgba(60,60,67,0.04)",cursor:"pointer",display:"flex",alignItems:"center",gap:"12px"}}>
                  <span style={{fontSize:"20px"}}>{l.split(" ")[0]}</span>
                  <div style={{flex:1}}>
                    <div style={{fontSize:"15px",fontWeight:livello===i+1?"600":"400",color:livello===i+1?"#FF3B30":txt}}>{l.split(" ").slice(1).join(" ")}</div>
                    <div style={{fontSize:"11px",color:sub}}>Domande {livelloLabel[i]}</div>
                  </div>
                  {livello===i+1&&<div style={{width:"20px",height:"20px",borderRadius:"50%",background:"#FF3B30",display:"flex",alignItems:"center",justifyContent:"center"}}><span style={{color:"#fff",fontSize:"12px"}}>âœ“</span></div>}
                </div>
              ))}
            </div>
          </div>
          <div style={{display:"flex",gap:"8px"}}>
            <button onClick={()=>setStep("scelta")} style={{flex:1,padding:"14px",borderRadius:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)"}`,background:"transparent",color:txt,fontFamily:"inherit",fontSize:"15px",fontWeight:"600",cursor:"pointer"}}>â† Indietro</button>
            <button onClick={avviaQuiz} style={{flex:2,padding:"14px",borderRadius:"14px",border:"none",background:"#FF3B30",color:"#fff",fontFamily:"inherit",fontSize:"15px",fontWeight:"600",cursor:"pointer"}}>Inizia quiz âœ¨</button>
          </div>
        </div>
      )}
  
      {step==="loading"&&(
        <div style={{textAlign:"center",padding:"60px 0"}}>
          <div style={{fontSize:"44px",marginBottom:"16px"}} className="pulse">ğŸ§ </div>
          <div style={{fontSize:"15px",fontWeight:"600",color:txt}}>Preparo le domandeâ€¦</div>
        </div>
      )}
  
      {step==="quiz"&&(
        <div style={{animation:"fadeUp 0.2s ease"}}>
          <div style={{background:dark?"rgba(255,59,48,0.12)":"rgba(255,59,48,0.08)",borderRadius:"10px",padding:"8px 12px",marginBottom:"12px",display:"flex",justifyContent:"space-between",alignItems:"center"}}>
            <span style={{fontSize:"12px",color:"#FF3B30",fontWeight:"600"}}>ğŸ¯ Quiz â€” {livelloLabel[livello-1]}</span>
            <span style={{fontSize:"12px",color:"#FF3B30",fontWeight:"600"}}>{domande.filter(d=>d.scelta!==null).length}/{domande.length}</span>
          </div>
          {domande.map((d,i)=>(
            <div key={i} style={{background:card,borderRadius:"16px",padding:"16px",marginBottom:"12px"}}>
              <div style={{fontSize:"11px",fontWeight:"700",color:sub,marginBottom:"6px"}}>DOMANDA {i+1}</div>
              <div style={{fontSize:"15px",fontWeight:"600",color:txt,marginBottom:"14px",lineHeight:1.5}}>{d.domanda}</div>
              <div style={{display:"flex",flexDirection:"column",gap:"8px"}}>
                {d.risposte.map((r,j)=>{
                  const risp=d.scelta; const isC=r===d.corretta; const isS=r===risp;
                  let bgR=dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)";
                  let bord="2px solid transparent"; let colR=txt;
                  if(risp!==null){if(isC){bgR="rgba(52,199,89,0.15)";bord="2px solid #34C759";colR="#34C759";}else if(isS){bgR="rgba(255,59,48,0.12)";bord="2px solid #FF3B30";colR="#FF3B30";}}
                  return (
                    <div key={j} onClick={()=>risp===null&&rispondi(i,r)} style={{padding:"11px 14px",borderRadius:"12px",border:bord,background:bgR,cursor:risp===null?"pointer":"default",display:"flex",alignItems:"center",gap:"10px",transition:"all 0.15s"}}>
                      <div style={{width:"24px",height:"24px",borderRadius:"50%",background:risp!==null?(isC?"#34C759":isS?"#FF3B30":dark?"rgba(255,255,255,0.08)":"rgba(0,0,0,0.06)"):"rgba(0,122,255,0.1)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,fontSize:"11px",fontWeight:"700",color:risp!==null?(isC||isS?"#fff":"#888"):"#007AFF"}}>
                        {risp!==null?(isC?"âœ“":isS?"âœ—":String.fromCharCode(65+j)):String.fromCharCode(65+j)}
                      </div>
                      <span style={{fontSize:"14px",color:colR,fontWeight:(isS||isC)&&risp!==null?"600":"400",flex:1,lineHeight:1.3}}>{r}</span>
                    </div>
                  );
                })}
              </div>
              {d.scelta!==null&&<div style={{marginTop:"10px",padding:"8px 12px",borderRadius:"10px",background:d.scelta===d.corretta?"rgba(52,199,89,0.1)":"rgba(255,59,48,0.08)"}}><span style={{fontSize:"13px",fontWeight:"600",color:d.scelta===d.corretta?"#34C759":"#FF3B30"}}>{d.scelta===d.corretta?"âœ… Corretto!":"âŒ Risposta esatta: "+d.corretta}</span></div>}
            </div>
          ))}
          {tutteRisposte&&(
            <div style={{background:card,borderRadius:"16px",padding:"20px",marginBottom:"12px",textAlign:"center",border:`2px solid ${punteggio===domande.length?"#34C759":punteggio>=domande.length*0.6?"#FF9500":"#FF3B30"}`}}>
              <div style={{fontSize:"40px",marginBottom:"8px"}}>{punteggio===domande.length?"ğŸ†":punteggio>=domande.length*0.6?"â­":"ğŸ’ª"}</div>
              <div style={{fontSize:"26px",fontWeight:"700",color:txt}}>{punteggio}/{domande.length}</div>
              <div style={{fontSize:"14px",color:sub,marginTop:"4px"}}>{punteggio===domande.length?"Perfetto! Sei pronto! ğŸ¯":punteggio>=domande.length*0.6?"Bene! Ripassa i punti sbagliati":"Studia ancora, poi riprova!"}</div>
            </div>
          )}
          <div style={{display:"flex",gap:"8px"}}>
            <button onClick={()=>{setDomande([]);setStep("quiz-setup");}} style={{flex:1,padding:"13px",borderRadius:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)"}`,background:"transparent",color:txt,fontFamily:"inherit",fontSize:"14px",fontWeight:"600",cursor:"pointer"}}>â†º Nuovo quiz</button>
            <button onClick={()=>setStep("scelta")} style={{flex:1,padding:"13px",borderRadius:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)"}`,background:"transparent",color:txt,fontFamily:"inherit",fontSize:"14px",fontWeight:"600",cursor:"pointer"}}>ğŸ“„ PDF</button>
            <button onClick={close} style={{flex:1,padding:"13px",borderRadius:"14px",border:"none",background:"#FF3B30",color:"#fff",fontFamily:"inherit",fontSize:"14px",fontWeight:"600",cursor:"pointer"}}>Fine ğŸ¯</button>
          </div>
        </div>
      )}
  
    </div>
  </div>
  ```
  
    </div>
  );

}

function ListaSpesaPanel({event,onClose,onSaveNote}){
const {dark}=React.useContext(ThemeCtx);
const [piatti,setPiatti]=useState(â€â€);
const [step,setStep]=useState(â€œinputâ€);
const [lista,setLista]=useState({lista:[],suggerimenti:[]});
const [loadMsg,setLoadMsg]=useState(â€â€);
const [vis,setVis]=useState(false);
useEffect(()=>{requestAnimationFrame(()=>setVis(true))},[]);
const close=()=>{setVis(false);setTimeout(onClose,320)};
const bg=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const card=dark?â€#2C2C2Eâ€:â€#fffâ€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.4)â€:â€œrgba(60,60,67,0.45)â€;

const genera=async()=>{
if(!piatti.trim())return;
setStep(â€œloadingâ€);
setLoadMsg(â€œğŸ§  Claude sta pensando alla ricettaâ€¦â€);
try{
const prompt=`Sei un cuoco italiano esperto. Lâ€™utente vuole cucinare: â€œ${piatti}â€.

Crea la lista della spesa COMPLETA e PRECISA con tutti gli ingredienti necessari.

Rispondi SOLO con JSON valido, senza markdown, senza backtick:
{
â€œlistaâ€:[
{â€œnomeâ€:â€œnome ingredienteâ€,â€œquantitaâ€:â€œquantitÃ  precisaâ€,â€œcategoriaâ€:â€œemoji categoriaâ€},
â€¦
],
â€œsuggerimentiâ€:[
{â€œnomeâ€:â€œingrediente opzionaleâ€,â€œmotivoâ€:â€œperchÃ© aggiungerloâ€},
â€¦
]
}

Regole:

- Includi TUTTI gli ingredienti reali della ricetta (niente ingredienti inventati o generici)
- Le quantitÃ  devono essere precise per 4 persone
- Categorie emoji: ğŸ¥© carne/pesce, ğŸ¥¬ verdure/frutta, ğŸ¥› latticini/uova, ğŸ¥« dispensa/scatolette, ğŸŒ¾ cereali/farina, ğŸ§‚ spezie/condimenti
- Massimo 3 suggerimenti utili`;
  
  ```
  setLoadMsg("ğŸ“ Preparo la listaâ€¦");
  const raw = await callClaude(prompt, 600);
  const clean = raw.replace(/```json|```/g,"").trim();
  const parsed = JSON.parse(clean);
  setLista(parsed);
  setStep("lista");
  ```
  
  }catch(e){
  // Fallback locale
  setLoadMsg(â€œğŸ“š Uso ricettario localeâ€¦â€);
  await new Promise(r=>setTimeout(r,300));
  setLista(generaListaSpesaOffline(piatti));
  setStep(â€œlistaâ€);
  }
  };
  
  const [checked,setChecked]=useState({});
  const toggle=n=>setChecked(p=>({â€¦p,[n]:!p[n]}));
  const nChecked=Object.values(checked).filter(Boolean).length;
  
  return (
  
    <div onClick={e=>e.target===e.currentTarget&&close()} style={{position:"fixed",inset:0,zIndex:600,background:vis?"rgba(0,0,0,0.5)":"rgba(0,0,0,0)",backdropFilter:"blur(8px)",transition:"background 0.3s",display:"flex",flexDirection:"column",justifyContent:"flex-end"}}>
      <div style={{background:bg,borderRadius:"20px 20px 0 0",maxHeight:"90vh",display:"flex",flexDirection:"column",transform:vis?"translateY(0)":"translateY(100%)",transition:"transform 0.4s cubic-bezier(0.32,0.72,0,1)",paddingBottom:"env(safe-area-inset-bottom,24px)"}}>
        <div style={{display:"flex",justifyContent:"center",padding:"10px 0 0"}}><div style={{width:"36px",height:"4px",background:dark?"rgba(255,255,255,0.15)":"rgba(60,60,67,0.15)",borderRadius:"2px"}}/></div>
        <div style={{padding:"14px 20px 10px",display:"flex",alignItems:"center",justifyContent:"space-between",flexShrink:0}}>
          <div>
            <div style={{fontSize:"20px",fontWeight:"700",color:txt}}>ğŸ›’ Lista della spesa</div>
            <div style={{fontSize:"13px",color:sub,marginTop:"2px"}}>{step==="lista"&&lista.ricetteTrovate?.length>0?`ğŸ“– ${lista.ricetteTrovate.join(", ")}`:"Ingredienti precisi per le tue ricette"}</div>
          </div>
          <button onClick={close} style={{background:dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)",border:"none",borderRadius:"50%",width:"30px",height:"30px",cursor:"pointer",color:sub,fontSize:"18px",display:"flex",alignItems:"center",justifyContent:"center"}}>Ã—</button>
        </div>
  
  ```
    <div style={{overflowY:"auto",flex:1,padding:"0 16px 16px"}}>
  
      {step==="input"&&(
        <div style={{animation:"fadeUp 0.2s ease"}}>
          <div style={{background:card,borderRadius:"16px",padding:"16px",marginBottom:"16px"}}>
            <div style={{fontSize:"14px",fontWeight:"600",color:txt,marginBottom:"4px"}}>Cosa vuoi cucinare? ğŸ³</div>
            <div style={{fontSize:"12px",color:sub,marginBottom:"10px"}}>Scrivi il nome del piatto (es: pasta carbonara, tiramisÃ¹, pizza margherita)</div>
            <textarea value={piatti} onChange={e=>setPiatti(e.target.value)} placeholder={"Es: pasta alla carbonara, tiramisÃ¹\noppure: cena completa con primo e dolceâ€¦"} style={{width:"100%",minHeight:"90px",border:"none",background:dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)",borderRadius:"12px",padding:"12px",fontSize:"15px",fontFamily:"inherit",color:txt,outline:"none",resize:"none",display:"block",boxSizing:"border-box"}}/>
          </div>
          <button onClick={genera} disabled={!piatti.trim()} style={{width:"100%",padding:"15px",borderRadius:"14px",border:"none",background:piatti.trim()?"#34C759":"rgba(60,60,67,0.1)",color:piatti.trim()?"#fff":sub,fontFamily:"inherit",fontSize:"16px",fontWeight:"600",cursor:piatti.trim()?"pointer":"default",transition:"all 0.2s"}}>
            Genera lista ğŸ›’
          </button>
        </div>
      )}
  
      {step==="loading"&&(
        <div style={{textAlign:"center",padding:"50px 0"}}>
          <div style={{fontSize:"40px",marginBottom:"16px"}} className="pulse">ğŸ›’</div>
          <div style={{fontSize:"15px",fontWeight:"600",color:txt,marginBottom:"6px"}}>{loadMsg}</div>
          <div style={{fontSize:"12px",color:sub}}>Qualche secondoâ€¦</div>
        </div>
      )}
  
      {step==="lista"&&lista.lista&&(
        <div style={{animation:"fadeUp 0.2s ease"}}>
          <div style={{background:card,borderRadius:"16px",overflow:"hidden",marginBottom:"12px"}}>
            <div style={{padding:"12px 16px",borderBottom:`1px solid ${dark?"rgba(255,255,255,0.08)":"rgba(60,60,67,0.08)"}`,display:"flex",alignItems:"center",justifyContent:"space-between"}}>
              <span style={{fontSize:"13px",fontWeight:"700",color:sub,letterSpacing:"0.04em"}}>DA COMPRARE</span>
              <span style={{fontSize:"12px",color:sub}}>{nChecked}/{lista.lista.length}</span>
            </div>
            {lista.lista.map((item,i)=>(
              <div key={i} onClick={()=>toggle(item.nome)} style={{padding:"11px 16px",display:"flex",alignItems:"center",gap:"12px",borderBottom:i<lista.lista.length-1?`1px solid ${dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)"}`:"none",cursor:"pointer",background:checked[item.nome]?(dark?"rgba(255,255,255,0.02)":"rgba(0,0,0,0.01)"):"transparent",transition:"background 0.1s"}}>
                <div style={{width:"22px",height:"22px",borderRadius:"50%",border:`2px solid ${checked[item.nome]?"#34C759":"rgba(60,60,67,0.25)"}`,background:checked[item.nome]?"#34C759":"transparent",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,transition:"all 0.15s"}}>
                  {checked[item.nome]&&<span style={{color:"#fff",fontSize:"12px",fontWeight:"700"}}>âœ“</span>}
                </div>
                <span style={{fontSize:"22px",flexShrink:0}}>{item.categoria}</span>
                <div style={{flex:1}}>
                  <span style={{fontSize:"15px",fontWeight:"500",color:checked[item.nome]?sub:txt,textDecoration:checked[item.nome]?"line-through":"none"}}>{item.nome}</span>
                </div>
                <span style={{fontSize:"12px",color:sub,flexShrink:0}}>{item.quantita}</span>
              </div>
            ))}
          </div>
  
          {lista.suggerimenti?.length>0&&(
            <div style={{marginBottom:"12px"}}>
              <div style={{fontSize:"11px",fontWeight:"700",color:sub,letterSpacing:"0.05em",marginBottom:"8px",paddingLeft:"4px"}}>POTRESTI AGGIUNGERE</div>
              <div style={{background:card,borderRadius:"16px",overflow:"hidden"}}>
                {lista.suggerimenti.map((s,i)=>(
                  <div key={i} onClick={()=>toggle("sg_"+s.nome)} style={{padding:"11px 16px",display:"flex",alignItems:"center",gap:"12px",borderBottom:i<lista.suggerimenti.length-1?`1px solid ${dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)"}`:"none",cursor:"pointer"}}>
                    <div style={{width:"22px",height:"22px",borderRadius:"50%",border:`2px solid ${checked["sg_"+s.nome]?"#34C759":"rgba(52,199,89,0.4)"}`,background:checked["sg_"+s.nome]?"#34C759":"rgba(52,199,89,0.08)",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0}}>
                      {checked["sg_"+s.nome]?<span style={{color:"#fff",fontSize:"12px"}}>âœ“</span>:<span style={{color:"#34C759",fontSize:"14px"}}>+</span>}
                    </div>
                    <div style={{flex:1}}>
                      <div style={{fontSize:"14px",fontWeight:"500",color:txt}}>{s.nome}</div>
                      <div style={{fontSize:"11px",color:sub,marginTop:"1px"}}>{s.motivo}</div>
                    </div>
                  </div>
                ))}
              </div>
            </div>
          )}
  
          {nChecked>0&&nChecked===lista.lista.length&&(
            <div style={{background:"rgba(52,199,89,0.12)",border:"1px solid rgba(52,199,89,0.3)",borderRadius:"12px",padding:"12px 16px",marginBottom:"12px",textAlign:"center"}}>
              <div style={{fontSize:"22px",marginBottom:"4px"}}>ğŸ‰</div>
              <div style={{fontSize:"14px",fontWeight:"700",color:"#34C759"}}>Hai preso tutto!</div>
            </div>
          )}
  
          <div style={{display:"flex",gap:"8px"}}>
            <button onClick={()=>{setStep("input");setChecked({});setPiatti("");}} style={{flex:1,padding:"13px",borderRadius:"14px",border:`2px solid ${dark?"rgba(255,255,255,0.1)":"rgba(60,60,67,0.1)"}`,background:"transparent",color:txt,fontFamily:"inherit",fontSize:"14px",fontWeight:"600",cursor:"pointer"}}>â†º Nuova lista</button>
            <button onClick={close} style={{flex:1,padding:"13px",borderRadius:"14px",border:"none",background:"#34C759",color:"#fff",fontFamily:"inherit",fontSize:"14px",fontWeight:"600",cursor:"pointer"}}>âœ“ Fatto!</button>
          </div>
        </div>
      )}
    </div>
  </div>
  ```
  
    </div>
  );

}

// â”€â”€ NOTE VOCALI â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function VoiceNoteBtn({onNote}){
const {dark}=React.useContext(ThemeCtx);
const [recording,setRecording]=useState(false);
const [supported]=useState(()=>â€˜SpeechRecognitionâ€™ in window||â€˜webkitSpeechRecognitionâ€™ in window);
const recRef=useRef(null);

const start=()=>{
if(!supported)return alert(â€œIl riconoscimento vocale non Ã¨ supportato su questo browser.â€);
const SR=window.SpeechRecognition||window.webkitSpeechRecognition;
const rec=new SR();
rec.lang=â€œit-ITâ€;
rec.continuous=false;
rec.interimResults=false;
rec.onresult=e=>{const text=e.results[0][0].transcript;onNote(text);};
rec.onend=()=>setRecording(false);
rec.onerror=()=>setRecording(false);
recRef.current=rec;
rec.start();
setRecording(true);
};
const stop=()=>{recRef.current?.stop();setRecording(false);};

if(!supported)return null;
return (
<button onClick={recording?stop:start} style={{background:recording?â€#FF3B30â€:â€œrgba(60,60,67,0.08)â€,border:â€œnoneâ€,borderRadius:â€œ20pxâ€,padding:â€œ7px 14pxâ€,cursor:â€œpointerâ€,fontFamily:â€œinheritâ€,fontSize:â€œ13pxâ€,fontWeight:â€œ600â€,color:recording?â€#fffâ€:dark?â€#fffâ€:â€#1C1C1Eâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ6pxâ€,transition:â€œall 0.2sâ€}}>
{recording?<><span className="pulse">ğŸ”´</span>Stop</>:<><span>ğŸ¤</span>Voce</>}
</button>
);
}

// â”€â”€ ALERTS PANEL â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function AlertsPanel({alerts,onClose,onGo}){
const {dark}=React.useContext(ThemeCtx);
const [vis,setVis]=useState(false);
useEffect(()=>{requestAnimationFrame(()=>setVis(true))},[]);
const close=()=>{setVis(false);setTimeout(onClose,320)};
const US={urgent:{color:â€#FF3B30â€,label:â€œURGENTEâ€},high:{color:â€#FF9500â€,label:â€œIMPORTANTEâ€},medium:{color:â€#FFCC00â€,label:â€œATTENZIONEâ€},low:{color:â€#007AFFâ€,label:â€œPROMEMORIAâ€}};
return (
<div onClick={e=>e.target===e.currentTarget&&close()} style={{position:â€œfixedâ€,inset:0,zIndex:500,background:vis?â€œrgba(0,0,0,0.4)â€:â€œrgba(0,0,0,0)â€,transition:â€œbackground 0.3sâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,justifyContent:â€œflex-endâ€}}>
<div style={{background:â€#1C1C1Eâ€,borderRadius:â€œ20px 20px 0 0â€,maxHeight:â€œ88vhâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,transform:vis?â€œtranslateY(0)â€:â€œtranslateY(100%)â€,transition:â€œtransform 0.4s cubic-bezier(0.32,0.72,0,1)â€,paddingBottom:â€œenv(safe-area-inset-bottom,24px)â€}}>
<div style={{display:â€œflexâ€,justifyContent:â€œcenterâ€,padding:â€œ10px 0 0â€}}><div style={{width:â€œ36pxâ€,height:â€œ4pxâ€,background:â€œrgba(255,255,255,0.15)â€,borderRadius:â€œ2pxâ€}}/></div>
<div style={{padding:â€œ16px 20px 14pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œspace-betweenâ€}}>
<div>
<div style={{fontSize:â€œ22pxâ€,fontWeight:â€œ700â€,color:â€#fffâ€,letterSpacing:â€-0.5pxâ€}}>Promemoria</div>
<div style={{fontSize:â€œ13pxâ€,color:â€œrgba(255,255,255,0.35)â€,marginTop:â€œ2pxâ€}}>{alerts.length} avvisi</div>
</div>
<button onClick={close} style={{background:â€œrgba(255,255,255,0.1)â€,border:â€œnoneâ€,borderRadius:â€œ50%â€,width:â€œ30pxâ€,height:â€œ30pxâ€,cursor:â€œpointerâ€,color:â€œrgba(255,255,255,0.5)â€,fontSize:â€œ16pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œcenterâ€}}>Ã—</button>
</div>
<div style={{overflowY:â€œautoâ€,flex:1,padding:â€œ0 16px 16pxâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,gap:â€œ8pxâ€}}>
{alerts.map((a,i)=>{
const s=US[a.u],[,am,ad]=a.day.split(â€-â€);
const dl=a.d===0?â€œOggiâ€:a.d===1?â€œDomaniâ€:`${parseInt(ad)} ${MONTHS_S[parseInt(am)-1]}`;
return (
<div key={i} className=â€œtapâ€ onClick={()=>{onGo(a.day);close();}} style={{background:â€#2C2C2Eâ€,borderRadius:â€œ14pxâ€,padding:â€œ14px 16pxâ€,cursor:â€œpointerâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ14pxâ€}}>
<div style={{width:â€œ40pxâ€,height:â€œ40pxâ€,borderRadius:â€œ12pxâ€,background:s.color+â€œ20â€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œcenterâ€,fontSize:â€œ20pxâ€,flexShrink:0}}>{a.icon}</div>
<div style={{flex:1,minWidth:0}}>
<div style={{display:â€œflexâ€,gap:â€œ6pxâ€,alignItems:â€œcenterâ€,marginBottom:â€œ3pxâ€}}>
<span style={{fontSize:â€œ10pxâ€,fontWeight:â€œ700â€,color:s.color,letterSpacing:â€œ0.05emâ€}}>{s.label}</span>
<span style={{fontSize:â€œ11pxâ€,color:â€œrgba(255,255,255,0.3)â€}}>Â· {dl}</span>
</div>
<div style={{fontWeight:â€œ600â€,fontSize:â€œ14pxâ€,color:â€#fffâ€,overflow:â€œhiddenâ€,textOverflow:â€œellipsisâ€,whiteSpace:â€œnowrapâ€}}>{a.e.title}</div>
<div style={{fontSize:â€œ12pxâ€,color:â€œrgba(255,255,255,0.35)â€,marginTop:â€œ2pxâ€}}>{a.msg}</div>
</div>
<span style={{color:â€œrgba(255,255,255,0.2)â€,fontSize:â€œ16pxâ€}}>â€º</span>
</div>
);
})}
</div>
<div style={{padding:â€œ0 16pxâ€}}><button onClick={close} style={{width:â€œ100%â€,padding:â€œ15pxâ€,borderRadius:â€œ14pxâ€,border:â€œnoneâ€,background:â€#007AFFâ€,color:â€#fffâ€,fontFamily:â€œinheritâ€,fontSize:â€œ16pxâ€,fontWeight:â€œ600â€,cursor:â€œpointerâ€}}>OK</button></div>
</div>
</div>
);
}

// â”€â”€ MODAL EVENTO â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function Modal({dayKey,onClose,onSave,editEvent}){
const {dark}=React.useContext(ThemeCtx);
const [step,setStep]=useState(editEvent?â€œdetailsâ€:â€œcategoryâ€);
const [cat,setCat]=useState(editEvent?.category||null);
const [materia,setMat]=useState(editEvent?.materia||null);
const [cMat,setCMat]=useState(editEvent?.customMateria||â€â€);
const [arg,setArg]=useState(editEvent?.argomento||â€â€);
const [tipo,setTipo]=useState(editEvent?.tipoVerifica||â€â€);
const [name,setName]=useState(editEvent?.personName||â€â€);
const [age,setAge]=useState(editEvent?.personAge||â€â€);
const [sugg,setSugg]=useState(editEvent?.selectedSugg||null);
const [ctitle,setCtitle]=useState(editEvent?.customTitle||â€â€);
const [time,setTime]=useState(editEvent?.time||â€â€);
const [note,setNote]=useState(editEvent?.note||â€â€);
const [vis,setVis]=useState(false);
useEffect(()=>{requestAnimationFrame(()=>setVis(true))},[]);
const close=()=>{setVis(false);setTimeout(onClose,320)};
const C=CATS.find(c=>c.id===cat);
const [,km,kd]=dayKey.split(â€-â€);
const bg=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const card=dark?â€#2C2C2Eâ€:â€#fffâ€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.4)â€:â€œrgba(60,60,67,0.45)â€;
const steps=cat===â€œverificaâ€?[â€œcategoryâ€,â€œmateriaâ€,â€œargomentoâ€,â€œdetailsâ€]:cat===â€œcompleannoâ€?[â€œcategoryâ€,â€œcompleannoâ€,â€œdetailsâ€]:[â€œcategoryâ€,â€œsuggerimentiâ€,â€œdetailsâ€];
const si=steps.indexOf(step);

const SUGG_MAP={
commissione:[{label:â€œFare la spesaâ€,emoji:â€œğŸ›’â€},{label:â€œFarmaciaâ€,emoji:â€œğŸ’Šâ€},{label:â€œPagare bolletteâ€,emoji:â€œğŸ’°â€},{label:â€œPostaâ€,emoji:â€œğŸ“®â€},{label:â€œRitirare paccoâ€,emoji:â€œğŸ“¦â€},{label:â€œBanca / ATMâ€,emoji:â€œğŸ¦â€},{label:â€œMeccanicoâ€,emoji:â€œğŸ”§â€},{label:â€œShoppingâ€,emoji:â€œğŸ›ï¸â€},{label:â€œVeterinarioâ€,emoji:â€œğŸ¾â€},{label:â€œReferti mediciâ€,emoji:â€œğŸ“‹â€},{label:â€œAltroâ€,emoji:â€œâœï¸â€}],
appuntamento:[{label:â€œMedicoâ€,emoji:â€œğŸ‘¨â€âš•ï¸â€},{label:â€œDentistaâ€,emoji:â€œğŸ¦·â€},{label:â€œSpecialistaâ€,emoji:â€œğŸ¥â€},{label:â€œFisioterapiaâ€,emoji:â€œğŸ’†â€},{label:â€œAnalisi sangueâ€,emoji:â€œğŸ©¸â€},{label:â€œOculistaâ€,emoji:â€œğŸ‘ï¸â€},{label:â€œColloquio scuolaâ€,emoji:â€œğŸ«â€},{label:â€œRiunioneâ€,emoji:â€œğŸ’¼â€},{label:â€œColloquio lavoroâ€,emoji:â€œğŸ‘”â€},{label:â€œParrucchiereâ€,emoji:â€œâœ‚ï¸â€},{label:â€œAltroâ€,emoji:â€œâœï¸â€}],
todo:[{label:â€œStudiareâ€,emoji:â€œğŸ“šâ€},{label:â€œFare sportâ€,emoji:â€œğŸƒâ€},{label:â€œChiamare qualcunoâ€,emoji:â€œğŸ“â€},{label:â€œPulire casaâ€,emoji:â€œğŸ§¹â€},{label:â€œLavanderiaâ€,emoji:â€œğŸ‘•â€},{label:â€œCucinareâ€,emoji:â€œğŸ³â€},{label:â€œLeggereâ€,emoji:â€œğŸ“–â€},{label:â€œOrganizzareâ€,emoji:â€œğŸ—‚ï¸â€},{label:â€œMeditareâ€,emoji:â€œğŸ§˜â€},{label:â€œProgettoâ€,emoji:â€œğŸ’¡â€},{label:â€œAltroâ€,emoji:â€œâœï¸â€}],
};

const buildTitle=()=>{
if(cat===â€œverificaâ€){const m=MATERIE.find(x=>x.id===materia);const ml=materia===â€œaltraâ€?cMat:m?.label;return arg?`${m?.emoji||"ğŸ“š"} ${tipo||"Verifica"} ${ml} â€” ${arg}`:`${m?.emoji||"ğŸ“š"} ${tipo||"Verifica"} di ${ml}`;}
if(cat===â€œcompleannoâ€)return `ğŸ‚ Compleanno di ${name}${age?` (${age} anni)`:""}`;
return sugg===â€œAltroâ€?ctitle:(sugg||â€â€);
};
const ok=()=>{
if(step===â€œargomentoâ€)return materia!==â€œaltraâ€||cMat.trim();
if(step===â€œcompleannoâ€)return name.trim();
if(step===â€œsuggerimentiâ€)return sugg&&(sugg!==â€œAltroâ€||ctitle.trim());
return true;
};
const save=()=>{const t=buildTitle();if(!t.trim())return;onSave({id:editEvent?.id||Date.now(),category:cat,title:t,time,note,materia,customMateria:cMat,argomento:arg,tipoVerifica:tipo,personName:name,personAge:age,selectedSugg:sugg,customTitle:ctitle});close();};
const go=s=>setStep(s);

return (
<div onClick={e=>e.target===e.currentTarget&&close()} style={{position:â€œfixedâ€,inset:0,zIndex:400,background:vis?â€œrgba(0,0,0,0.4)â€:â€œrgba(0,0,0,0)â€,backdropFilter:â€œblur(8px)â€,transition:â€œall 0.3sâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,justifyContent:â€œflex-endâ€}}>
<div style={{background:bg,borderRadius:â€œ20px 20px 0 0â€,maxHeight:â€œ92vhâ€,overflowY:â€œautoâ€,paddingBottom:â€œenv(safe-area-inset-bottom,20px)â€,transform:vis?â€œtranslateY(0)â€:â€œtranslateY(100%)â€,transition:â€œtransform 0.4s cubic-bezier(0.32,0.72,0,1)â€}}>
<div style={{display:â€œflexâ€,justifyContent:â€œcenterâ€,padding:â€œ10px 0 0â€}}><div style={{width:â€œ36pxâ€,height:â€œ4pxâ€,background:dark?â€œrgba(255,255,255,0.15)â€:â€œrgba(60,60,67,0.15)â€,borderRadius:â€œ2pxâ€}}/></div>
<div style={{padding:â€œ14px 20px 10pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œspace-betweenâ€}}>
<div>
<div style={{fontSize:â€œ12pxâ€,color:sub}}>{parseInt(kd)} {MONTHS[parseInt(km)-1]}</div>
<div style={{fontSize:â€œ20pxâ€,fontWeight:â€œ700â€,color:txt,letterSpacing:â€-0.3pxâ€,marginTop:â€œ2pxâ€}}>{C?`${C.emoji} ${C.label}`:â€œNuovo eventoâ€}</div>
</div>
<button onClick={close} style={{background:dark?â€œrgba(255,255,255,0.1)â€:â€œrgba(60,60,67,0.1)â€,border:â€œnoneâ€,borderRadius:â€œ50%â€,width:â€œ30pxâ€,height:â€œ30pxâ€,cursor:â€œpointerâ€,color:sub,fontSize:â€œ18pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œcenterâ€}}>Ã—</button>
</div>
{cat&&<div style={{display:â€œflexâ€,gap:â€œ3pxâ€,padding:â€œ0 20px 12pxâ€}}>{steps.map((s,i)=><div key={s} style={{height:â€œ3pxâ€,flex:1,borderRadius:â€œ2pxâ€,background:i<=si?(C?.color||â€#007AFFâ€):dark?â€œrgba(255,255,255,0.1)â€:â€œrgba(60,60,67,0.1)â€,transition:â€œbackground 0.3sâ€}}/>)}</div>}

```
    <div style={{padding:"0 16px 20px"}}>
      {step==="category"&&<div style={{animation:"fadeUp 0.2s ease"}}>
        <div style={{fontSize:"13px",color:sub,marginBottom:"10px",paddingLeft:"4px"}}>Seleziona categoria</div>
        {CATS.map(c=>(
          <div key={c.id} className="tap" onClick={()=>{setCat(c.id);c.id==="verifica"?go("materia"):c.id==="compleanno"?go("compleanno"):go("suggerimenti")}} style={{background:card,borderRadius:"14px",padding:"14px 16px",marginBottom:"8px",display:"flex",alignItems:"center",gap:"14px",cursor:"pointer"}}>
            <div style={{width:"44px",height:"44px",borderRadius:"12px",background:c.bg,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"22px"}}>{c.emoji}</div>
            <div style={{flex:1}}>
              <div style={{fontWeight:"600",fontSize:"16px",color:txt}}>{c.label}</div>
              <div style={{fontSize:"12px",color:sub,marginTop:"2px"}}>
                {c.id==="verifica"&&"Materia + esercizi AI"}{c.id==="compleanno"&&"Nome di chi festeggia"}
                {c.id==="commissione"&&"Lista spesa AI inclusa"}{c.id==="appuntamento"&&"Medico, dentistaâ€¦"}
                {c.id==="todo"&&"Cose da non dimenticare"}
              </div>
            </div>
            <span style={{color:sub,fontSize:"20px"}}>â€º</span>
          </div>
        ))}
      </div>}

      {step==="materia"&&<div style={{animation:"fadeUp 0.18s ease"}}>
        <button onClick={()=>go("category")} style={{...BK,color:"#007AFF"}}>â€¹ Indietro</button>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr 1fr",gap:"8px"}}>
          {MATERIE.map(m=>(
            <div key={m.id} className="tap" onClick={()=>{setMat(m.id);go("argomento")}} style={{background:materia===m.id?"#007AFF":card,borderRadius:"12px",padding:"12px 8px",cursor:"pointer",display:"flex",flexDirection:"column",alignItems:"center",gap:"5px",transition:"all 0.15s"}}>
              <span style={{fontSize:"22px"}}>{m.emoji}</span>
              <span style={{fontSize:"11px",textAlign:"center",color:materia===m.id?"#fff":txt,fontWeight:"500",lineHeight:1.2}}>{m.label}</span>
            </div>
          ))}
        </div>
      </div>}

      {step==="argomento"&&<div style={{animation:"fadeUp 0.18s ease"}}>
        <button onClick={()=>go("materia")} style={{...BK,color:"#007AFF"}}>â€¹ Indietro</button>
        {materia==="altra"&&<div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"10px"}}><label style={{...LB,color:sub}}>Materia</label><input value={cMat} onChange={e=>setCMat(e.target.value)} placeholder="Es. Dirittoâ€¦" style={{...IP,color:txt}} autoFocus/></div>}
        <div style={{background:card,borderRadius:"14px",padding:"14px 16px",marginBottom:"10px"}}>
          <label style={{...LB,color:sub}}>Tipo di verifica</label>
          <div style={{display:"flex",gap:"6px",flexWrap:"wrap",marginTop:"8px"}}>{TIPI.map(t=><button key={t} onClick={()=>setTipo(tipo===t?"":t)} style={{padding:"7px 14px",borderRadius:"20px",fontFamily:"inherit",border:"none",background:tipo===t?"#FF3B30":dark?"rgba(255,255,255,0.08)":"rgba(60,60,67,0.08)",color:tipo===t?"#fff":txt,fontSize:"14px",fontWeight:"500",cursor:"pointer",transition:"all 0.15s"}}>{t}</button>)}</div>
        </div>
        <div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"8px"}}>
          <label style={{...LB,color:sub}}>Argomento <span style={{fontWeight:"400",opacity:0.5}}>(opzionale)</span></label>
          <input value={arg} onChange={e=>setArg(e.target.value)} placeholder="Es. Equazioni, Risorgimentoâ€¦" style={{...IP,color:txt}}/>
        </div>
        <div style={{display:"flex",gap:"8px",marginBottom:"16px",alignItems:"center"}}>
          <VoiceNoteBtn onNote={v=>setArg(v)}/>
          <span style={{fontSize:"12px",color:sub}}>Ditta l'argomento</span>
        </div>
        <button onClick={()=>ok()&&go("details")} style={{...BB,background:ok()?"#FF3B30":"rgba(60,60,67,0.1)",color:ok()?"#fff":sub}}>Continua</button>
      </div>}

      {step==="compleanno"&&<div style={{animation:"fadeUp 0.18s ease"}}>
        <button onClick={()=>go("category")} style={{...BK,color:"#007AFF"}}>â€¹ Indietro</button>
        <div style={{textAlign:"center",fontSize:"50px",margin:"8px 0 14px"}}>ğŸ‚</div>
        <div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"10px"}}><label style={{...LB,color:sub}}>Nome</label><input value={name} onChange={e=>setName(e.target.value)} placeholder="Es. Marcoâ€¦" style={{...IP,color:txt}} autoFocus/></div>
        <div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"16px"}}><label style={{...LB,color:sub}}>Quanti anni?</label><input value={age} onChange={e=>setAge(e.target.value)} placeholder="Es. 18â€¦" style={{...IP,color:txt}} type="number"/></div>
        <button onClick={()=>name.trim()&&go("details")} style={{...BB,background:name.trim()?"#FF9500":"rgba(60,60,67,0.1)",color:name.trim()?"#fff":sub}}>Continua</button>
      </div>}

      {step==="suggerimenti"&&<div style={{animation:"fadeUp 0.18s ease"}}>
        <button onClick={()=>go("category")} style={{...BK,color:"#007AFF"}}>â€¹ Indietro</button>
        <div style={{fontSize:"13px",color:sub,marginBottom:"10px",paddingLeft:"4px"}}>{cat==="commissione"&&"Cosa devi fare?"}{cat==="appuntamento"&&"Che tipo di appuntamento?"}{cat==="todo"&&"Cosa vuoi ricordarti?"}</div>
        <div style={{display:"grid",gridTemplateColumns:"1fr 1fr",gap:"8px",marginBottom:"10px"}}>
          {SUGG_MAP[cat]?.map(s=>(
            <div key={s.label} className="tap" onClick={()=>setSugg(s.label)} style={{background:sugg===s.label?(C?.color||"#007AFF"):card,borderRadius:"12px",padding:"12px",cursor:"pointer",display:"flex",alignItems:"center",gap:"10px",transition:"all 0.15s"}}>
              <span style={{fontSize:"20px"}}>{s.emoji}</span>
              <span style={{fontSize:"13px",fontWeight:"500",color:sugg===s.label?"#fff":txt,lineHeight:1.2}}>{s.label}</span>
            </div>
          ))}
        </div>
        {sugg==="Altro"&&<div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"10px"}}><input value={ctitle} onChange={e=>setCtitle(e.target.value)} placeholder="Scrivi cosa devi fareâ€¦" style={{...IP,color:txt}} autoFocus/></div>}
        <button onClick={()=>ok()&&go("details")} style={{...BB,background:ok()?(C?.color||"#007AFF"):"rgba(60,60,67,0.1)",color:ok()?"#fff":sub}}>Continua</button>
      </div>}

      {step==="details"&&<div style={{animation:"fadeUp 0.18s ease"}}>
        <button onClick={()=>cat==="verifica"?go("argomento"):cat==="compleanno"?go("compleanno"):go("suggerimenti")} style={{...BK,color:"#007AFF"}}>â€¹ Indietro</button>
        <div style={{background:card,borderRadius:"14px",padding:"14px 16px",marginBottom:"10px",borderLeft:`4px solid ${C?.color||"#007AFF"}`}}>
          <div style={{fontSize:"11px",color:sub,fontWeight:"600",marginBottom:"4px",textTransform:"uppercase",letterSpacing:"0.04em"}}>{C?.label}</div>
          <div style={{fontWeight:"600",fontSize:"15px",color:txt}}>{buildTitle()}</div>
        </div>
        <div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"10px"}}><label style={{...LB,color:sub}}>Orario</label><input type="time" value={time} onChange={e=>setTime(e.target.value)} style={{...IP,color:txt}}/></div>
        <div style={{background:card,borderRadius:"14px",padding:"4px 16px",marginBottom:"8px"}}><label style={{...LB,color:sub}}>Note</label><textarea value={note} onChange={e=>setNote(e.target.value)} placeholder="Aggiungi dettagliâ€¦" style={{...IP,color:txt,height:"60px",resize:"none",paddingTop:"8px"}}/></div>
        <div style={{display:"flex",gap:"8px",marginBottom:"16px",alignItems:"center"}}>
          <VoiceNoteBtn onNote={v=>setNote(v)}/>
          <span style={{fontSize:"12px",color:sub}}>Ditta le note</span>
        </div>
        <button onClick={save} style={{...BB,background:C?.color||"#007AFF"}}>Salva evento</button>
      </div>}
    </div>
  </div>
</div>
```

);
}

// â”€â”€ DAY SHEET â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function DaySheet({dayKey,events,onAdd,onEdit,onDel,onClose}){
const {dark}=React.useContext(ThemeCtx);
const [vis,setVis]=useState(false);
const [aiEvent,setAiEvent]=useState(null);
const [aiType,setAiType]=useState(null);
const [,km,kd]=dayKey.split(â€-â€);
const isT=dayKey===todayStr;
const diff=daysBetween(dayKey);
useEffect(()=>{requestAnimationFrame(()=>setVis(true))},[]);
const close=()=>{setVis(false);setTimeout(onClose,320)};
const bg=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const card=dark?â€#2C2C2Eâ€:â€#fffâ€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.4)â€:â€œrgba(60,60,67,0.45)â€;
return (
<>
<div onClick={e=>e.target===e.currentTarget&&close()} style={{position:â€œfixedâ€,inset:0,zIndex:300,background:vis?â€œrgba(0,0,0,0.25)â€:â€œrgba(0,0,0,0)â€,transition:â€œbackground 0.3sâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,justifyContent:â€œflex-endâ€}}>
<div style={{background:bg,borderRadius:â€œ20px 20px 0 0â€,maxHeight:â€œ75vhâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,transform:vis?â€œtranslateY(0)â€:â€œtranslateY(100%)â€,transition:â€œtransform 0.4s cubic-bezier(0.32,0.72,0,1)â€,paddingBottom:â€œenv(safe-area-inset-bottom,16px)â€}}>
<div style={{display:â€œflexâ€,justifyContent:â€œcenterâ€,padding:â€œ10px 0 0â€}}><div style={{width:â€œ36pxâ€,height:â€œ4pxâ€,background:dark?â€œrgba(255,255,255,0.15)â€:â€œrgba(60,60,67,0.15)â€,borderRadius:â€œ2pxâ€}}/></div>
<div style={{padding:â€œ12px 20px 12pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,justifyContent:â€œspace-betweenâ€,borderBottom:`1px solid ${dark?"rgba(255,255,255,0.08)":"rgba(60,60,67,0.1)"}`}}>
<div>
<div style={{fontSize:â€œ21pxâ€,fontWeight:â€œ700â€,color:txt,letterSpacing:â€-0.4pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ8pxâ€}}>
{parseInt(kd)} {MONTHS[parseInt(km)-1]}
{isT&&<span style={{fontSize:â€œ12pxâ€,background:â€#FF3B30â€,color:â€#fffâ€,padding:â€œ2px 10pxâ€,borderRadius:â€œ10pxâ€,fontWeight:â€œ600â€}}>oggi</span>}
</div>
<div style={{fontSize:â€œ13pxâ€,color:sub,marginTop:â€œ2pxâ€}}>{events.length} {events.length===1?â€œeventoâ€:â€œeventiâ€}</div>
</div>
<button onClick={onAdd} style={{background:â€#007AFFâ€,color:â€#fffâ€,border:â€œnoneâ€,borderRadius:â€œ20pxâ€,padding:â€œ8px 18pxâ€,fontSize:â€œ14pxâ€,fontWeight:â€œ600â€,cursor:â€œpointerâ€,fontFamily:â€œinheritâ€}}>+ Aggiungi</button>
</div>
<div style={{overflowY:â€œautoâ€,flex:1,padding:â€œ12px 16pxâ€}}>
{events.length===0?(
<div style={{textAlign:â€œcenterâ€,padding:â€œ32px 0â€}}>
<div style={{fontSize:â€œ38pxâ€,marginBottom:â€œ8pxâ€}}>ğŸ“‹</div>
<div style={{color:sub,fontSize:â€œ15pxâ€,fontWeight:â€œ500â€}}>Nessun evento</div>
<div style={{color:dark?â€œrgba(255,255,255,0.2)â€:â€œrgba(60,60,67,0.25)â€,fontSize:â€œ13pxâ€,marginTop:â€œ4pxâ€}}>Tocca + Aggiungi</div>
</div>
):(
<div style={{background:card,borderRadius:â€œ14pxâ€,overflow:â€œhiddenâ€}}>
{events.map((ev,i)=>{
const c=getCat(ev.category);
const evDiff=daysBetween(dayKey);
const showAiBtn=ev.category===â€œverificaâ€||(ev.category===â€œcommissioneâ€&&ev.title?.includes(â€œspesaâ€));
return (
<div key={ev.id}>
<div style={{padding:â€œ12px 14pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ12pxâ€,borderBottom:`1px solid ${dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)"}`}}>
<div style={{width:â€œ10pxâ€,height:â€œ10pxâ€,borderRadius:â€œ50%â€,background:c.color,flexShrink:0}}/>
<div style={{flex:1,minWidth:0}}>
<div style={{fontWeight:â€œ500â€,fontSize:â€œ15pxâ€,color:txt,overflow:â€œhiddenâ€,textOverflow:â€œellipsisâ€,whiteSpace:â€œnowrapâ€}}>{ev.title}</div>
<div style={{fontSize:â€œ12pxâ€,color:sub,marginTop:â€œ2pxâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ6pxâ€}}>
<span>{c.label}{ev.time?` Â· ${ev.time}`:â€â€}</span>
{ev.category===â€œverificaâ€&&evDiff>0&&<span style={{background:â€#FF3B30â€,color:â€#fffâ€,borderRadius:â€œ6pxâ€,padding:â€œ1px 5pxâ€,fontSize:â€œ10pxâ€,fontWeight:â€œ700â€}}>-{evDiff}g</span>}
</div>
</div>
<button onClick={()=>onEdit(ev)} style={{background:â€œnoneâ€,border:â€œnoneâ€,cursor:â€œpointerâ€,color:sub,fontSize:â€œ15pxâ€,padding:â€œ4pxâ€}}>âœï¸</button>
<button onClick={()=>onDel(ev.id)} style={{background:â€œnoneâ€,border:â€œnoneâ€,cursor:â€œpointerâ€,color:dark?â€œrgba(255,255,255,0.2)â€:â€œrgba(60,60,67,0.2)â€,fontSize:â€œ20pxâ€,padding:â€œ4pxâ€}}>Ã—</button>
</div>
{/* AI buttons */}
{showAiBtn&&(
<div style={{padding:â€œ8px 14px 10pxâ€,display:â€œflexâ€,gap:â€œ8pxâ€,borderBottom:i<events.length-1?`1px solid ${dark?"rgba(255,255,255,0.06)":"rgba(60,60,67,0.06)"}`:â€œnoneâ€}}>
{ev.category===â€œverificaâ€&&(
<button onClick={()=>{setAiEvent(ev);setAiType(â€œeserciziâ€);}} style={{padding:â€œ6px 12pxâ€,borderRadius:â€œ12pxâ€,border:â€œnoneâ€,background:â€œrgba(255,59,48,0.1)â€,color:â€#FF3B30â€,fontSize:â€œ12pxâ€,fontWeight:â€œ600â€,cursor:â€œpointerâ€,fontFamily:â€œinheritâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ4pxâ€}}>
ğŸ§  Ripasso AI
</button>
)}
{ev.category===â€œcommissioneâ€&&(ev.selectedSugg===â€œFare la spesaâ€||ev.title?.toLowerCase().includes(â€œspesaâ€))&&(
<button onClick={()=>{setAiEvent(ev);setAiType(â€œspesaâ€);}} style={{padding:â€œ6px 12pxâ€,borderRadius:â€œ12pxâ€,border:â€œnoneâ€,background:â€œrgba(52,199,89,0.1)â€,color:â€#34C759â€,fontSize:â€œ12pxâ€,fontWeight:â€œ600â€,cursor:â€œpointerâ€,fontFamily:â€œinheritâ€,display:â€œflexâ€,alignItems:â€œcenterâ€,gap:â€œ4pxâ€}}>
ğŸ›’ Lista spesa AI
</button>
)}
</div>
)}
</div>
);
})}
</div>
)}
</div>
</div>
</div>
{aiEvent&&aiType===â€œeserciziâ€&&<EserciziPanel event={aiEvent} onClose={()=>setAiEvent(null)}/>}
{aiEvent&&aiType===â€œspesaâ€&&<ListaSpesaPanel event={aiEvent} onClose={()=>setAiEvent(null)}/>}
</>
);
}

// â”€â”€ MAIN APP â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
function App(){
const [pref,setPref]=useState(loadPref);
const [year,setYear]=useState(today.getFullYear());
const [month,setMonth]=useState(today.getMonth());
const [events,setEvents]=useState(loadEv);
const [selDay,setSelDay]=useState(null);
const [showModal,setShowModal]=useState(false);
const [editEv,setEditEv]=useState(null);
const [view,setView]=useState(â€œmonthâ€);
const [fCat,setFCat]=useState(null);
const [showAl,setShowAl]=useState(false);
const meteo=useMeteo();
const dark=pref.dark;

const toggleDark=()=>{const np={â€¦pref,dark:!dark};setPref(np);savePref(np);document.body.className=np.dark?â€œdarkâ€:â€œlightâ€;};
useEffect(()=>{document.body.className=dark?â€œdarkâ€:â€œlightâ€;},[dark]);
useEffect(()=>{saveEv(events)},[events]);
useEffect(()=>{const a=getAlerts(events);if(a.length>0)setTimeout(()=>setShowAl(true),700);},[]);

const alerts=getAlerts(events);
const getDay=k=>events[k]||[];
const handleSave=ev=>{setEvents(p=>{const d=p[selDay]||[];if(editEv)return{â€¦p,[selDay]:d.map(e=>e.id===ev.id?ev:e)};return{â€¦p,[selDay]:[â€¦d,ev]};});};
const delEv=(k,id)=>setEvents(p=>({â€¦p,[k]:(p[k]||[]).filter(e=>e.id!==id)}));

const bg=dark?â€#000â€:â€#fffâ€;
const bgSub=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;
const txt=dark?â€#fffâ€:â€#1C1C1Eâ€;
const sub=dark?â€œrgba(255,255,255,0.35)â€:â€œrgba(60,60,67,0.45)â€;
const border=dark?â€œrgba(255,255,255,0.08)â€:â€œrgba(60,60,67,0.1)â€;
const card=dark?â€#1C1C1Eâ€:â€#F2F2F7â€;

const totM=Object.entries(events).filter(([k])=>k.startsWith(`${year}-${String(month+1).padStart(2,'0')}`)).flatMap(([,e])=>e).length;
const allEv=Object.entries(events).flatMap(([day,evs])=>evs.map(e=>({â€¦e,day}))).filter(e=>e.day.startsWith(String(year))).filter(e=>!fCat||e.category===fCat).sort((a,b)=>a.day.localeCompare(b.day));
const upcoming=Object.entries(events).flatMap(([day,evs])=>evs.map(e=>({â€¦e,day}))).filter(e=>e.day>=todayStr).sort((a,b)=>a.day.localeCompare(b.day)).slice(0,5);
const wDays=Array.from({length:7},(_,i)=>{const d=new Date(),dow=d.getDay()===0?6:d.getDay()-1,dd=new Date(d);dd.setDate(d.getDate()-dow+i);return dd;});

return (
<ThemeCtx.Provider value={{dark,toggle:toggleDark}}>
<div style={{fontFamily:â€-apple-system,â€˜SF Pro Textâ€™,â€˜Helvetica Neueâ€™,sans-serifâ€,background:bg,height:â€œ100vhâ€,maxWidth:â€œ430pxâ€,margin:â€œ0 autoâ€,display:â€œflexâ€,flexDirection:â€œcolumnâ€,overflow:â€œhiddenâ€,transition:â€œbackground 0.3s,color 0.3sâ€}}>

```
  {/* HEADER */}
  <div style={{background:dark?"rgba(0,0,0,0.95)":"rgba(255,255,255,0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",paddingTop:"env(safe-area-inset-top,44px)",flexShrink:0,borderBottom:`1px solid ${border}`}}>
    <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",padding:"8px 16px 6px"}}>
      <div style={{display:"flex",alignItems:"center",gap:"6px"}}>
        <button className="tap" onClick={()=>{const n=addMonths(year,month,-1);setYear(n.year);setMonth(n.month);}} style={{background:"none",border:"none",cursor:"pointer",fontSize:"24px",color:"#007AFF",padding:"2px 6px",lineHeight:1}}>â€¹</button>
        {/* Meteo */}
        {meteo&&<div style={{fontSize:"13px",color:sub,display:"flex",alignItems:"center",gap:"3px"}}><span>{meteo.icon}</span><span>{meteo.temp}Â°</span></div>}
      </div>
      <button onClick={()=>{setYear(today.getFullYear());setMonth(today.getMonth());}} style={{background:"none",border:"none",cursor:"pointer",textAlign:"center",padding:"2px 8px"}}>
        <div style={{fontSize:"17px",fontWeight:"700",color:txt,letterSpacing:"-0.3px",lineHeight:1}}>{MONTHS[month]} {year}</div>
        {totM>0&&<div style={{fontSize:"11px",color:sub,marginTop:"1px"}}>{totM} eventi</div>}
      </button>
      <div style={{display:"flex",alignItems:"center",gap:"2px"}}>
        <button className="tap" onClick={toggleDark} style={{background:"none",border:"none",cursor:"pointer",padding:"2px 6px",fontSize:"18px"}}>{dark?"â˜€ï¸":"ğŸŒ™"}</button>
        <button className="tap" onClick={()=>setShowAl(true)} style={{background:"none",border:"none",cursor:"pointer",padding:"2px 6px",position:"relative"}}>
          <span style={{fontSize:"18px"}}>ğŸ””</span>
          {alerts.length>0&&<div style={{position:"absolute",top:"-2px",right:"2px",minWidth:"15px",height:"15px",background:"#FF3B30",borderRadius:"8px",fontSize:"9px",color:"#fff",fontWeight:"700",display:"flex",alignItems:"center",justifyContent:"center",padding:"0 3px",border:`1.5px solid ${bg}`}}>{alerts.length}</div>}
        </button>
        <button className="tap" onClick={()=>{const n=addMonths(year,month,1);setYear(n.year);setMonth(n.month);}} style={{background:"none",border:"none",cursor:"pointer",fontSize:"24px",color:"#007AFF",padding:"2px 6px",lineHeight:1}}>â€º</button>
      </div>
    </div>
    <div style={{display:"flex",padding:"0 16px"}}>
      {[["month","Calendario"],["list","Lista"]].map(([v,l])=>(
        <button key={v} onClick={()=>setView(v)} style={{flex:1,padding:"6px 0 8px",border:"none",background:"transparent",fontFamily:"inherit",fontSize:"13px",fontWeight:view===v?"600":"400",color:view===v?"#007AFF":sub,cursor:"pointer",borderBottom:view===v?"2px solid #007AFF":"2px solid transparent",transition:"all 0.2s"}}>{l}</button>
      ))}
    </div>
  </div>

  {/* CONTENT */}
  <div style={{flex:1,overflowY:"auto",paddingBottom:"80px"}}>
    {view==="month"&&(
      <div>
        <div style={{padding:"8px 8px 4px"}}>
          <SwipeCalendar year={year} month={month} events={events} alerts={alerts}
            onDay={setSelDay} onMonthChange={(y,m)=>{setYear(y);setMonth(m);}}/>
        </div>

        {upcoming.length>0&&(
          <div style={{padding:"0 12px",marginTop:"8px"}}>
            <div style={{fontSize:"11px",fontWeight:"600",color:sub,letterSpacing:"0.06em",marginBottom:"8px",paddingLeft:"4px"}}>PROSSIMI EVENTI</div>
            <div style={{background:dark?"#1C1C1E":"#F2F2F7",borderRadius:"14px",overflow:"hidden"}}>
              {upcoming.map((ev,i)=>{
                const c=getCat(ev.category),d=daysBetween(ev.day),[,em,ed]=ev.day.split("-");
                return (
                  <div key={`${ev.day}-${ev.id}`} className="tap" onClick={()=>setSelDay(ev.day)} style={{padding:"10px 14px",display:"flex",alignItems:"center",gap:"12px",cursor:"pointer",borderBottom:i<upcoming.length-1?`1px solid ${border}`:"none",background:dark?"#2C2C2E":"#fff"}}>
                    <div style={{width:"32px",height:"32px",borderRadius:"8px",background:c.bg,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexShrink:0}}>
                      <div style={{fontSize:"13px",fontWeight:"700",color:c.color,lineHeight:1}}>{parseInt(ed)}</div>
                      <div style={{fontSize:"8px",color:c.color,fontWeight:"500"}}>{MONTHS_S[parseInt(em)-1]}</div>
                    </div>
                    <div style={{flex:1,minWidth:0}}>
                      <div style={{fontWeight:"500",fontSize:"14px",color:txt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{ev.title}</div>
                      <div style={{fontSize:"11px",color:sub,marginTop:"1px",display:"flex",alignItems:"center",gap:"5px"}}>
                        {d===0?<span style={{color:c.color,fontWeight:"600"}}>Oggi</span>:d===1?<span style={{color:"#FF9500",fontWeight:"600"}}>Domani</span>:<span>{c.label}</span>}
                        {ev.time&&` Â· ${ev.time}`}
                        {ev.category==="verifica"&&d>0&&d<=15&&<span style={{background:"#FF3B30",color:"#fff",borderRadius:"5px",padding:"1px 5px",fontSize:"10px",fontWeight:"700"}}>-{d}g</span>}
                      </div>
                    </div>
                    <span style={{color:sub,fontSize:"14px"}}>â€º</span>
                  </div>
                );
              })}
            </div>
          </div>
        )}

        <div style={{margin:"10px 12px 0",background:dark?"#1C1C1E":"#F2F2F7",borderRadius:"14px",padding:"12px 14px"}}>
          <div style={{fontSize:"10px",fontWeight:"600",color:sub,letterSpacing:"0.06em",marginBottom:"8px"}}>CATEGORIE</div>
          <div style={{display:"flex",flexWrap:"wrap",gap:"6px 18px"}}>
            {CATS.map(c=><div key={c.id} style={{display:"flex",alignItems:"center",gap:"5px"}}><div style={{width:"7px",height:"7px",borderRadius:"50%",background:c.color}}/><span style={{fontSize:"12px",color:sub}}>{c.label}</span></div>)}
          </div>
        </div>
      </div>
    )}

    {view==="list"&&(
      <div style={{padding:"12px"}}>
        <div style={{display:"flex",alignItems:"center",justifyContent:"space-between",marginBottom:"12px"}}>
          <button className="tap" onClick={()=>setYear(y=>y-1)} style={{background:"none",border:"none",fontSize:"22px",color:"#007AFF",cursor:"pointer",padding:"4px 10px"}}>â€¹</button>
          <span style={{fontSize:"17px",fontWeight:"700",color:txt}}>{year}</span>
          <button className="tap" onClick={()=>setYear(y=>y+1)} style={{background:"none",border:"none",fontSize:"22px",color:"#007AFF",cursor:"pointer",padding:"4px 10px"}}>â€º</button>
        </div>
        <div style={{display:"flex",gap:"6px",overflowX:"auto",paddingBottom:"4px",marginBottom:"12px"}}>
          <button onClick={()=>setFCat(null)} style={{padding:"5px 14px",borderRadius:"20px",border:"none",flexShrink:0,background:!fCat?"#007AFF":dark?"#2C2C2E":"#F2F2F7",color:!fCat?"#fff":sub,fontSize:"13px",fontWeight:"500",cursor:"pointer",fontFamily:"inherit"}}>Tutti</button>
          {CATS.map(c=><button key={c.id} onClick={()=>setFCat(fCat===c.id?null:c.id)} style={{padding:"5px 12px",borderRadius:"20px",border:"none",flexShrink:0,background:fCat===c.id?c.color:dark?"#2C2C2E":"#F2F2F7",color:fCat===c.id?"#fff":c.color,fontSize:"13px",fontWeight:"500",cursor:"pointer",fontFamily:"inherit"}}>{c.emoji} {c.label}</button>)}
        </div>
        {allEv.length===0?(
          <div style={{textAlign:"center",padding:"50px 0"}}><div style={{fontSize:"40px",marginBottom:"10px"}}>ğŸ“‹</div><div style={{color:sub,fontSize:"15px"}}>Nessun evento</div></div>
        ):(
          <div style={{background:dark?"#1C1C1E":"#fff",borderRadius:"14px",overflow:"hidden"}}>
            {allEv.map((ev,i)=>{
              const c=getCat(ev.category),[,em,ed]=ev.day.split("-"),d=daysBetween(ev.day);
              return (
                <div key={`${ev.day}-${ev.id}`} style={{padding:"11px 14px",display:"flex",alignItems:"center",gap:"12px",borderBottom:i<allEv.length-1?`1px solid ${border}`:"none"}}>
                  <div style={{width:"32px",height:"32px",borderRadius:"8px",background:c.bg,display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",flexShrink:0}}>
                    <div style={{fontSize:"13px",fontWeight:"700",color:c.color,lineHeight:1}}>{parseInt(ed)}</div>
                    <div style={{fontSize:"8px",color:c.color,fontWeight:"500"}}>{MONTHS_S[parseInt(em)-1]}</div>
                  </div>
                  <div style={{flex:1,minWidth:0}}>
                    <div style={{fontWeight:"500",fontSize:"14px",color:txt,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}}>{ev.title}</div>
                    <div style={{fontSize:"11px",color:sub,marginTop:"1px",display:"flex",alignItems:"center",gap:"5px"}}>
                      <span>{c.label}{ev.time?` Â· ${ev.time}`:""}</span>
                      {ev.category==="verifica"&&d>0&&d<=15&&<span style={{background:"#FF3B30",color:"#fff",borderRadius:"5px",padding:"1px 5px",fontSize:"10px",fontWeight:"700"}}>-{d}g</span>}
                    </div>
                  </div>
                  <button onClick={()=>delEv(ev.day,ev.id)} style={{background:"none",border:"none",cursor:"pointer",color:sub,fontSize:"20px",padding:"4px"}}>Ã—</button>
                </div>
              );
            })}
          </div>
        )}
      </div>
    )}
  </div>

  {/* BOTTOM WEEK */}
  <div style={{position:"fixed",bottom:0,left:"50%",transform:"translateX(-50%)",width:"100%",maxWidth:"430px",background:dark?"rgba(0,0,0,0.95)":"rgba(255,255,255,0.95)",backdropFilter:"blur(20px)",WebkitBackdropFilter:"blur(20px)",borderTop:`1px solid ${border}`,padding:"6px 10px env(safe-area-inset-bottom,16px)",zIndex:150}}>
    <div style={{display:"flex",justifyContent:"space-between"}}>
      {wDays.map((d,i)=>{
        const key=fmt(d.getFullYear(),d.getMonth(),d.getDate()),evs=getDay(key),isT=key===todayStr,hasAl=alerts.some(a=>a.day===key);
        return (
          <div key={i} className="tap" onClick={()=>setSelDay(key)} style={{flex:1,display:"flex",flexDirection:"column",alignItems:"center",padding:"3px 1px",cursor:"pointer",position:"relative"}}>
            {hasAl&&!isT&&<div style={{position:"absolute",top:"0",right:"4px",width:"5px",height:"5px",borderRadius:"50%",background:"#FF3B30"}}/>}
            <div style={{fontSize:"10px",fontWeight:"500",color:isT?"#FF3B30":sub,marginBottom:"3px"}}>{DAYS[i]}</div>
            <div style={{width:"30px",height:"30px",borderRadius:"50%",background:isT?"#FF3B30":"transparent",display:"flex",alignItems:"center",justifyContent:"center"}}>
              <div style={{fontSize:"15px",fontWeight:isT?"700":"400",color:isT?"#fff":i>=5?"#FF9500":txt}}>{d.getDate()}</div>
            </div>
            <div style={{width:"4px",height:"4px",borderRadius:"50%",marginTop:"2px",background:evs.length>0?(isT?"rgba(255,255,255,0.8)":getCat(evs[0].category).color):"transparent"}}/>
          </div>
        );
      })}
    </div>
  </div>

  {showAl&&<AlertsPanel alerts={alerts} onClose={()=>setShowAl(false)} onGo={day=>{setSelDay(day);setMonth(parseInt(day.split("-")[1])-1);setYear(parseInt(day.split("-")[0]));setView("month");}}/>}
  {selDay&&!showModal&&!showAl&&<DaySheet dayKey={selDay} events={getDay(selDay)} onAdd={()=>{setEditEv(null);setShowModal(true)}} onEdit={ev=>{setEditEv(ev);setShowModal(true)}} onDel={id=>delEv(selDay,id)} onClose={()=>setSelDay(null)}/>}
  {showModal&&selDay&&<Modal dayKey={selDay} onClose={()=>setShowModal(false)} onSave={handleSave} editEvent={editEv}/>}
</div>
</ThemeCtx.Provider>
```

);
}

const BK={background:â€œnoneâ€,border:â€œnoneâ€,cursor:â€œpointerâ€,fontFamily:â€œinheritâ€,fontSize:â€œ15pxâ€,padding:â€œ0 0 14px 0â€,display:â€œblockâ€};
const LB={display:â€œblockâ€,fontSize:â€œ11pxâ€,fontWeight:â€œ600â€,padding:â€œ10px 0 0â€,textTransform:â€œuppercaseâ€,letterSpacing:â€œ0.05emâ€};
const IP={width:â€œ100%â€,padding:â€œ8px 0 12pxâ€,border:â€œnoneâ€,fontSize:â€œ16pxâ€,fontFamily:â€œinheritâ€,outline:â€œnoneâ€,background:â€œtransparentâ€,display:â€œblockâ€};
const BB={width:â€œ100%â€,padding:â€œ15pxâ€,borderRadius:â€œ14pxâ€,border:â€œnoneâ€,fontFamily:â€œinheritâ€,fontSize:â€œ16pxâ€,fontWeight:â€œ600â€,cursor:â€œpointerâ€,transition:â€œall 0.15sâ€,color:â€#fffâ€};

ReactDOM.createRoot(document.getElementById(â€˜rootâ€™)).render(<App/>);
</script>

</body>
</html>
